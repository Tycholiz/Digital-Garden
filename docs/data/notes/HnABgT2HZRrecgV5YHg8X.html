<h1 id="kubectl-cli">Kubectl CLI<a aria-hidden="true" class="anchor-heading icon-link" href="#kubectl-cli"></a></h1>
<p>All of these commands send requests to the Kubernetes API</p>
<h2 id="tips">Tips<a aria-hidden="true" class="anchor-heading icon-link" href="#tips"></a></h2>
<ul>
<li>For any command, you can specify which namespace to use with the <code>-n</code> flag. 
<ul>
<li>ex. <code>kubectl get pod -n &#x3C;namespace></code></li>
<li>By default, the <code>default</code> namespace will be used.</li>
</ul>
</li>
<li>Instead of passing the identifier of the actual Kubernetes object, we can pass the yaml config file with the <code>-f</code> flag
<ul>
<li>ex. <code>kubectl describe -f &#x3C;config>.yml</code></li>
</ul>
</li>
<li>run shell command in a pod - <code>kubectl exec -it -- &#x3C;podname></code>
<ul>
<li>open a bash shell in pod - <code>kubectl exec -it &#x3C;podname> bash</code></li>
<li>list processes - <code>kubectl exec &#x3C;podname> -- ps aux</code></li>
<li>list env variables - <code>kubectl exec &#x3C;podname> env</code></li>
</ul>
</li>
<li>pass <code>-c &#x3C;containername></code> to specify which container to run the process in.</li>
</ul>
<h2 id="read">Read<a aria-hidden="true" class="anchor-heading icon-link" href="#read"></a></h2>
<h4 id="config">Config<a aria-hidden="true" class="anchor-heading icon-link" href="#config"></a></h4>
<p><code>kubectl config current-context</code></p>
<ul>
<li>see where kubectl is pointing</li>
</ul>
<p><code>kubectl config view</code></p>
<ul>
<li>show (redacted) contents of <code>~/.kube/config</code></li>
</ul>
<h4 id="describe">Describe<a aria-hidden="true" class="anchor-heading icon-link" href="#describe"></a></h4>
<ul>
<li>give information on a resource (aka Kubernetes object)
<code>kubectl describe pod &#x3C;podname></code></li>
</ul>
<h4 id="get">Get<a aria-hidden="true" class="anchor-heading icon-link" href="#get"></a></h4>
<p><code>kubectl get pods</code></p>
<ul>
<li>get all pods of a cluster</li>
<li>pass <code>-o wide</code> or <code>-o yaml</code> for more info</li>
<li><code>--show-labels</code> to see the labels on each pod</li>
</ul>
<p><code>kubectl get namespaces</code></p>
<p><code>kubectl get all --all-namespace kubectl get all --all-namespacess</code></p>
<ul>
<li>get all components that make up the cluster</li>
</ul>
<p><code>kubectl get nodes</code></p>
<ul>
<li>get all nodes of a cluster</li>
</ul>
<p><code>kubectl get rs</code></p>
<ul>
<li>get all ReplicaSets</li>
</ul>
<p><code>kubectl get ep</code></p>
<ul>
<li>get endpoints of a cluster</li>
</ul>
<p><code>kubectl get -f pod/go-demo-2.yml -o jsonpath="{.spec.containers[*].name}"</code></p>
<ul>
<li>format output as only including the <code>name</code> property, within <code>spec.containers</code></li>
</ul>
<h4 id="logs">Logs<a aria-hidden="true" class="anchor-heading icon-link" href="#logs"></a></h4>
<ul>
<li>get logs from a pod
<code>kubectl logs &#x3C;podname></code></li>
<li><code>-f</code> to follow the logs in real-time</li>
</ul>
<h4 id="context">Context<a aria-hidden="true" class="anchor-heading icon-link" href="#context"></a></h4>
<p><code>kubectl config get-contexts</code></p>
<ul>
<li>get clusters</li>
</ul>
<p><code>kubectl config use-context &#x3C;CLUSTER-NAME></code></p>
<ul>
<li>switch cluster</li>
</ul>
<h2 id="createupdate">Create/Update<a aria-hidden="true" class="anchor-heading icon-link" href="#createupdate"></a></h2>
<h4 id="apply">Apply<a aria-hidden="true" class="anchor-heading icon-link" href="#apply"></a></h4>
<p><code>kubectl apply -f rs/rs.yml</code></p>
<ul>
<li>apply a configuration to a resource.</li>
<li>we can create resources with this command, by <code>apply</code>ing to a resource that doesn't exist.
<ul>
<li>we can also <code>create</code> with <code>--save-config</code></li>
</ul>
</li>
</ul>
<h4 id="create">Create<a aria-hidden="true" class="anchor-heading icon-link" href="#create"></a></h4>
<p><code>kubectl create -f pod/db.yml</code></p>
<ul>
<li>create a pod based on the db.yml file</li>
<li>note: we didn't need to specify that we were creating a pod, since the resource type is already defined in the yml file (<code>kind</code> field).</li>
<li><code>--record</code> allows us to track each change to our resources such as a Deployments.</li>
</ul>
<h2 id="destroy">Destroy<a aria-hidden="true" class="anchor-heading icon-link" href="#destroy"></a></h2>
<h4 id="delete">Delete<a aria-hidden="true" class="anchor-heading icon-link" href="#delete"></a></h4>
<p><code>kubectl delete pod &#x3C;podname></code></p>
<ul>
<li>delete a pod</li>
</ul>
<p><code>kubectl delete namespace &#x3C;namespace></code></p>
<ul>
<li>delete a namespace</li>
</ul>
<hr>
<h4 id="expose">Expose<a aria-hidden="true" class="anchor-heading icon-link" href="#expose"></a></h4>
<ul>
<li>expose a resource as a new Kubernetes service
<pre><code>- the resource can be a Deployment, another Service, a ReplicaSet, a ReplicationController, or a Pod
</code></pre>
ex</li>
</ul>
<pre class="language-sh"><code class="language-sh">kubectl expose rs go-demo-2 \
	--name=go-demo-2-svc \
	# this port will be exposed on every node of the cluster to the outside world,
	# and it will be routed to one of the Pods controlled by the ReplicaSet
	--target-port=28017 \
	--type=NodePort # what type of service?
</code></pre>
<h4 id="label">Label<a aria-hidden="true" class="anchor-heading icon-link" href="#label"></a></h4>
<ul>
<li>We can remove a label from a pod:
<ul>
<li><code>kubectl label pod/pod.yml service-</code> will remove the service label (the <code>-</code> at the end is the syntax for removing labels)</li>
</ul>
</li>
</ul>
<h4 id="rollout">Rollout<a aria-hidden="true" class="anchor-heading icon-link" href="#rollout"></a></h4>
<ul>
<li>allows us to manage the rollout of a resource
<code>kubectl rollout status -w -f deploy/go-demo-2-api.yml</code></li>
</ul>
<p><code>kubectl rollout history -f deploy/go-demo-2-api.yml</code></p>
<ul>
<li>This lets us see how many revisions of the software there have been, and which command created each revision.
<code>kubectl rollout undo -f deploy/go-demo-2-api.yml</code>
<code>kubectl rollout undo -f deploy/go-demo-2-api.yml --to-revision=2</code></li>
</ul>
<h4 id="set">Set<a aria-hidden="true" class="anchor-heading icon-link" href="#set"></a></h4>
<ul>
<li>set configuration properties for resources
<ul>
<li>ex. update docker image of a pod template, update env variables of a pod template etc.</li>
</ul>
</li>
<li>note: the output of this command only indicates that the definition (ex. of the image used in the Deployment) was successfully updated. This means that if we used an image that doesn't exist, we would still get a "success" output from this command.</li>
</ul>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/notes/ryBzcGWSKyybRXnyKxteV">Kubernetes Service</a></li>
</ul>