<h1 id="aggregate-functions">Aggregate Functions<a aria-hidden="true" class="anchor-heading icon-link" href="#aggregate-functions"></a></h1>
<p>called aggregate functions because they are functions that act on multiple rows and give us a single output</p>
<ul>
<li>ex. sum, avg, max, min</li>
</ul>
<p>Used to extract information about whole groups of rows, and allow us to easily ask questions like:</p>
<ol>
<li>What's the most expensive facility to maintain on a monthly basis?</li>
</ol>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>monthlymaintenance<span class="token punctuation">)</span>
<span class="token keyword">from</span> cd<span class="token punctuation">.</span>facilities<span class="token punctuation">;</span>
</code></pre>
<ol start="2">
<li>Who has recommended the most new members?</li>
<li>How much time has each member spent at our facilities?</li>
<li>what is the most popular type of shoe?</li>
</ol>
<ul>
<li>Aggregate functions only work in SELECT or HAVING clauses
Therefore, an aggregate function will take a group of data, perform some function on it, and have a single output that it will print in our result set. An aggregate function can perform transformation on the data, or it can also perform a calculation on it. In either case, the aggregate function is making a consideration of all rows of data, and deciding what to do with it that would result in a single piece of data (int, array etc) that will hold the results of that calculation.</li>
<li>This is why when we perform aggregate functions, we need to use ORDER BY, because we need to tell the query what we want to apply the aggregate function to.
<ul>
<li>Since the aggregate function results in an aggregate set of data <em>based on something</em>, we need to know what that "based on" actually is. Is the data getting combined <em>based on</em> age? Is it getting combined <em>based on</em> nugget (ie. combining buckets from multiple rows in an effort to make a json array)?</li>
</ul>
</li>
<li>When you hear "aggregate function", you should think of taking data from multiple rows and combining (likely integers) or transforming (likely objects/arrays) it in some way</li>
</ul>
<p><a href="/hashrocket.com/blog/posts/faster-json-generation-with-postgresql">some useful examples</a></p>
<h1 id="pitfalls">Pitfalls<a aria-hidden="true" class="anchor-heading icon-link" href="#pitfalls"></a></h1>
<ul>
<li>because of the order of execution, aggregate functions cannot be used in the WHERE clause (see queries/WHERE)
<ul>
<li>This restriction exists because the WHERE clause determines which rows will be included in the aggregate calculation; so obviously it has to be evaluated before aggregate functions are computed</li>
</ul>
</li>
</ul>
<hr>
<strong>Children</strong>
<ol>
<li><a href="/notes/NNunvguG4m6DPYJmClgCF">Count</a></li>
<li><a href="/notes/ownksRDdw8BirfshMBn6m">Filter</a></li>
<li><a href="/notes/rgyCD99RlPwNqv7RIah8E">Json</a></li>
</ol>