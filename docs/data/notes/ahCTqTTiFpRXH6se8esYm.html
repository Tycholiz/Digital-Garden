<h1 id="cross-origin-resource-sharing"><a aria-hidden="true" class="anchor-heading" href="#cross-origin-resource-sharing"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Cross-Origin Resource Sharing</h1>
<p>CORS is an HTTP-header based mechanism that allows a server to indicate any origins (domain, scheme, or port) other than its own from which a browser should permit loading resources.</p>
<ul>
<li>It does this by modifying the response headers returned from the server.</li>
<li>ex. if your app uses a headless CMS, then that server must be configured to allow requests from your website <code>www.mypersonalwebsite.com</code>.</li>
</ul>
<p>By default, if you are trying to access a resource that has a different domain from the one that serves your main website, then CORS will prevent that from happening.</p>
<ul>
<li>To get around this, we give the server a list of allowed domain names that it will allow requests from.</li>
</ul>
<p>When a website can access a resource or execute commands on another domain via HTTP requests, the process is called cross-origin resource sharing.</p>
<ul>
<li>ex. you are on a blogging website, and clicking on one of their buttons sends an HTTP request to your bank's website requesting that all money be transferred out.</li>
<li>Because of CORS, this of course cannot occur. So if we want to allow certain domains to send requests, we need to put them on some sort of whitelist.</li>
</ul>
<p>CORS is a mechanism to use HTTP headers to tell browsers to give a web application running at one origin, access to selected resources from a different origin</p>
<ul>
<li>a cross-origin HTTP request is executed when it requests a resource that has a different origin (domain, protocol, or port) from its own</li>
<li>ex. the front-end JavaScript code served from <code>https://domain-a.com</code> uses XMLHttpRequest to make a request for <code>https://domain-b.com/data.json</code></li>
</ul>
<p>In a browser console, the following code snippet will always result in a CORS error unless:</p>
<ul>
<li>I'm already on google.com</li>
<li>Google's server has enabled cross-origin requests from whatever website (hostname) I'm on </li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://google.com"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> meta<span class="token punctuation">,</span> body</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="enabling-cors-for-a-host"><a aria-hidden="true" class="anchor-heading" href="#enabling-cors-for-a-host"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Enabling CORS for a host</h4>
<p>The server is the one that enables the cross-origin requests, not the client</p>
<ul>
<li><a href="https://enable-cors.org/server.html">Adding CORS support to server</a></li>
</ul>
<pre class="language-js"><code class="language-js">router<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'/'</span> <span class="token operator">+</span> req<span class="token punctuation">.</span><span class="token property-access">method</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">header</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span> <span class="token string">"https://google.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>If you want to make a request from one domain to another, then you need to enable CORS on the server</p>
<hr>
<h3 id="terminology"><a aria-hidden="true" class="anchor-heading" href="#terminology"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Terminology</h3>
<p>Origin - the User Agent that initiated the request.</p>
<hr>
<h2 id="ue-resources"><a aria-hidden="true" class="anchor-heading" href="#ue-resources"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>UE Resources</h2>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">MDN guide</a></p>
<hr>
<h2 id="children"><a aria-hidden="true" class="anchor-heading" href="#children"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Children</h2>
<ol>
<li><a href="/Digital-Garden/notes/fTvLu9uP5fI2N9cA7i9fZ">headers</a></li>
</ol>