<h1 id="locks"><a aria-hidden="true" class="anchor-heading" href="#locks"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Locks</h1>
<p>A <em>distributed lock manager</em> (DLM) runs in every machine in a cluster</p>
<h2 id="purpose"><a aria-hidden="true" class="anchor-heading" href="#purpose"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Purpose</h2>
<p><a href="https://martin.kleppmann.com/2016/02/08/how-to-do-distributed-locking.html">source</a>
The purpose of a lock is to ensure that 2+ nodes in a distributed system are not doing the same work. That work might be to write some data to a shared storage system, to perform some computation, to call some external API etc.</p>
<p>At a high level, there are 2 reasons you might want a lock: efficiency, or ensure correctness.</p>
<ul>
<li>the efficiency problem is less worrysome, and usually results in nothing more than a nuisance. For instance, a user might get 2 password reset emails, or we might make 2 database reads for the same data.</li>
<li>the correctness problem is the one to be concerned about. If 2 nodes concurrently work on the same piece of data, we may very well result in a corrupted file, data loss, or permanent inconsistency.</li>
</ul>