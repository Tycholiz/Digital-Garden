{"pageProps":{"note":{"id":"vhyhna89umrxkmonh18di4y","title":"View","desc":"","updated":1648171851950,"created":1648141411319,"custom":{},"fname":"couchdb.design-doc.view","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"7fb4d564390efecec3a00cb0650d67c0","links":[{"type":"wiki","from":{"fname":"couchdb.design-doc.view","id":"vhyhna89umrxkmonh18di4y","vaultName":"tech"},"value":"db.strategies.index","alias":"indexes","position":{"start":{"line":6,"column":30,"offset":358},"end":{"line":6,"column":61,"offset":389},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"db.strategies.index"}},{"type":"wiki","from":{"fname":"couchdb.design-doc.view","id":"vhyhna89umrxkmonh18di4y","vaultName":"tech"},"value":"general.lang.data-structs.tree.B","alias":"B-tree","position":{"start":{"line":19,"column":41,"offset":1605},"end":{"line":19,"column":84,"offset":1648},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.lang.data-structs.tree.B"}},{"type":"wiki","from":{"fname":"couchdb.design-doc.view","id":"vhyhna89umrxkmonh18di4y","vaultName":"tech"},"value":"sql.join","alias":"JOIN","position":{"start":{"line":138,"column":100,"offset":9254},"end":{"line":138,"column":117,"offset":9271},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"sql.join"}},{"from":{"fname":"couchdb","id":"g7ulqi8no93ezeocbesc3ll","vaultName":"tech"},"type":"backlink","position":{"start":{"line":5,"column":33,"offset":143},"end":{"line":5,"column":66,"offset":176},"indent":[]},"value":"couchdb.design-doc.view"}],"anchors":{"view-functions":{"type":"header","text":"View functions","value":"view-functions","line":40,"column":0,"depth":2},"map-function":{"type":"header","text":"Map function","value":"map-function","line":46,"column":0,"depth":3},"reduce-function":{"type":"header","text":"Reduce function","value":"reduce-function","line":70,"column":0,"depth":3},"rereduce":{"type":"header","text":"Rereduce","value":"rereduce","line":95,"column":0,"depth":4},"view-result":{"type":"header","text":"View result","value":"view-result","line":102,"column":0,"depth":2},"collating-views":{"type":"header","text":"Collating Views","value":"collating-views","line":143,"column":0,"depth":2},"embed-related-data-in-one-document":{"type":"header","text":"Embed related data in one document","value":"embed-related-data-in-one-document","line":146,"column":0,"depth":3},"keep-nuggets-and-buckets-separate":{"type":"header","text":"Keep nuggets and buckets separate","value":"keep-nuggets-and-buckets-separate","line":167,"column":0,"depth":3},"using-view-collation":{"type":"header","text":"Using view collation","value":"using-view-collation","line":188,"column":0,"depth":3},"performance":{"type":"header","text":"Performance","value":"performance","line":218,"column":0,"depth":2},"resources":{"type":"header","text":"Resources","value":"resources","line":222,"column":0,"depth":2}},"children":["7d6bs3y6aqp6r7d7h97a284"],"parent":"57vhdkmrif0e4rdsokr4xyo","data":{}},"body":"<h1 id=\"view\">View<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#view\"></a></h1>\n<p>Views are the primary tool used for querying and reporting on CouchDB databases.</p>\n<ul>\n<li>we write some Javascript functions which combine to create a view. This code implements the business logic for retrieving the documents. </li>\n<li>The view gets created as an object in the database, which is exposed as a resource at an HTTP endpoint.</li>\n</ul>\n<p>Views also allow us to build <a href=\"/notes/jiITIvU42MBAYcbXheWwI\">indexes</a> on any document value or structure.</p>\n<p>views are basically highly efficient on-disk dictionaries that map keys to values</p>\n<ul>\n<li>the key is automatically indexed and can be used to filter and/or sort the results you get back from your views. \n<ul>\n<li>in fact the results are always sorted by the key. This fact should be leveraged to get the most out of queries. </li>\n<li>This should be the approach taken whenever we would use <code>SORT BY</code> in SQL. It can be achieved relatively easily by using an array as a key, </li>\n</ul>\n</li>\n<li>When you \"invoke\" a view, you can say that you’re only interested in a subset of the view rows by specifying a <code>?key=foo</code> query string parameter.</li>\n</ul>\n<p>Stored data is structured using views. In CouchDB, each view is constructed by a JavaScript function that acts as the Map half of a map/reduce operation. The function takes a document and transforms it into a single value that it returns. CouchDB can index views and keep those indexes updated as documents are added, removed, or updated.</p>\n<p>Views are generally stored in the database and their indexes updated continuously.</p>\n<ul>\n<li>external servers can also be used to store views. Implementations exist in JavaScript, Python, Ruby etc</li>\n</ul>\n<p>Each view you create corresponds to one <a href=\"/notes/UE8OS2s713jEk2CmjiAet\">B-tree</a></p>\n<ul>\n<li>The B-trees used are an <em>append-only</em>/<em>copy-on-write</em> variant that does not overwrite pages of the tree when they are updated, but instead creates a new copy of each modified page.</li>\n</ul>\n<p>All views in a single design document will live in the same set of index files on disk</p>\n<p>A view is just like any other document with a key difference: the <code>_id</code> is prefixed with <code>_design/</code></p>\n<p>The most practical consideration for separating views into separate documents is how often you change those views. </p>\n<ul>\n<li>Views that change often, and are in the same design document as other views, will invalidate those other views’ indexes when the design document is written, forcing them all to rebuild from scratch. Naturally we want to avoid this in production.</li>\n</ul>\n<p>When you have multiple views with the same map function in the same design document, CouchDB will optimize and only calculate that map function once.</p>\n<ul>\n<li>This lets you have two views with different reduce functions (say, one with _sum and one with _stats) but build only a single copy of the mapped index.</li>\n</ul>\n<p>Generating a view is an <code>0(N)</code> operation (where <code>N</code> is the total number of rows in the view).</p>\n<h2 id=\"view-functions\">View functions<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#view-functions\"></a></h2>\n<p>View functions specify a key and a value to be returned for each row.</p>\n<p>Basically, the idea with map/reduce functions is that you divide your query into a map function and a reduce function, each of which may be executed in parallel in a multi-node cluster.</p>\n<ul>\n<li>this allows us to perform efficient query operations in parallel</li>\n</ul>\n<h3 id=\"map-function\">Map function<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#map-function\"></a></h3>\n<p>Take in a single document and <code>emit()</code> key-value pairs that are stored in a View.</p>\n<p>A map function is free from side-effects.</p>\n<p>The following <code>map</code> function will take in a single <code>nugget</code> and will emit a key-value pair for each item in the <code>buckets</code> array.</p>\n<ul>\n<li><code>emit()</code> may be called many times for a single document, so the same document may be available by several different keys.</li>\n</ul>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">doc</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">.</span><span class=\"token property-access\">type</span> <span class=\"token operator\">===</span> <span class=\"token string\">'nugget'</span> <span class=\"token operator\">&#x26;&#x26;</span> doc<span class=\"token punctuation\">.</span><span class=\"token property-access\">buckets</span> <span class=\"token operator\">&#x26;&#x26;</span> <span class=\"token known-class-name class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">isArray</span><span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">.</span><span class=\"token property-access\">buckets</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    doc<span class=\"token punctuation\">.</span><span class=\"token property-access\">buckets</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">bucket</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">emit</span><span class=\"token punctuation\">(</span>bucket<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>If you don’t use the key field in the map function, you are probably doing it wrong.</p>\n<p>CouchDB is smart enough to run a map function only once for every document, even on subsequent queries on a view. Only changes to documents or new documents need to be processed anew.</p>\n<p>Map functions can't modify the document and they can't have side-effects.</p>\n<ul>\n<li>this is why CouchDB can guarantee correct results without having to recalculate a complete result when only one document gets changed.</li>\n</ul>\n<h3 id=\"reduce-function\">Reduce function<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#reduce-function\"></a></h3>\n<p>Reduce functions operate on the sorted rows emitted by a map function</p>\n<p>A reduce function takes in 2 args: a key, and a list (which is the result of the related map function)</p>\n<ul>\n<li>it can also take an optional 3rd arg, which is to indicate whether <em>rereduce</em> mode is active or not.</li>\n</ul>\n<p>While the map function will <code>emit</code> values, <code>reduce</code> will simply <code>return</code> the reduced value.</p>\n<p>A reduce function should return a scalar value (ie. not an array or object)</p>\n<ul>\n<li>reduce is not for generating complex aggregate values</li>\n<li>it is ok to return an array if it is small and fixed size (ie. more of a tuple)</li>\n</ul>\n<p>CouchDB has a number of built-in reduce functions which run inside the DB and are much faster than the equivalent implementation in a custom reduce function (in Javascript)</p>\n<ul>\n<li><code>_sum</code> - returns total number of rows between startkey and endkey</li>\n<li><code>_count</code></li>\n<li><code>_stats</code></li>\n</ul>\n<p>Because of the way B-trees are structured, we can cache the intermediate reduce results in the non-leaf nodes of the tree, so reduce queries can be computed along arbitrary key ranges in logarithmic time.</p>\n<p>CouchDB’s reduce functionality takes advantage of one of the fundamental properties of B-tree indexes: for every leaf node (a sorted row), there is a chain of internal nodes reaching back to the root. Each leaf node in the B-tree carries a few rows (on the order of tens, depending on row size), and each internal node may link to a few leaf nodes or other internal nodes.</p>\n<p>The reduce function is run on every node in the tree in order to calculate the final reduce value. The end result is a reduce function that can be incrementally updated upon changes to the map function, while recalculating the reduction values for a minimum number of nodes. The initial reduction is calculated once per each node (inner and leaf) in the tree.</p>\n<p>You can access a view without enabling the reduce function by disabling reduction (<code>reduce=false</code>) when the view is accessed.</p>\n<h4 id=\"rereduce\">Rereduce<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#rereduce\"></a></h4>\n<p>The existence and use of the rereduce parameter is tightly coupled to how the B-tree index works.</p>\n<p>When run on leaf nodes (which contain actual map rows), <code>rereduce</code> is false.</p>\n<p>When the reduce function is run on inner nodes, <code>rereduce</code> is true. This allows the function to account for the fact that it will be receiving its own prior output. When rereduce is true, the values passed to the function are intermediate reduction values as cached from previous calculations. When the tree is more than two levels deep, the rereduce phase is repeated, consuming chunks of the previous level’s output until the final reduce value is calculated at the root node.</p>\n<h2 id=\"view-result\">View result<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#view-result\"></a></h2>\n<p>Whenever you query a view, this is how CouchDB operates:</p>\n<ol>\n<li>Starts reading at the top (of the B-tree), or at the position that <code>startkey</code> specifies, if present.</li>\n<li>Returns one row at a time until the end or until it hits <code>endkey</code>, if present.</li>\n</ol>\n<ul>\n<li>If you specify <code>descending=true</code>, the reading direction is reversed; the sort order of rows in the view doesn't change.</li>\n</ul>\n<p>There is no unique constraint on the keys of a view result.</p>\n<ul>\n<li>ex. we can have a view result of K-V pairs <code>author</code>-<code>book</code> where the same author is listed multiple times.</li>\n</ul>\n<p>You always need to give a range of keys, because filtering is done on map's results, not on reduce.</p>\n<p>Each view result is stored in a B-tree (index structure) in its own file</p>\n<ul>\n<li>since view results are in their own file, they can be stored on a separate disk from other database objects to increase performance.</li>\n<li>The B-tree provides very fast lookups of rows by key, as well as efficient streaming of rows in a key range</li>\n<li>The B-tree is created only once when the view is first queried. \n<ul>\n<li>All subsequent queries will just read the B-tree instead of executing the map function for all documents again.</li>\n<li>When we create, update or delete a document, the database engine finds the corresponding rows in the view result and marks them <em>invalid</em> so they no longer show up in the view result.\n<ul>\n<li>if the document got updated, it gets run through the map function again and the result is inserted into the B-tree at the correct spot.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>The results of a view are generated via the <code>emit()</code> function.</p>\n<p>It is not recommended to emit the document itself in the view. </p>\n<ul>\n<li>Instead, to include the bodies of the documents when requesting the view, request the view with <code>?include_docs=true</code>.</li>\n</ul>\n<p>View results are sorted by <em>key</em></p>\n<ul>\n<li>the key can be any data type, including arrays and objects.\n<ul>\n<li>You can use JSON arrays as keys for fine-grained control over sorting and grouping.</li>\n</ul>\n</li>\n</ul>\n<p>For instance, here we get back customers, then orders in the same view result (due to the <code>0</code> and <code>1</code>, serving as secondary sorts)</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">doc</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">.</span><span class=\"token property-access\"><span class=\"token maybe-class-name\">Type</span></span> <span class=\"token operator\">==</span> <span class=\"token string\">\"customer\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">emit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>doc<span class=\"token punctuation\">.</span><span class=\"token property-access\">_id</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">else</span> <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">.</span><span class=\"token property-access\"><span class=\"token maybe-class-name\">Type</span></span> <span class=\"token operator\">==</span> <span class=\"token string\">\"order\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">emit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>doc<span class=\"token punctuation\">.</span><span class=\"token property-access\">customer_id</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>Aside from the data itself, the view result also contains metadata like <code>total_rows</code> and <code>offset</code>.</p>\n<h2 id=\"collating-views\">Collating Views<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#collating-views\"></a></h2>\n<p>Imagine our querying client needs 2 different related objects in a single query. In SQL, we'd do a <a href=\"/notes/74d0c3a8-73ff-4964-bc57-7ceb6f8b8cb5\">JOIN</a>, but there are a few different approaches in CouchDB:</p>\n<h3 id=\"embed-related-data-in-one-document\">Embed related data in one document<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#embed-related-data-in-one-document\"></a></h3>\n<p>We could embed the related data like so:</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ABCDEF\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my_nugget\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"media_items\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"…\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"buckets\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"psychology\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"humor\"</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>However, a drawback is that to add a bucket, we need to</p>\n<ol>\n<li>fetch the document (the nugget)</li>\n<li>add the bucket to the <code>buckets</code> field</li>\n<li>send the updated document to the server</li>\n</ol>\n<p>To boot, if we get multiple clients adding buckets to the same nugget, we are bound to get <em>HTTP 409 Conflict</em> (optimistic concurrency in action)</p>\n<h3 id=\"keep-nuggets-and-buckets-separate\">Keep nuggets and buckets separate<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#keep-nuggets-and-buckets-separate\"></a></h3>\n<p>We could add a <code>type</code> field to separate nuggets and buckets:</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ABCDEF\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"nugget\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my_nugget\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"media_items\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"…\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"buckets\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"123456\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"_id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"123456\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"bucket\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my_bucket\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>The problem with this approach is that if we want to get both the nugget and the associated buckets, we have to make 2 GET requests.</p>\n<h3 id=\"using-view-collation\">Using view collation<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#using-view-collation\"></a></h3>\n<p>Thankfully, we just have to write a view that leverages the fact that keys are automatically sorted, and can be complex:</p>\n<ul>\n<li>note: the <code>0</code> and <code>1</code> are needed so that the nugget comes first, then the buckets.</li>\n<li>note: this view is not totally tested</li>\n</ul>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">doc</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>type <span class=\"token operator\">===</span> <span class=\"token string\">\"nugget\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">emit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>doc<span class=\"token punctuation\">.</span><span class=\"token property-access\">bucket</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">else</span> <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>type <span class=\"token operator\">===</span> <span class=\"token string\">\"bucket\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">emit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>doc<span class=\"token punctuation\">.</span><span class=\"token property-access\">_id</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>With this view, we get back rows where the first one (with <code>key=[id, 0]</code>) is the nugget, and the rest are associated buckets. </p>\n<p>Now, to get back a specific nugget with all the associated nuggets, we add the query param to the query:</p>\n<ul>\n<li><code>?startkey=[\"my_nugget\"]&#x26;endkey=[\"my_nugget\", 2]&#x26;include_docs=true</code></li>\n</ul>\n<p>To query by some specific value(s) in CouchDB, we just need to figure out how to get that searchterm in the key so we can use a query param on it.</p>\n<ul>\n<li>ex. imagine our document had a <code>$doctype</code> field and we wanted to return documents where that type is <code>nugget</code>:</li>\n</ul>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">doc</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">emit</span><span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">.</span><span class=\"token property-access\">$doctype</span><span class=\"token punctuation\">,</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>and then we just add a query param <code>?key=\"nugget\"</code></p>\n<hr>\n<h2 id=\"performance\">Performance<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#performance\"></a></h2>\n<p>The database engine only runs through all documents once, when you first query your view. </p>\n<ul>\n<li>If a document is changed, the map function is only run once, to recompute the keys and values for that single document.</li>\n</ul>\n<h2 id=\"resources\">Resources<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#resources\"></a></h2>\n<ul>\n<li><a href=\"https://docs.couchdb.org/en/3.2.0/ddocs/views/nosql.html\">Cookbook for SQL developers</a></li>\n</ul>\n<hr>\n<strong>Children</strong>\n<ol>\n<li><a href=\"/notes/7d6bs3y6aqp6r7d7h97a284\">API</a></li>\n</ol>\n<hr>\n<strong>Backlinks</strong>\n<ul>\n<li><a href=\"/notes/g7ulqi8no93ezeocbesc3ll\">CouchDB</a></li>\n</ul>","noteIndex":{"id":"olZIVfSs2uLLr3BppFh4K","title":"Digital Garden","desc":"","updated":1674517603573,"created":1615482407722,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"effb007003ca6a91d7fd0c293e1d2436","links":[{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"testing.method.unit","alias":"unit testing","position":{"start":{"line":18,"column":121,"offset":1146},"end":{"line":18,"column":157,"offset":1182},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"testing.method.unit"}},{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"general.arch.microservice","alias":"microservices","position":{"start":{"line":18,"column":188,"offset":1213},"end":{"line":18,"column":231,"offset":1256},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.arch.microservice"}},{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"paradigm.oop","alias":"OOP","position":{"start":{"line":36,"column":227,"offset":2718},"end":{"line":36,"column":247,"offset":2738},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"paradigm.oop"}}],"anchors":{"tags":{"type":"header","text":"Tags","value":"tags","line":46,"column":0,"depth":3},"resources":{"type":"header","text":"Resources","value":"resources","line":55,"column":0,"depth":2},"ue-unexamined-resources":{"type":"header","text":"UE (Unexamined) Resources","value":"ue-unexamined-resources","line":56,"column":0,"depth":3},"e-examined-resources":{"type":"header","text":"E (Examined) Resources","value":"e-examined-resources","line":59,"column":0,"depth":3},"resources-1":{"type":"header","text":"Resources","value":"resources-1","line":62,"column":0,"depth":3}},"children":["40ubf88tephzbdjte8cdsa0","zFMjbn3xihVNHjUIdZCD1","IK6NOKemuDjhfstJBovKL","ZaTr28eWk1DrXOEsc1YVb","Vi0WYVLZunVM9iR8XZJn3","ngAbg7gluvbt1bY1UIRsi","RCPPXSakm5TvKka8kOmVp","LIcuGYV0DDt1VWbvH6Sed","MPx8ykTP57I40WTZvTP7f","ZU5WmdTG1bHoE8RcmZXZG","jqWiyYJff92RjXuUQt9PQ","KihijM8OQvZ4pASkkhqzL","F9vyqvls3OBCujtukqKhy","k6jxm2b3edgkhbordpuz6v1","facc2b01-755a-409f-99f6-57bef2d1501f","bZumdyapJ2H0wWWOmJ45i","elqpgoe2r951si4xrhujppj","m5ov42Vm6mR7RQWTvl1NW","cw8cerc0cos8lh871oz8rtf","PZxxZ4iESzSlbbHJKxuAZ","UDu62Pa6BaRqlG8uGoMhy","u3zcndycwqessho5h6x0nz9","ZgCUp366YrF2Tyky2NT73","DVpVUmavSoVDA7UIlPzLX","nMCtMXVvjBsJk3iw1zoIO","ANfx9Z4a6ZA0uJuSHtbIJ","BkG557LKUYbH1DnxprEVT","1TaH8zDTM98FZ9SYaeXLM","02v7ymc144e5c4pv3edkud7","dc79799f-a55d-48ab-a8be-c48adb1b19c0","f6feef57-b8f5-451f-a09a-7b63f6a07183","4sz47Y0LKs1Si73rWtyyh","g7ulqi8no93ezeocbesc3ll","5a9fb1df-478e-4687-9be0-5cb97e61ec57","1374e9e9-1cbc-4e1f-b1ca-66b8569533dd","D8Z3rjXkSj2EOymXQXF4Z","np3c1ykvnjqv5xoombpfwqz","f529cc34-aba0-45ca-ad7e-02ddda318941","0zcauha3il2NqtxZazIo7","9bbd6f68-03b2-41f4-92e4-2ca313e8b450","5a2ab598-fa7e-4471-8bda-9f5831b679ae","uV6w4mZPoohWyZV4Xaad0","QHXEIyeZGIGMVi5Q52UWI","RgE0mZLaUjPftFPZsiAoe","mytCOts26Pidush65tdRW","fwUzxfLSPMH1eL8oBoLWx","wazdsda6h25x66edvfmeuiv","TbW7PM9bg1y5TGkiWwQ8b","xiSIDeEtIc8X0lpUQlppI","0jxgntiLNHWFuCbzqtFGF","GkdMprLUe4QQULBxmGN6V","4SYc6v5hxY5g6Ip6kjpwO","czi7ilt2i1uoqm1f2otbntj","fqVQpS9FBiXgKsZX3R3sJ","L5JUZlGAGvTxrsEBB7DY8","ttyri4pwfyn5lcx0vp9804o","TeTedoeS2LdHPR632eCpM","ulicRRwo3lSFzh3tMfWH9","p7d24vyb8m00ombzn34t50c","e65188a1-177e-4ab2-99f9-75f85d537621","fajYnbVhCRDi74xn0H30R","bArGdGwqo3iFkyKMyE7qR","4Dcp7gbEVoLLgfu7bXFai","5d700782-fb81-416e-83f9-5dd88260e350","zubgzhNFE6KlTgXcjTz6O","8lpdfWa0cbSq1XJQbcYcY","2psluywdc416t7vrql0m058","17I8ZksXvqCH1mRtZDjHp","kF916Ow84qpJJeMRkWMIo","tMLkLcrIHHBz56xVmBLkP","CSePBQ6q7qhowKESqVwt7","laZ4OfLhZNK1Kuy6GaWUr","z5IJblOknQhMzZ5QZh4ye","N36FHxfxzwJfxDY3miWyX","3bb25f58-2b50-4fa3-af55-48ea9f88a081","7x07qjgbitozdfszqzuy7ix","u93Rz4fEWGu6VBR30Zraf","9hjMHnKvYT4jLKvuDSXaV","qC5GxCZBmNb4Ip6c0kU8x","LgW7mTIALODoXc54B3p6S","UYPxfHBFWX7fb6hHU5bB6","74lYtC8NKpCzcyFOZTfR1","sEoBNAEuaTxwSmTXDonZt","dj0jr9mpvs62e2pkg3zc3yy","z8ie0xjogb6ht7gzowav5xr","qxSOd6SPN8qf9ZUojVFDX","WQoMTf6VXBaxCgksXAVsj","2Mw4XgfyCHXHNOX5yoCIY","qcdt2f7jo51muquo5r95dpo","0XJqmcdtcMZu66glBI5O8","lK8r8BXS4ThiUTe4xKIZe","93de42ca-53ea-460a-baa7-b9ec5c47cb1e","Rxs2jaGpdFzqYtP7lAJFJ","aO8W81Z0PyIb6Hs7nOHPW","lhzisalkebu4w5n01np07i0","7b5l4b6fi65n7sv9org5q1l","I01hENHnh8Tqu3Ok8sLzG","03o3n0hz9v9jtb7j889zpd4","evqsPNutOaZ8hcBCqxFQu","zhhxcjZUHdU8uRLwGb9Zh","G1aFACZB2ooWGMGwyd3ZW","YWy1C4tgoaCcw1m8JJsr7","Szj3o5iaNxPpesiCqwrbu","613syb18hb3v0u1ydvor7ru","XhvCDW3fIw6h6MhY5ticq","Q70g7SusFZBQXzkuQifv4","AzfWDH3wp7jFpL2EYxBcW","y0fwpZ9qMqirsLiFyOciU","ZF8xj8wwDUqKlrwTrCFZ1","tAJvhqhdfyZZa87QHq1TU","4hRmipi8lxpBLyzWu5JVB","iTg0C7QjvnmqBZeEigJNs","3babc3d2-79ae-470a-9c06-ab8bba2e684e","bF3UsMFya3fMeXWDspVov","ULkfbL9WpktbVYnzhl6Jw","PpNOO8JYWe6dM8wruSa7x","di40pCxDn7IiqE8lFdD46","rmW0mkerqV35I8QPji6lM","3IFIK1ByzeIxZCByryGLN","iImkYAKfkw3beAl6pLbDn","ecDe8DNWrkeQTwpTEvHje","i2it5id8qwtg27n4usg8bo1","Yqhdd9mSJGN7OJOeyoSD2","Ws5tah8tpeyn9tK8VBTg8","gWAg15uBJgkS2B0wcpMAa","l7V3v2ep1YdDCt7DOr7Ci","yM2PJBdqJnHpD63cPA6sW","qn0bre7eLbi3QMbCfWkUi","fSu0KxFL41IRouotqmbHs","0gtg24Mj1a1bQFPRGQNlO","7iQPBMltLPLbFEz2qbjPu","yoh4pwoXcfELInGKRdYf6","dCGCWXgAmiOZXbdULT1m6","jMavlje07sNa6hSEIE8WA","Xxm0JE4dKHxrQAaZfzvxD","nRb6Im4Kcmc2ZWE7K1jZ1","PAEBZCyFBZJyR7OoMZ41E","PQ6km8RgRCuyICBPOYz8f","x5tm1nfjzyawwzedy3yitgd","2bhftt8rGuxYu4pFgNqru","hjYIZpHQWuXfeEoGeJEKW","K2M9bQqVq2eQfm29eslKL","X8obW1iKwYsvNgKWGyCzy","yJwSC7hqYIezTFHf5i0Ev","c4Z7ETcOHUILRMH32Sfjw","qiR6dIu857b9M9kTqjOyK","fc2coz74cnfy5czzofx4h5x","Ku1OgHMhELajzo61Gx7ye","LUrfhDWo8wuwZu7CN9TV8","osu6JGOnvXJ5gt3tpqWZY","1a6173cd-cf13-4b34-a522-8350bf9a364f","S2sBltrPfd8a7ICuD7CuH","GLQ2pmkJUNUa93THBDVsD","md6xitz4exia2joa06i490b","oWCuBXOg6JWfZzjmKxmNl","jOmhZ8ovLYTPbpM1vqSDx","p9bov84s0isgkl1ysaw93kk","FraC6xzLy1ei91l1ICyc9","6ceBas2RE9Q4787GDngH7","734cd78d-0bc9-426b-803d-1efc84dfffe5","k4Bb09px6r0FxIRs49SXV","oaG3H1S9IUBO644nGZigu","Ka7agQJkUMRSWN0uFdkWK","si3z090WsiLasMhJBa1Az","hs6rwzt4mogiicoc4gcykbi","ljKAVERmdEiKLK9hXGKBm","zxt3lhonfdhglvijd17ua8c","dd7dopve1dudqkoibkqvti4","923tgifqf59ovv5yldtyi0a","vrjwp01goqw47fqctm4f4lo","c99gdmmppju3r1tth8cb2jx","z2pvn5qxdz84zgygqzxage8"],"parent":null,"data":{},"body":"This Dendron vault of tech knowledge is organized according to domains and their sub-domains, along with specific implementation of those domains.\n\nFor instance, Git itself is a domain. Sub-domains of Git would include things like `commit`,\n`tags`, `reflog` etc. implementations of each of those could be `cli`, `strat`\n(strategies), `inner`, and so on.\n\nThe goal of the wiki is to present data in a manner that is from the perspective\nof a querying user. Here, a user is a programmer wanting to get key information\nfrom a specific domain. For instance, if a user wants to use postgres functions\nand hasn't done them in a while, they should be able to query\n`postgres.functions` to see what information is available to them.\n\nThis wiki has been written with myself in mind. While learning each of these\ndomains, I have been sensitive to the \"aha\" moments and have noted down my\ninsights as they arose. I have refrained from capturing information that I\nconsidered obvious or otherwise non-beneficial to my own understanding.\n\nAs a result, I have allowed myself to use potentially arcane concepts to explain other ones. For example, in my note on [[unit testing|testing.method.unit]], I have made reference to the [[microservices|general.arch.microservice]] note. If these notes were made with the public in mind, this would be a very bad strategy, given that you'd have to understand microservices to be able to draw that same parallel that I've already drawn. Since these notes are written for myself, I have been fine with taking these liberties.\n\nWhat I hope to gain from this wiki is the ability to step away from any\ngiven domain for a long period of time, and be able to be passably useful for\nwhatever my goals are within a short period of time. Of course this is all\nvague sounding, and really depends on the domain along with the ends I am\ntrying to reach.\n\nTo achieve this, the system should be steadfast to:\n- be able to put information in relatively easily, without too much thought\n\trequired to its location. While location is important, Dendron makes it easy\n\tto relocate notes, if it becomes apparent that a different place makes more\n\tsense.\n- be able to extract the information that is needed, meaning there is a\n\thigh-degree in confidence in the location of the information. The idea is\n\tthat information loses a large amount of its value when it is unfindable.\n\tTherefore, a relatively strict ideology should be used when determining\n\twhere a piece of information belongs.\n\t- Some concepts might realistically belong to multiple domains. For instance, the concept of *access modifiers* can be found in both `C#` and `Typescript`. Therefore, this note should be abstracted to a common place, such as [[OOP|paradigm.oop]].\n\nThis Dendron vault is the sister component to the [General Second Brain](https://tech.kyletycholiz.com).\n\n### Tags\nThroughout the garden, I have made use of tags, which give semantic meaning to the pieces of information.\n\n- `ex.` - Denotes an *example* of the preceding piece of information\n- `spec:` - Specifies that the preceding information has some degree of *speculation* to it, and may not be 100% factual. Ideally this gets clarified over time as my understanding develops.\n- `anal:` - Denotes an *analogy* of the preceding information. Often I will attempt to link concepts to others that I have previously learned.\n- `mn:` - Denotes a *mnemonic*\n- `expl:` - Denotes an *explanation*\n\n## Resources\n### UE (Unexamined) Resources\nOften, I come across sources of information that I believe to be high-quality. They may be recommendations or found in some other way. No matter their origin, I may be in a position where I don't have the time to fully examine them (and properly extract notes), or I may not require the information at that moment in time. In cases like these, I will add reference to a section of the note called **UE Resources**. The idea is that in the future when I am ready to examine them, I have a list of resources that I can start with. This is an alternative strategy to compiling browser bookmarks, which I've found can quickly become untenable.\n\n### E (Examined) Resources\nOnce a resource has been thoroughly examined and has been mined for notes, it will be moved from *UE Resources* to *E Resources*. This is to indicate that (in my own estimation), there is nothing more to be gained from the resource that is not already in the note.\n\n### Resources\nThis heading is for inexhaustible resources. \n- A prime example would be a quality website that continually posts articles.  - Another example would be a tool, such as software that measures frequencies in a room to help acoustically treat it.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"dendronVersion":"0.83.0","vaults":[{"fsPath":"../main/tech","name":"tech"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"The Tech Digital Garden of Kyle Tycholiz"},"github":{"cname":"tech.kyletycholiz.com","enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"master","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","enableMermaid":true,"siteUrl":"https://tech.kyletycholiz.com","duplicateNoteBehavior":{"action":"useVault","payload":["tech"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}