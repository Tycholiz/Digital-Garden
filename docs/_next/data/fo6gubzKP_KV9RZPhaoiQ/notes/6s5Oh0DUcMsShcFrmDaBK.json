{"pageProps":{"note":{"id":"6s5Oh0DUcMsShcFrmDaBK","title":"JWT","desc":"JSON Web Token","updated":1686165000287,"created":1615250426346,"custom":{},"fname":"auth.tokens.jwt","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"9c063d3ecd5352f9aa44d5a974716971","links":[{"type":"wiki","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"auth.tokens.jwt.claim","alias":"claim","position":{"start":{"line":3,"column":56,"offset":71},"end":{"line":3,"column":87,"offset":102},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"auth.tokens.jwt.claim"}},{"type":"wiki","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"auth.tokens.access","alias":"access tokens","position":{"start":{"line":8,"column":64,"offset":567},"end":{"line":8,"column":100,"offset":603},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"auth.tokens.access"}},{"type":"wiki","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"auth.tokens.refresh","alias":"refresh tokens","position":{"start":{"line":8,"column":105,"offset":608},"end":{"line":8,"column":143,"offset":646},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"auth.tokens.refresh"}},{"type":"wiki","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"auth","alias":"Authorization","position":{"start":{"line":15,"column":67,"offset":1055},"end":{"line":15,"column":121,"offset":1109},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"auth","anchorHeader":"authorization-vs-authentication"}},{"type":"wiki","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"binary.encoding.base64","position":{"start":{"line":17,"column":34,"offset":1218},"end":{"line":17,"column":60,"offset":1244},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"binary.encoding.base64"}},{"type":"wiki","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"auth.session","alias":"user session management","position":{"start":{"line":49,"column":49,"offset":2635},"end":{"line":49,"column":89,"offset":2675},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"auth.session"}},{"type":"wiki","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"browser.cookies","alias":"cookie","position":{"start":{"line":65,"column":18,"offset":3828},"end":{"line":65,"column":44,"offset":3854},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"browser.cookies"}},{"type":"wiki","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"binary.encoding.base64","alias":"base64","position":{"start":{"line":68,"column":108,"offset":4294},"end":{"line":68,"column":141,"offset":4327},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"binary.encoding.base64"}},{"type":"wiki","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"auth.session","alias":"sessions","position":{"start":{"line":116,"column":27,"offset":8354},"end":{"line":116,"column":52,"offset":8379},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"auth.session"}},{"type":"ref","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"auth.tokens.jwt.claim","position":{"start":{"line":34,"column":1,"offset":2350},"end":{"line":34,"column":27,"offset":2376},"indent":[]},"xvault":false,"to":{"fname":"auth.tokens.jwt.claim"}},{"type":"ref","from":{"fname":"auth.tokens.jwt","id":"6s5Oh0DUcMsShcFrmDaBK","vaultName":"tech"},"value":"auth.tokens.jwt.signature","position":{"start":{"line":46,"column":1,"offset":2540},"end":{"line":46,"column":31,"offset":2570},"indent":[]},"xvault":false,"to":{"fname":"auth.tokens.jwt.signature"}},{"from":{"fname":"auth.session","id":"0NyqVKRyLLG6J1NDvFX5k","vaultName":"tech"},"type":"backlink","position":{"start":{"line":14,"column":31,"offset":858},"end":{"line":14,"column":55,"offset":882},"indent":[]},"value":"auth.tokens.jwt"},{"from":{"fname":"auth.tokens","id":"97fecf63-24b2-46d0-86f6-f88b4813d1f3","vaultName":"tech"},"type":"backlink","position":{"start":{"line":3,"column":41,"offset":78},"end":{"line":3,"column":64,"offset":101},"indent":[]},"value":"auth.tokens.jwt"},{"from":{"fname":"security.federated-identity","id":"yBNgydTx5k1BfiGgW3BbD","vaultName":"tech"},"type":"backlink","position":{"start":{"line":8,"column":39,"offset":376},"end":{"line":8,"column":64,"offset":401},"indent":[]},"value":"auth.tokens.jwt"}],"anchors":{"what-is-it":{"type":"header","text":"What is it?","value":"what-is-it","line":8,"column":0,"depth":2},"flow":{"type":"header","text":"Flow","value":"flow","line":27,"column":0,"depth":3},"construction":{"type":"header","text":"Construction","value":"construction","line":36,"column":0,"depth":3},"payload-claim":{"type":"header","text":"Payload (claim)","value":"payload-claim","line":39,"column":0,"depth":4},"header":{"type":"header","text":"Header","value":"header","line":42,"column":0,"depth":4},"signature":{"type":"header","text":"Signature","value":"signature","line":51,"column":0,"depth":4},"why-use-it":{"type":"header","text":"Why use it?","value":"why-use-it","line":54,"column":0,"depth":2},"how-do-they-work":{"type":"header","text":"How do they work?","value":"how-do-they-work","line":76,"column":0,"depth":2},"analogy-money-vs-cheque":{"type":"header","text":"Analogy: Money vs Cheque","value":"analogy-money-vs-cheque","line":90,"column":0,"depth":3},"token-ex-jwt":{"type":"header","text":"Token (ex. JWT)","value":"token-ex-jwt","line":99,"column":0,"depth":3},"logout":{"type":"header","text":"Logout","value":"logout","line":132,"column":0,"depth":3},"analogy":{"type":"header","text":"Analogy","value":"analogy","line":136,"column":0,"depth":3},"e-resources":{"type":"header","text":"E Resources","value":"e-resources","line":142,"column":0,"depth":2}},"children":["1VJ1TOJSxesXFEIXjtamD","wXUxgZM5Oi21cN1uIX0Yw","O4UfJsjTp829l2zZQe0pL"],"parent":"97fecf63-24b2-46d0-86f6-f88b4813d1f3","data":{}},"body":"<h1 id=\"jwt\">JWT<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#jwt\"></a></h1>\n<h2 id=\"what-is-it\">What is it?<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#what-is-it\"></a></h2>\n<p>A JWT is simply a JSON payload containing a particular <a href=\"/notes/1VJ1TOJSxesXFEIXjtamD\">claim</a> (typically about the permission a user has)</p>\n<ul>\n<li>The key property of JWTs is that in order to confirm if they are valid we only need to look at the token itself (we don't have to contact a third-party service or keep it in-memory between requests).</li>\n</ul>\n<p>When used as an authentication token, a JWT is a security token format that is used for exchanging authentication and authorization data between parties</p>\n<p>The most common implementations of JWT that we will see are as <a href=\"/notes/RXSECsORRrl4fC8oCEtsk\">access tokens</a> and <a href=\"/notes/Pp08kttb1g4TIC3R5Lt06\">refresh tokens</a></p>\n<p>The JWT should include the roles of the user, so that the backend knows what that user can do solely from the JWT itself.</p>\n<p>a JWT is not encrypted. So any information that we put in the token is still readable to anyone who intercepts the token.</p>\n<ul>\n<li>therefore, we should never put anything in the JWT that a bad actor could leverage directly.</li>\n</ul>\n<p>Resource servers that verify the signature of JWTs are performing <a href=\"/notes/facc2b01-755a-409f-99f6-57bef2d1501f#authorization-vs-authentication\">Authorization</a> (not Authentication), since identity is not verified; only access rights.</p>\n<p>a JWT is actually Base64Url, not <a href=\"/notes/YYt62mSW964cwb5nP0hva\">Base64</a></p>\n<ul>\n<li>this is virtually the same, except a couple characters are different so that it can exist as a URL param.\n<ul>\n<li>ex. <code>=</code> is displayed as <code>%3D</code></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"flow\">Flow<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#flow\"></a></h3>\n<ol>\n<li>User sends credentials to auth service. </li>\n<li>If the credentials are valid, the authentication service generates a JWT with the user's identity and any necessary claims (e.g., user roles or permissions) and signs it with a secret key known only to the auth service.</li>\n<li>The auth service returns the JWT to the client</li>\n<li>The client includes the JWT in subsequent requests for resources (e.g. to invoice service)</li>\n<li>The invoice service extracts the JWT from the request and verifies the signature of the JWT using the secret key shared from the auth service.</li>\n<li>If the signature is valid, the invoice service decodes the JWT to extract the user's identity and any relevant claims.</li>\n<li>The invoice service checks to see if the claim offers sufficient permissions to access the resource. If it does, then it accesses it and returns it to the client.</li>\n</ol>\n<h3 id=\"construction\">Construction<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#construction\"></a></h3>\n<p>A JWT is made of 3 parts: the Header, the Payload and the Signature</p>\n<h4 id=\"payload-claim\">Payload (claim)<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#payload-claim\"></a></h4>\n<p></p><p></p><div class=\"portal-container\">\n<div class=\"portal-head\">\n<div class=\"portal-backlink\">\n<div class=\"portal-title\">From <span class=\"portal-text-title\">JWT Claim</span></div>\n<a href=\"/notes/1VJ1TOJSxesXFEIXjtamD\" class=\"portal-arrow\">Go to text <span class=\"right-arrow\">â†’</span></a>\n</div>\n</div>\n<div id=\"portal-parent-anchor\" class=\"portal-parent\" markdown=\"1\">\n<div class=\"portal-parent-fader-top\"></div>\n<div class=\"portal-parent-fader-bottom\"></div><p>the core of a JWT, since they are the data contained in the JWT</p>\n<ul>\n<li>claims are pieces of information that are \"claimed\" about a subject (most often a user). In other words, they are just properties of an object.\n<ul>\n<li>ex. name, sub, admin</li>\n<li>ex. \"the holder of this token is able to create/read/update/delete a specified resource\"</li>\n</ul>\n</li>\n<li>the claim refers to the key, not the value</li>\n<li>usually not encrypted, meaning if we don't use https, this information is potentially compromised.</li>\n<li>anyone will be able to decode them and to read them, we cannot store any sensitive data in here\n<ul>\n<li>not an issue because of the secret</li>\n</ul>\n</li>\n</ul>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"sub\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1234567890\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"John Doe\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token property\">\"admin\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<ul>\n<li>when the server receives a JWT from an HTTP request's authorization header, like so:</li>\n</ul>\n<blockquote>\n<p>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJiIjoyLCJjIjozfQ.hxhGCCCmGV9nT1slief1WgEsOsfdnlVizNrODxfh1M8</p>\n</blockquote>\n<p>it will verify the token using the secret, and then will serialize the claims in that token to the database. </p>\n<ul>\n<li>If using Postgres, this would enable access to the data in <code>current_settings</code>, e.g. <code>current_setting('request.jwt.claim.email', true)</code></li>\n</ul>\n<p>Claims can be used as a means to differentiate users. Imagine we are building a postgres database and decide that all signed-in users will have the group role <code>user_login</code>. We can use the claims in the jwt to distinguish users</p>\n<p><em>Registered claim</em> - recommended pre-defined claims</p>\n<ul>\n<li><strong>iss</strong> (issuer)</li>\n<li><strong>exp</strong> (expiration time)</li>\n<li><strong>sub</strong> (subject)</li>\n<li><strong>aud</strong> (audience)</li>\n</ul>\n<h2 id=\"properties\">Properties<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#properties\"></a></h2>\n<ul>\n<li><code>iss</code> means the issuing entity, in this case, our authentication server</li>\n<li><code>iat</code> is the timestamp of creation of the JWT (in seconds since Epoch)</li>\n<li><code>sub</code> contains the technical identifier of the user</li>\n<li><code>exp</code> contains the token expiration timestamp</li>\n</ul></div></div><p></p><p></p>\n<h4 id=\"header\">Header<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#header\"></a></h4>\n<p>The receiver of the JWT needs to know what type of signature is used (here <code>RS256</code>).</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"alg\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"RS256\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"typ\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"JWT\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h4 id=\"signature\">Signature<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#signature\"></a></h4>\n<p></p><p></p><div class=\"portal-container\">\n<div class=\"portal-head\">\n<div class=\"portal-backlink\">\n<div class=\"portal-title\">From <span class=\"portal-text-title\">JWT Signature</span></div>\n<a href=\"/notes/O4UfJsjTp829l2zZQe0pL\" class=\"portal-arrow\">Go to text <span class=\"right-arrow\">â†’</span></a>\n</div>\n</div>\n<div id=\"portal-parent-anchor\" class=\"portal-parent\" markdown=\"1\">\n<div class=\"portal-parent-fader-top\"></div>\n<div class=\"portal-parent-fader-bottom\"></div><p>The signature is the key part of the JWT and is the part that provides its level of security.</p>\n<ul>\n<li>The signature is what enables a fully stateless server to be sure that a given HTTP request belongs to a given user, just by looking at a JWT token present in the request itself, and without forcing the password to be sent each time with the request.</li>\n<li>The signature is what proves that the payload is correct, and that it was actually sent by a given third party.</li>\n</ul>\n<p>While we can take the JWT header and payload and decode it with a base64 decoder, we cannot do the same with the signature. </p>\n<ul>\n<li>in other words, it is not JSON; it is a cryptographic signature.</li>\n</ul>\n<p>The JWT signature is created using the header, the claims AND the secret. Therefore, this unique combination creates a hash, and if something in the claim were to change, then the signature would be different and would no longer match up. </p>\n<ul>\n<li>What this means is that if the 1st and 2nd set of the JWT don't change, than neither will the 3rd (of course assuming the secret remains unchanging)</li>\n<li>Therefore, the signature of a JWT can only be produced by someone in possession of both the payload (plus the header) and a given secret key.</li>\n<li>in practice, a JWT will always be different between instances of the same user signing in, since the <code>exp</code> variable will always be different</li>\n</ul>\n<!-- TODO: broken image -->\n<p><img src=\"/:/fa5c3e7e2d95477e85f51bed49c6b4d9\" alt=\"8ded9f2b6239d7464fa7e85badce77c6.png\"></p>\n<p>The signature is a MAC (Message Authentication Code)</p>\n<p>Here is how the signature is used to ensure Authentication:</p>\n<ol>\n<li>the user submits the username and password to an Authentication server, which might be our Application server, but it's typically a separate server</li>\n<li>the Authentication server validates the username and password combination and creates a JWT token with a payload containing the user technical identifier and an expiration timestamp</li>\n<li>the Authentication server then takes a secret key, and uses it to sign the Header plus Payload and sends it back to the user browser</li>\n<li>the browser takes the signed JWT and starts sending it with each HTTP request to our Application server</li>\n<li>the signed JWT acts effectively as a temporary user credential, that replaces the permanent credential wich is the username and password combination</li>\n</ol>\n<p>From there, here is what our Application server does with the JWT token:</p>\n<ol>\n<li>our Application server checks the JWT signature and confirms that indeed someone in possession of the secret key signed this particular Payload. They know this because they can take the JWT header plus the payload and hash it together with the password (if HS256, the password must be the same as the possessed by the original issuer)</li>\n<li>The Payload identifies a particular user via a technical identifier</li>\n<li>Only the Authentication server is in possession of the private key, and the Authentication server only gives out tokens to users that submit the correct password</li>\n<li>therefore our Application server can safely be sure that this token was indeed given to this particular user by the Authentication server, meaning that it's indeed the user as it had the right password</li>\n<li>The server proceeds with processing the HTTP request assuming that it indeed it belongs to that user</li>\n</ol>\n<h3 id=\"signature-types\">Signature types<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#signature-types\"></a></h3>\n<p>There are many types of signature for JWTs, but two main types: HS256 and RS256.</p>\n<h4 id=\"hs256\">HS256<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#hs256\"></a></h4>\n<p>HS256 is a <a href=\"/notes/u0xXQ2GmDkPpk20TB9Y0N\">cryptographic hashing function</a></p>\n<ul>\n<li>It is a symmetric algorithm, which means that there is only one private key that must be kept secret, and it is shared between the two parties</li>\n<li>can be brute forced if the input secret key is weak (could also be said about many other key-based technologies)</li>\n<li>requires the existence of a previously agreed upon secret between the original issuer of the JWT and any other server consuming JWTs (e.g. application server). Therefore, to change the secret is non-trivial.\n<ul>\n<li>this means everyone who has the secret password can create JWTs. This also means there are more places where the secret can be stolen.</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"rs256-preferred\">RS256 (preferred)<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#rs256-preferred\"></a></h4>\n<p>RS256 uses a <a href=\"/notes/bO8xztJCzUxsN2sM4YsBE\">public-key/private-key</a> paradigm. The implication is that while only the authentication provider can sign (create) JWTs, the servers that consume JWTs can only validate them.</p>\n<ul>\n<li>It is an asymmetric algorithm, which means that there are two keys: one public key and one private key that must be kept secret\n<ul>\n<li>The auth server has the private key used to generate the signature, and the consumer of the JWT retrieves a public key from the metadata endpoints provided by the auth server and uses it to validate the JWT signature.</li>\n</ul>\n</li>\n<li>the auth server cannot validate tokens.</li>\n</ul>\n<p>RS256 is preferred, since:</p>\n<ul>\n<li>you are sure that only the holder of the private key (ie. the auth server) can sign tokens, while anyone can check if the token is valid using the public key.</li>\n<li>if the private key is compromised, you can implement key rotation without having to re-deploy your application or API with the new secret (which you would have to do if using HS256).</li>\n</ul>\n<p>RS256 signatures use RSA keys (which uses one key to encrypt and another to decrypt)</p>\n<ul>\n<li>this isn't a hashing function, since the operation is reversible.</li>\n</ul>\n</div></div><p></p><p></p>\n<h2 id=\"why-use-it\">Why use it?<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#why-use-it\"></a></h2>\n<p>The biggest advantage of JWTs (when compared to <a href=\"/notes/0NyqVKRyLLG6J1NDvFX5k\">user session management</a> using an in-memory random token) is that they enable the delegation of the authentication logic to a third-party server, such as:</p>\n<ul>\n<li>a centralized in-house auth server </li>\n<li>LDAP (Lightweight Directory Access Protocol)</li>\n<li>third-party authentication provider like Auth0</li>\n</ul>\n<p>This allows a system where:</p>\n<ul>\n<li>The external authentication server can be completely separate from our application server. There is no secret key that has to be shared over the network. This means all the application server has to do is check the JWT.\n<ul>\n<li>the authentication server has the private key, while the application server has the public key.</li>\n</ul>\n</li>\n<li>No direct live link between the application server and the authentication server is needed</li>\n<li>The application server can be completely stateless (since we don't need to keep tokens in-memory between requests). The authentication server can issue the token, send it back and then immediately discard it.</li>\n</ul>\n<p>The only way for an attacker to impersonate a user would be to either </p>\n<ul>\n<li>steal both its username and personal login password </li>\n<li>steal the secret signing key from the Authentication server.</li>\n</ul>\n<p>JWTs are tamper-proof.</p>\n<ul>\n<li>in the days of <a href=\"/notes/gmHyIstUcxJ1M04jtEZa6\">cookie</a>-based authentication, if an attacker gained access to that cookie, they could tamper it and cause that client to issue hostile requests to the server. If an attacker tried to tamper with a JWT, it would destroy the hash and would no longer match the decoded data of the JWT.</li>\n</ul>\n<p>JWTs allow servers to be decoupled from authentication.</p>\n<ul>\n<li>Consider the <em>Basic Authentication</em> method of HTTP. In this scheme, we pass the <code>username:password</code> as a <a href=\"/notes/YYt62mSW964cwb5nP0hva\">base64</a> encoded string to the server with each request. This means that the server needs to know how to verify user account credentials. This coupling is remedied by having JWTs, since a querying client just has to present the valid JWT in order to be considered a legitimate user. Now, the server doesn't need any knowledge about authentication, it just has to know how to verify the JWT.</li>\n</ul>\n<h2 id=\"how-do-they-work\">How do they work?<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-do-they-work\"></a></h2>\n<ol>\n<li>User logs in with email and password</li>\n<li>The Authentication server issues a JWT to the client</li>\n<li>The client goes to view a list of private data, so a request to the resource server is made.</li>\n<li>The resource server validates the content of the payload by inspecting the signature. \n<ul>\n<li>validation can be done by using <em>asynchronous cryptographic signatures</em> or by using a shared signing key.</li>\n</ul>\n</li>\n</ol>\n<p><img src=\"/assets/images/2022-12-14-13-10-02.png\"></p>\n<p>There are multiple types of signature, so one of the things that the receiver needs to know is for example which type of signature to look for.</p>\n<ul>\n<li>this is found in the header</li>\n</ul>\n<p>hashing the header and payload makes it much smaller. therefore hashing is not an functional part of it (ie. it's not about making it more secure); it's a performance part.</p>\n<h3 id=\"analogy-money-vs-cheque\">Analogy: Money vs Cheque<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#analogy-money-vs-cheque\"></a></h3>\n<p>When we give a $20 bill to someone, there is not a second thought as to where this money came from or if the bearer is the legitimate owner. The person who we are giving this money to does not need to verify with anyone of its legitimacy, and it is simply trusted</p>\n<p>On the other hand, when we pay with a cheque, a call needs to be made to the central authority (the bank) to verify if this cheque-holder is who they say they are.</p>\n<p>In this analogy, the cash is like a JWT: the system is designed where we can just trust the bearer of the money.</p>\n<hr>\n<h3 id=\"token-ex-jwt\">Token (ex. JWT)<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#token-ex-jwt\"></a></h3>\n<ul>\n<li>When user logs in, the server creates a JWT with the secret, and sends it to the client. The client stores the JWT in local storage, and includes that JWT in every request.</li>\n<li>The biggest difference here is that the userâ€™s state is not stored on the server, as the state is stored inside the token on the client side instead</li>\n</ul>\n<p>The whole point of JWTs is to not require centralized coordination.</p>\n<ul>\n<li>this is why there is no <code>/logout</code> endpoint to hit when we use JWTs for authentication. Instead, we just need to delete it from local storage.</li>\n</ul>\n<p>A JWT is just a regular javascript object that is stringified, hashed, and cryptographically signed.</p>\n<ul>\n<li>Your token is signed with the secret, known only by the server. If someone changes the token on client side, it would fail validation and the server side framework would reject it. Therefore you can trust your token. Of course, the jwtSecret should be a secret only known by your authentication server and resource server.</li>\n</ul>\n<p>JWTs are agnostic to what form of authentication you are using (ex. email, OAuth etc). Regardless, the response will contain the JWT.</p>\n<p>You generate the token only if you trust the user who requested it.</p>\n<ul>\n<li>You trust the token as long as it has not expired and can be verified with the secret.</li>\n<li>The information in a JWT can be read by anyone, so do not put private information in a JWT. What makes JWTs secure is that unless they were signed by our secret, we can not accept the information inside the JWT as truth.</li>\n</ul>\n<p>JWTs guarantee that the bearer of the token also owns the data that he is requesting.</p>\n<ul>\n<li>However JWTs don't guarantee encryption, which is why HTTPS is required. Otherwise, a man in the middle could take that server response (with the jwt) and use it to authenticate itself on your behalf, gaining access to all data.</li>\n</ul>\n<p>JWTs come with a death sentenceâ€” that is, by nature they have an expiry date.</p>\n<ul>\n<li>this value is stored in the <code>iat</code> property. This can be thought of as the <code>date_of_death</code> property.</li>\n<li>The server determines the lifespan of the JWT, since it controls the expiry date. Therefore, JWTs give a uniform lifespan to all JWTs, but like God, it has control over ending your life prematurely in order to deny access.</li>\n</ul>\n<p>JWTs are stateless (while <a href=\"/notes/0NyqVKRyLLG6J1NDvFX5k\">sessions</a> are stateful). This fact enables them to be verified on the server, without having to make a database call. This in principle makes them faster than using sessions (since sessions need to be stored).</p>\n<ul>\n<li>In reality, it's likely that the times we need to authenticate ourseleves with the JWT are also times that we need to interact with the database. This makes \"saving trips to the database\" more of a pipe-dream than a reality. At the end of the day, if we need to make a database interaction <em>and</em> authenticate ourselves, we are quicker just using a session rather than authenticating with a JWT (due to their size)\n<ul>\n<li>spec: The assumption here is that Sessions are stored in the same database as our app resources. If instead we have a separate session manager service, then we will always have to make 2 requests.</li>\n</ul>\n</li>\n</ul>\n<p>JWTs are huge. Storing a userid in a cookie is 6 bytes, while storing in the JWT (along with headers+secret) makes it 304 bytes.</p>\n<p><img src=\"/assets/images/2021-03-08-16-41-50.png\"></p>\n<ul>\n<li>unlike a cookie, a JWT can contain an unlimited amount of data</li>\n</ul>\n<h3 id=\"logout\">Logout<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#logout\"></a></h3>\n<p>There is no <code>/logout</code> endpoint to hit, as all we need to do is delete the JWT kept on the client.</p>\n<ul>\n<li>This means the token is still valid even after you logout. This is why keeping a short expiry date is important</li>\n</ul>\n<h3 id=\"analogy\">Analogy<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#analogy\"></a></h3>\n<p><em>\"Pretend Iâ€™m blind and hard of hearing. Letâ€™s also pretend that last week you bought me lunch, and now I need your bank account number to pay you back. If I ask you for your bank account number in person, and someone else shouts their bank account number, I might accidentally send them the money I owe you.\nThatâ€™s because I heard someone shout a bank account number, and I trusted that it was you, even though in this case, it wasnâ€™t.\nJWTs were designed to prevent this sort of thing from happening. JWTs give people an easy way to pass data between each other, while at the same time verifying who created the data in the first place.\nIf I received 1,000,000 different JWTs that contained a bank account number, Iâ€™d easily be able to tell which one actually came from you.</em>\"</p>\n<h2 id=\"e-resources\">E Resources<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#e-resources\"></a></h2>\n<ul>\n<li><a href=\"https://blog.logrocket.com/jwt-authentication-best-practices/#:~:text=A%20JWT%20needs%20to%20be,storage%20(or%20session%20storage).\">Good high level overview. Includes links to other good content</a></li>\n<li><a href=\"https://blog.angular-university.io/angular-jwt/\">Full guide</a></li>\n</ul>\n<p>e being used to store user information that was used to authenticate them with a resource server. This is dangerous, b</p>\n<hr>\n<strong>Children</strong>\n<ol>\n<li><a href=\"/notes/wXUxgZM5Oi21cN1uIX0Yw\">JSON Web Key</a></li>\n<li><a href=\"/notes/1VJ1TOJSxesXFEIXjtamD\">JWT Claim</a></li>\n<li><a href=\"/notes/O4UfJsjTp829l2zZQe0pL\">JWT Signature</a></li>\n</ol>\n<hr>\n<strong>Backlinks</strong>\n<ul>\n<li><a href=\"/notes/0NyqVKRyLLG6J1NDvFX5k\">Session</a></li>\n<li><a href=\"/notes/97fecf63-24b2-46d0-86f6-f88b4813d1f3\">Auth Tokens</a></li>\n<li><a href=\"/notes/yBNgydTx5k1BfiGgW3BbD\">Federated Identity</a></li>\n</ul>","noteIndex":{"id":"olZIVfSs2uLLr3BppFh4K","title":"Digital Garden","desc":"","updated":1674517603573,"created":1615482407722,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"effb007003ca6a91d7fd0c293e1d2436","links":[{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"testing.method.unit","alias":"unit testing","position":{"start":{"line":18,"column":121,"offset":1146},"end":{"line":18,"column":157,"offset":1182},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"testing.method.unit"}},{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"general.arch.microservice","alias":"microservices","position":{"start":{"line":18,"column":188,"offset":1213},"end":{"line":18,"column":231,"offset":1256},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.arch.microservice"}},{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"paradigm.oop","alias":"OOP","position":{"start":{"line":36,"column":227,"offset":2718},"end":{"line":36,"column":247,"offset":2738},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"paradigm.oop"}}],"anchors":{"tags":{"type":"header","text":"Tags","value":"tags","line":46,"column":0,"depth":3},"resources":{"type":"header","text":"Resources","value":"resources","line":55,"column":0,"depth":2},"ue-unexamined-resources":{"type":"header","text":"UE (Unexamined) Resources","value":"ue-unexamined-resources","line":56,"column":0,"depth":3},"e-examined-resources":{"type":"header","text":"E (Examined) Resources","value":"e-examined-resources","line":59,"column":0,"depth":3},"resources-1":{"type":"header","text":"Resources","value":"resources-1","line":62,"column":0,"depth":3}},"children":["40ubf88tephzbdjte8cdsa0","zFMjbn3xihVNHjUIdZCD1","IK6NOKemuDjhfstJBovKL","ZaTr28eWk1DrXOEsc1YVb","Vi0WYVLZunVM9iR8XZJn3","ngAbg7gluvbt1bY1UIRsi","RCPPXSakm5TvKka8kOmVp","LIcuGYV0DDt1VWbvH6Sed","MPx8ykTP57I40WTZvTP7f","ZU5WmdTG1bHoE8RcmZXZG","jqWiyYJff92RjXuUQt9PQ","KihijM8OQvZ4pASkkhqzL","F9vyqvls3OBCujtukqKhy","k6jxm2b3edgkhbordpuz6v1","facc2b01-755a-409f-99f6-57bef2d1501f","bZumdyapJ2H0wWWOmJ45i","elqpgoe2r951si4xrhujppj","m5ov42Vm6mR7RQWTvl1NW","cw8cerc0cos8lh871oz8rtf","PZxxZ4iESzSlbbHJKxuAZ","UDu62Pa6BaRqlG8uGoMhy","u3zcndycwqessho5h6x0nz9","ZgCUp366YrF2Tyky2NT73","DVpVUmavSoVDA7UIlPzLX","nMCtMXVvjBsJk3iw1zoIO","ANfx9Z4a6ZA0uJuSHtbIJ","BkG557LKUYbH1DnxprEVT","1TaH8zDTM98FZ9SYaeXLM","02v7ymc144e5c4pv3edkud7","dc79799f-a55d-48ab-a8be-c48adb1b19c0","f6feef57-b8f5-451f-a09a-7b63f6a07183","4sz47Y0LKs1Si73rWtyyh","g7ulqi8no93ezeocbesc3ll","5a9fb1df-478e-4687-9be0-5cb97e61ec57","1374e9e9-1cbc-4e1f-b1ca-66b8569533dd","D8Z3rjXkSj2EOymXQXF4Z","np3c1ykvnjqv5xoombpfwqz","f529cc34-aba0-45ca-ad7e-02ddda318941","0zcauha3il2NqtxZazIo7","9bbd6f68-03b2-41f4-92e4-2ca313e8b450","5a2ab598-fa7e-4471-8bda-9f5831b679ae","uV6w4mZPoohWyZV4Xaad0","QHXEIyeZGIGMVi5Q52UWI","RgE0mZLaUjPftFPZsiAoe","mytCOts26Pidush65tdRW","fwUzxfLSPMH1eL8oBoLWx","wazdsda6h25x66edvfmeuiv","TbW7PM9bg1y5TGkiWwQ8b","xiSIDeEtIc8X0lpUQlppI","0jxgntiLNHWFuCbzqtFGF","GkdMprLUe4QQULBxmGN6V","4SYc6v5hxY5g6Ip6kjpwO","czi7ilt2i1uoqm1f2otbntj","fqVQpS9FBiXgKsZX3R3sJ","L5JUZlGAGvTxrsEBB7DY8","ttyri4pwfyn5lcx0vp9804o","TeTedoeS2LdHPR632eCpM","ulicRRwo3lSFzh3tMfWH9","p7d24vyb8m00ombzn34t50c","e65188a1-177e-4ab2-99f9-75f85d537621","fajYnbVhCRDi74xn0H30R","bArGdGwqo3iFkyKMyE7qR","4Dcp7gbEVoLLgfu7bXFai","5d700782-fb81-416e-83f9-5dd88260e350","zubgzhNFE6KlTgXcjTz6O","8lpdfWa0cbSq1XJQbcYcY","2psluywdc416t7vrql0m058","17I8ZksXvqCH1mRtZDjHp","kF916Ow84qpJJeMRkWMIo","tMLkLcrIHHBz56xVmBLkP","CSePBQ6q7qhowKESqVwt7","laZ4OfLhZNK1Kuy6GaWUr","z5IJblOknQhMzZ5QZh4ye","N36FHxfxzwJfxDY3miWyX","3bb25f58-2b50-4fa3-af55-48ea9f88a081","7x07qjgbitozdfszqzuy7ix","u93Rz4fEWGu6VBR30Zraf","9hjMHnKvYT4jLKvuDSXaV","qC5GxCZBmNb4Ip6c0kU8x","LgW7mTIALODoXc54B3p6S","UYPxfHBFWX7fb6hHU5bB6","74lYtC8NKpCzcyFOZTfR1","sEoBNAEuaTxwSmTXDonZt","dj0jr9mpvs62e2pkg3zc3yy","z8ie0xjogb6ht7gzowav5xr","qxSOd6SPN8qf9ZUojVFDX","WQoMTf6VXBaxCgksXAVsj","2Mw4XgfyCHXHNOX5yoCIY","qcdt2f7jo51muquo5r95dpo","0XJqmcdtcMZu66glBI5O8","lK8r8BXS4ThiUTe4xKIZe","93de42ca-53ea-460a-baa7-b9ec5c47cb1e","Rxs2jaGpdFzqYtP7lAJFJ","aO8W81Z0PyIb6Hs7nOHPW","lhzisalkebu4w5n01np07i0","7b5l4b6fi65n7sv9org5q1l","I01hENHnh8Tqu3Ok8sLzG","03o3n0hz9v9jtb7j889zpd4","evqsPNutOaZ8hcBCqxFQu","zhhxcjZUHdU8uRLwGb9Zh","G1aFACZB2ooWGMGwyd3ZW","YWy1C4tgoaCcw1m8JJsr7","Szj3o5iaNxPpesiCqwrbu","613syb18hb3v0u1ydvor7ru","XhvCDW3fIw6h6MhY5ticq","Q70g7SusFZBQXzkuQifv4","AzfWDH3wp7jFpL2EYxBcW","y0fwpZ9qMqirsLiFyOciU","ZF8xj8wwDUqKlrwTrCFZ1","tAJvhqhdfyZZa87QHq1TU","4hRmipi8lxpBLyzWu5JVB","iTg0C7QjvnmqBZeEigJNs","3babc3d2-79ae-470a-9c06-ab8bba2e684e","bF3UsMFya3fMeXWDspVov","ULkfbL9WpktbVYnzhl6Jw","PpNOO8JYWe6dM8wruSa7x","di40pCxDn7IiqE8lFdD46","rmW0mkerqV35I8QPji6lM","3IFIK1ByzeIxZCByryGLN","iImkYAKfkw3beAl6pLbDn","ecDe8DNWrkeQTwpTEvHje","i2it5id8qwtg27n4usg8bo1","Yqhdd9mSJGN7OJOeyoSD2","Ws5tah8tpeyn9tK8VBTg8","gWAg15uBJgkS2B0wcpMAa","l7V3v2ep1YdDCt7DOr7Ci","yM2PJBdqJnHpD63cPA6sW","qn0bre7eLbi3QMbCfWkUi","fSu0KxFL41IRouotqmbHs","0gtg24Mj1a1bQFPRGQNlO","7iQPBMltLPLbFEz2qbjPu","yoh4pwoXcfELInGKRdYf6","dCGCWXgAmiOZXbdULT1m6","jMavlje07sNa6hSEIE8WA","Xxm0JE4dKHxrQAaZfzvxD","nRb6Im4Kcmc2ZWE7K1jZ1","PAEBZCyFBZJyR7OoMZ41E","PQ6km8RgRCuyICBPOYz8f","x5tm1nfjzyawwzedy3yitgd","2bhftt8rGuxYu4pFgNqru","hjYIZpHQWuXfeEoGeJEKW","K2M9bQqVq2eQfm29eslKL","X8obW1iKwYsvNgKWGyCzy","yJwSC7hqYIezTFHf5i0Ev","c4Z7ETcOHUILRMH32Sfjw","qiR6dIu857b9M9kTqjOyK","fc2coz74cnfy5czzofx4h5x","Ku1OgHMhELajzo61Gx7ye","LUrfhDWo8wuwZu7CN9TV8","osu6JGOnvXJ5gt3tpqWZY","1a6173cd-cf13-4b34-a522-8350bf9a364f","S2sBltrPfd8a7ICuD7CuH","GLQ2pmkJUNUa93THBDVsD","md6xitz4exia2joa06i490b","oWCuBXOg6JWfZzjmKxmNl","jOmhZ8ovLYTPbpM1vqSDx","p9bov84s0isgkl1ysaw93kk","FraC6xzLy1ei91l1ICyc9","6ceBas2RE9Q4787GDngH7","734cd78d-0bc9-426b-803d-1efc84dfffe5","k4Bb09px6r0FxIRs49SXV","oaG3H1S9IUBO644nGZigu","Ka7agQJkUMRSWN0uFdkWK","si3z090WsiLasMhJBa1Az","hs6rwzt4mogiicoc4gcykbi","ljKAVERmdEiKLK9hXGKBm","zxt3lhonfdhglvijd17ua8c","dd7dopve1dudqkoibkqvti4","923tgifqf59ovv5yldtyi0a","vrjwp01goqw47fqctm4f4lo","c99gdmmppju3r1tth8cb2jx","z2pvn5qxdz84zgygqzxage8"],"parent":null,"data":{},"body":"This Dendron vault of tech knowledge is organized according to domains and their sub-domains, along with specific implementation of those domains.\n\nFor instance, Git itself is a domain. Sub-domains of Git would include things like `commit`,\n`tags`, `reflog` etc. implementations of each of those could be `cli`, `strat`\n(strategies), `inner`, and so on.\n\nThe goal of the wiki is to present data in a manner that is from the perspective\nof a querying user. Here, a user is a programmer wanting to get key information\nfrom a specific domain. For instance, if a user wants to use postgres functions\nand hasn't done them in a while, they should be able to query\n`postgres.functions` to see what information is available to them.\n\nThis wiki has been written with myself in mind. While learning each of these\ndomains, I have been sensitive to the \"aha\" moments and have noted down my\ninsights as they arose. I have refrained from capturing information that I\nconsidered obvious or otherwise non-beneficial to my own understanding.\n\nAs a result, I have allowed myself to use potentially arcane concepts to explain other ones. For example, in my note on [[unit testing|testing.method.unit]], I have made reference to the [[microservices|general.arch.microservice]] note. If these notes were made with the public in mind, this would be a very bad strategy, given that you'd have to understand microservices to be able to draw that same parallel that I've already drawn. Since these notes are written for myself, I have been fine with taking these liberties.\n\nWhat I hope to gain from this wiki is the ability to step away from any\ngiven domain for a long period of time, and be able to be passably useful for\nwhatever my goals are within a short period of time. Of course this is all\nvague sounding, and really depends on the domain along with the ends I am\ntrying to reach.\n\nTo achieve this, the system should be steadfast to:\n- be able to put information in relatively easily, without too much thought\n\trequired to its location. While location is important, Dendron makes it easy\n\tto relocate notes, if it becomes apparent that a different place makes more\n\tsense.\n- be able to extract the information that is needed, meaning there is a\n\thigh-degree in confidence in the location of the information. The idea is\n\tthat information loses a large amount of its value when it is unfindable.\n\tTherefore, a relatively strict ideology should be used when determining\n\twhere a piece of information belongs.\n\t- Some concepts might realistically belong to multiple domains. For instance, the concept of *access modifiers* can be found in both `C#` and `Typescript`. Therefore, this note should be abstracted to a common place, such as [[OOP|paradigm.oop]].\n\nThis Dendron vault is the sister component to the [General Second Brain](https://tech.kyletycholiz.com).\n\n### Tags\nThroughout the garden, I have made use of tags, which give semantic meaning to the pieces of information.\n\n- `ex.` - Denotes an *example* of the preceding piece of information\n- `spec:` - Specifies that the preceding information has some degree of *speculation* to it, and may not be 100% factual. Ideally this gets clarified over time as my understanding develops.\n- `anal:` - Denotes an *analogy* of the preceding information. Often I will attempt to link concepts to others that I have previously learned.\n- `mn:` - Denotes a *mnemonic*\n- `expl:` - Denotes an *explanation*\n\n## Resources\n### UE (Unexamined) Resources\nOften, I come across sources of information that I believe to be high-quality. They may be recommendations or found in some other way. No matter their origin, I may be in a position where I don't have the time to fully examine them (and properly extract notes), or I may not require the information at that moment in time. In cases like these, I will add reference to a section of the note called **UE Resources**. The idea is that in the future when I am ready to examine them, I have a list of resources that I can start with. This is an alternative strategy to compiling browser bookmarks, which I've found can quickly become untenable.\n\n### E (Examined) Resources\nOnce a resource has been thoroughly examined and has been mined for notes, it will be moved from *UE Resources* to *E Resources*. This is to indicate that (in my own estimation), there is nothing more to be gained from the resource that is not already in the note.\n\n### Resources\nThis heading is for inexhaustible resources. \n- A prime example would be a quality website that continually posts articles.  - Another example would be a tool, such as software that measures frequencies in a room to help acoustically treat it.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"dendronVersion":"0.83.0","vaults":[{"fsPath":"../main/tech","name":"tech"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"The Tech Digital Garden of Kyle Tycholiz"},"github":{"cname":"tech.kyletycholiz.com","enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"master","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","enableMermaid":true,"siteUrl":"https://tech.kyletycholiz.com","duplicateNoteBehavior":{"action":"useVault","payload":["tech"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}