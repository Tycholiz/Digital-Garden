<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><title>Kafka</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Publishable tech notes"/><meta property="og:title" content="Kafka"/><meta property="og:description" content="Publishable tech notes"/><meta property="og:url" content="https://tycholiz.github.io/Digital-Garden/notes/WQoMTf6VXBaxCgksXAVsj/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="3/8/2021"/><meta property="article:modified_time" content="12/6/2021"/><link rel="canonical" href="https://tycholiz.github.io/Digital-Garden/notes/WQoMTf6VXBaxCgksXAVsj/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/Digital-Garden/_next/static/css/804c5fc85a5d7e04.css" as="style"/><link rel="stylesheet" href="/Digital-Garden/_next/static/css/804c5fc85a5d7e04.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/Digital-Garden/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/Digital-Garden/_next/static/chunks/webpack-d53c65e15128d807.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/framework-dc33c0b5493501f0.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/main-9409ea3202b3ee44.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/pages/_app-585c2573c1834e35.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/155-0a8d44b6408c244d.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/pages/notes/%5Bid%5D-30a63e62504f2dc5.js" defer=""></script><script src="/Digital-Garden/_next/static/s-Pdpb0Y8fVIEUakhzEMN/_buildManifest.js" defer=""></script><script src="/Digital-Garden/_next/static/s-Pdpb0Y8fVIEUakhzEMN/_ssgManifest.js" defer=""></script><script src="/Digital-Garden/_next/static/s-Pdpb0Y8fVIEUakhzEMN/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div class="ant-col ant-col-xs-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"></div><div class="ant-col ant-col-xs-12"></div><div style="margin-left:4px;display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout" style="flex-direction:row"><section class="ant-layout site-layout-sidebar" style="flex:0 0 auto;width:calc((100% - 992px) / 2 + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></section><section class="ant-layout side-layout-main" style="max-width:1200px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="kafka"><a aria-hidden="true" class="anchor-heading" href="#kafka"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Kafka</h1>
<ul>
<li>Traditionally, we use only databases as sole data storage, and think of that data in terms of "things", along with their state.
<ul>
<li>Kafka encourages us to think of events first, and things second.</li>
</ul>
</li>
<li>Kafka stores data in a distributed log instead of a database.
<ul>
<li>log is an ordered sequence of events, along with state and a description of what happened</li>
<li>Kafka is a system for managing these logs (in Kafka, a log is called a <code>Topic</code>)</li>
</ul>
</li>
<li>logs are easy to build at scale</li>
<li>Implementations of Kafka are declarative</li>
<li>Kafka can be quite complex to operate.
<ul>
<li>AWS offers MSK (Managed Streaming for Kafka), making the management of a Kafka cluster trivial.</li>
</ul>
</li>
</ul>
<h3 id="topic"><a aria-hidden="true" class="anchor-heading" href="#topic"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Topic</h3>
<p>An ordered collection of events stored in a durable way.
spec: A topic represents a single type of event</p>
<ul>
<li>Durable - written to disk, and replicated</li>
<li>Can be thought of as a <em>real-time stream</em></li>
<li>Topics can be thought of as a database table
<ul>
<li>ex. if we were doing this in Postgres, we could have tables <code>geofence_entry_events</code>, <code>low_tire_pressure_warning_events</code></li>
</ul>
</li>
</ul>
<p>Kafka Services can be used as a sort of glue between microservices of an application. A microservice can consume a message from the Kafka Topic, and produce an output which gets registered to another Topic.</p>
<ul>
<li>Since it can act as glue between many services, we can produce an output from these Topics that can be consumed by a new service to perform real-time analysis of that data
<ul>
<li>This is contrast to the old-school method of running a batch-process overnight</li>
</ul>
</li>
</ul>
<h3 id="kafka-connect"><a aria-hidden="true" class="anchor-heading" href="#kafka-connect"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Kafka Connect</h3>
<p>Imagine we have multiple databases, a legacy service, and a SaaS product, and we want a way to get the data that they produce into Kafka.</p>
<ul>
<li>Kafka Connect helps us get that data into Kafka, and back out again.</li>
<li>Kafka Connect is a general term to refer to 100's of pluggable modules that handle the I/O of the whatever service we are connecting to.
<ul>
<li>ex. There would be a connector to capture row-level changes in a Postgres database.</li>
</ul>
</li>
</ul>
<p>Connectors are either Source or Sink Connectors, and are responsible for a some of the Task management, but not the actual data movement.</p>
<h3 id="kafka-streams"><a aria-hidden="true" class="anchor-heading" href="#kafka-streams"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Kafka Streams</h3>
<ul>
<li>A Java API that performs helps us perform grouping, aggregating, filtering, enrichment (table joining)</li>
<li>the API would be used from within the services</li>
<li>This is available to us out of the box as a consequence of using Kafka.</li>
</ul>
<h4 id="ksql"><a aria-hidden="true" class="anchor-heading" href="#ksql"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>KSQL</h4>
<ul>
<li>a language that allows us to to use SQL-like syntax to query data from one Topic, and output it into another Topic.</li>
<li>Solves the problem statement: imagine we want to perform some analysis on data kept in Kafka, but we don't want to stand up a separate service to consume that data.</li>
</ul>
<h3 id="confluent"><a aria-hidden="true" class="anchor-heading" href="#confluent"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Confluent</h3>
<ul>
<li>a distribution of Kafka.</li>
<li>open source, but offers a paid managed service (similar to Docker)</li>
</ul>
<h3 id="kafka-vs-logstash"><a aria-hidden="true" class="anchor-heading" href="#kafka-vs-logstash"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Kafka vs Logstash</h3>
<p><a href="https://stackoverflow.com/questions/40864312/how-logstash-is-different-than-kafka">Kafka is a cluster; Logstash is a single instance</a></p>
<h3 id="kafka-vs-rabbitmq"><a aria-hidden="true" class="anchor-heading" href="#kafka-vs-rabbitmq"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Kafka vs RabbitMQ</h3>
<p>These are different forms of communicating. When service A calls service B to exchange information, it's similar to a phone conversation. I ask you a question, and you respond. In the meantime we're both occupied with that conversation; you have to have time to talk with me, and so do I.</p>
<p>RabbitMQ and Kafka (and similar tools) also support two more types of communication:</p>
<ol>
<li><em>Topics</em>: a topic is a one-way one to many conversation. Basically it's like standing on a soapbox and shouting to a megaphone. Whoever is interested can listen; I don't care if that is zero people or a hundred. I send my message and the broker (kafka/rabbit) makes sure whoever is subscribed to the topic all get the message.</li>
<li><em>Queues</em>: a queue is similar to sending letters to a company. I send a letter complaining about their service, and within that company someone opens and reads this letter. I'm not involved anymore after I send  the letter. While there may be a hundred workers opening letters, only one of them is going to be handling mine. Copies don't magically appear.</li>
</ol>
<p>So both queues and topics are one-way communication that are fire and forget (asynchronous). This as opposed to TCP (and HTTP on top of that) that are two-way synchronous communication. The broker guarantees that the other side gets the message. Depending on how you configure (for example) Kafka; you can either have a single service get a message (queue example), all of the services get the same message (topic example) or something in between.</p>
<p>When working with microservices you want every unit to be as decoupled as possible.</p>
<ul>
<li>Let's say you have a component that handles user information (<code>A</code>) and you have some other module that need to do something every time a user updates his info (<code>B</code>). The classic way to do it would be to make <code>A</code> send some signal (usually an http request) to <code>B</code> so it knows it has work to do. But, for that, <code>A</code> needs to know a lot about <code>B</code>. And what if you now have <code>C</code> that needs to be triggered to? Or <code>D</code> that needs to process just some of the users? <code>A</code> would need to keep track of all of this, meanings they are highly coupled.</li>
<li>With a broker, <code>A</code> just publishes that there's a change, and all other components can subscribe to this event and react accordingly. This way, components can be added or removed with minimal impact on the overall structure.</li>
</ul>
<h2 id="do-you-need-kafka"><a aria-hidden="true" class="anchor-heading" href="#do-you-need-kafka"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Do you need Kafka?</h2>
<p>From Reddit <a href="https://www.reddit.com/r/apachekafka/comments/hyxezo/kafka_when_to_use_and_when_not_to_use/">thread</a>:</p>
<p>Kafka is like an event bus for distributed messages. It can't solve the intractable problem of distributed systems, but it does provide a nice framework for handling messages at scale.</p>
<p>I would say if you don't need Kafka, then that's a perfectly good reason not to use it. You might have a monolith, you might have a series of services that all own their data within a database, and they all communicate via REST APIs. If that works, then Kafka won't really serve a purpose.</p>
<p>You start to need Kafka when you run into the constraints of distributed scale. If you have more events than any single worker can handle, and you've decided you can't increase the available CPU and memory any further, then you start facing distributed messaging problems.</p>
<p>As soon as two computers located some distance from each other try to determine what is true, and what happened first, you'll run into problems. Your next goal is to try and figure out which constraints you're willing to bend.</p>
<p>Maybe your pipeline doesn't actually care about order, but absolutely cares that you don't drop a single record. Maybe you only care about throughput. Maybe you care about order, but not about availability. Eventually somethings gotta give. Kafka just helps you manage that infrastructure, it doesn't solve the underlying issues.</p>
<p>If you run an app that collects logs and metrics, order might not matter. Just send everything down the pipe and you'll aggregate later. But you probably wouldn't run your banking transaction on it.</p>
<h3 id="using-kafka-in-a-logging-system"><a aria-hidden="true" class="anchor-heading" href="#using-kafka-in-a-logging-system"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Using Kafka in a Logging system</h3>
<p>"There are plenty of open-source tools available for logging. We decided to use Graylog—an excellent tool for logging—and Apache Kafka, a messaging system to collect and digest logs from our containers. The containers send logs to Kafka, and Kafka hands them off to Graylog for indexing. We chose to make the application components send logs to Kafka themselves so that we could stream logs in an easy-to-index format. Alternatively, there are tools that retrieve logs from outside the container and forward them to a logging solution."</p>
<h1 id="ue-resources"><a aria-hidden="true" class="anchor-heading" href="#ue-resources"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>UE Resources</h1>
<p><a href="https://kafka-tutorials.confluent.io/">The place to start learning Kafka</a>
<a href="https://www.confluent.io/blog/getting-started-with-kafkajs/">Getting Started</a>
<a href="https://github.com/Azure/azure-functions-kafka-extension">Kafka with Azure Functions</a>
<a href="https://medium.com/@Instaclustr/apache-kafka-connect-architecture-overview-842097d3eb96">Connect Architecture</a></p>
<hr>
<h2 id="backlinks"><a aria-hidden="true" class="anchor-heading" href="#backlinks"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Backlinks</h2>
<ul>
<li><a href="/Digital-Garden/notes/3r7tbyDBkWsTEM3czdzZZ">Lambda</a></li>
<li><a href="/Digital-Garden/notes/vtLtsv3Vsdt6pTTASCq4u">Streaming</a></li>
<li><a href="/Digital-Garden/notes/0pUoWXrTC07Z9B1ijwosK">Dead Letter Queue</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#topic" title="Topic">Topic</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#kafka-connect" title="Kafka Connect">Kafka Connect</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#kafka-streams" title="Kafka Streams">Kafka Streams</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#ksql" title="KSQL">KSQL</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#confluent" title="Confluent">Confluent</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#kafka-vs-logstash" title="Kafka vs Logstash">Kafka vs Logstash</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#kafka-vs-rabbitmq" title="Kafka vs RabbitMQ">Kafka vs RabbitMQ</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#do-you-need-kafka" title="Do you need Kafka?">Do you need Kafka?</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#using-kafka-in-a-logging-system" title="Using Kafka in a Logging system">Using Kafka in a Logging system</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#ue-resources" title="UE Resources">UE Resources</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"WQoMTf6VXBaxCgksXAVsj","title":"Kafka","desc":"","updated":1638822924208,"created":1615222852556,"custom":{},"fname":"kafka","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"4eeb75190e17471e6a9d4c393e9021ca","links":[{"from":{"fname":"general.arch.lambda","vaultName":"tech"},"type":"backlink","position":{"start":{"line":7,"column":187,"offset":568},"end":{"line":7,"column":209,"offset":590},"indent":[]},"value":"kafka"},{"from":{"fname":"general.arch.streaming","vaultName":"tech"},"type":"backlink","position":{"start":{"line":5,"column":32,"offset":436},"end":{"line":5,"column":47,"offset":451},"indent":[]},"value":"kafka"},{"from":{"fname":"general.patterns.messaging.DLQ","vaultName":"tech"},"type":"backlink","position":{"start":{"line":10,"column":102,"offset":476},"end":{"line":10,"column":111,"offset":485},"indent":[]},"value":"kafka"}],"anchors":{"topic":{"type":"header","text":"Topic","value":"topic","line":18,"column":0,"depth":3},"kafka-connect":{"type":"header","text":"Kafka Connect","value":"kafka-connect","line":30,"column":0,"depth":3},"kafka-streams":{"type":"header","text":"Kafka Streams","value":"kafka-streams","line":38,"column":0,"depth":3},"ksql":{"type":"header","text":"KSQL","value":"ksql","line":43,"column":0,"depth":4},"confluent":{"type":"header","text":"Confluent","value":"confluent","line":47,"column":0,"depth":3},"kafka-vs-logstash":{"type":"header","text":"Kafka vs Logstash","value":"kafka-vs-logstash","line":51,"column":0,"depth":3},"kafka-vs-rabbitmq":{"type":"header","text":"Kafka vs RabbitMQ","value":"kafka-vs-rabbitmq","line":54,"column":0,"depth":3},"do-you-need-kafka":{"type":"header","text":"Do you need Kafka?","value":"do-you-need-kafka","line":67,"column":0,"depth":2},"using-kafka-in-a-logging-system":{"type":"header","text":"Using Kafka in a Logging system","value":"using-kafka-in-a-logging-system","line":82,"column":0,"depth":3},"ue-resources":{"type":"header","text":"UE Resources","value":"ue-resources","line":85,"column":0,"depth":1}},"children":[],"parent":"olZIVfSs2uLLr3BppFh4K","data":{}},"body":"\u003ch1 id=\"kafka\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#kafka\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eKafka\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eTraditionally, we use only databases as sole data storage, and think of that data in terms of \"things\", along with their state.\n\u003cul\u003e\n\u003cli\u003eKafka encourages us to think of events first, and things second.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eKafka stores data in a distributed log instead of a database.\n\u003cul\u003e\n\u003cli\u003elog is an ordered sequence of events, along with state and a description of what happened\u003c/li\u003e\n\u003cli\u003eKafka is a system for managing these logs (in Kafka, a log is called a \u003ccode\u003eTopic\u003c/code\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003elogs are easy to build at scale\u003c/li\u003e\n\u003cli\u003eImplementations of Kafka are declarative\u003c/li\u003e\n\u003cli\u003eKafka can be quite complex to operate.\n\u003cul\u003e\n\u003cli\u003eAWS offers MSK (Managed Streaming for Kafka), making the management of a Kafka cluster trivial.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"topic\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#topic\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eTopic\u003c/h3\u003e\n\u003cp\u003eAn ordered collection of events stored in a durable way.\nspec: A topic represents a single type of event\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDurable - written to disk, and replicated\u003c/li\u003e\n\u003cli\u003eCan be thought of as a \u003cem\u003ereal-time stream\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003eTopics can be thought of as a database table\n\u003cul\u003e\n\u003cli\u003eex. if we were doing this in Postgres, we could have tables \u003ccode\u003egeofence_entry_events\u003c/code\u003e, \u003ccode\u003elow_tire_pressure_warning_events\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eKafka Services can be used as a sort of glue between microservices of an application. A microservice can consume a message from the Kafka Topic, and produce an output which gets registered to another Topic.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSince it can act as glue between many services, we can produce an output from these Topics that can be consumed by a new service to perform real-time analysis of that data\n\u003cul\u003e\n\u003cli\u003eThis is contrast to the old-school method of running a batch-process overnight\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"kafka-connect\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#kafka-connect\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eKafka Connect\u003c/h3\u003e\n\u003cp\u003eImagine we have multiple databases, a legacy service, and a SaaS product, and we want a way to get the data that they produce into Kafka.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eKafka Connect helps us get that data into Kafka, and back out again.\u003c/li\u003e\n\u003cli\u003eKafka Connect is a general term to refer to 100's of pluggable modules that handle the I/O of the whatever service we are connecting to.\n\u003cul\u003e\n\u003cli\u003eex. There would be a connector to capture row-level changes in a Postgres database.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eConnectors are either Source or Sink Connectors, and are responsible for a some of the Task management, but not the actual data movement.\u003c/p\u003e\n\u003ch3 id=\"kafka-streams\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#kafka-streams\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eKafka Streams\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eA Java API that performs helps us perform grouping, aggregating, filtering, enrichment (table joining)\u003c/li\u003e\n\u003cli\u003ethe API would be used from within the services\u003c/li\u003e\n\u003cli\u003eThis is available to us out of the box as a consequence of using Kafka.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"ksql\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#ksql\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eKSQL\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003ea language that allows us to to use SQL-like syntax to query data from one Topic, and output it into another Topic.\u003c/li\u003e\n\u003cli\u003eSolves the problem statement: imagine we want to perform some analysis on data kept in Kafka, but we don't want to stand up a separate service to consume that data.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"confluent\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#confluent\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eConfluent\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ea distribution of Kafka.\u003c/li\u003e\n\u003cli\u003eopen source, but offers a paid managed service (similar to Docker)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"kafka-vs-logstash\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#kafka-vs-logstash\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eKafka vs Logstash\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://stackoverflow.com/questions/40864312/how-logstash-is-different-than-kafka\"\u003eKafka is a cluster; Logstash is a single instance\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"kafka-vs-rabbitmq\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#kafka-vs-rabbitmq\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eKafka vs RabbitMQ\u003c/h3\u003e\n\u003cp\u003eThese are different forms of communicating. When service A calls service B to exchange information, it's similar to a phone conversation. I ask you a question, and you respond. In the meantime we're both occupied with that conversation; you have to have time to talk with me, and so do I.\u003c/p\u003e\n\u003cp\u003eRabbitMQ and Kafka (and similar tools) also support two more types of communication:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cem\u003eTopics\u003c/em\u003e: a topic is a one-way one to many conversation. Basically it's like standing on a soapbox and shouting to a megaphone. Whoever is interested can listen; I don't care if that is zero people or a hundred. I send my message and the broker (kafka/rabbit) makes sure whoever is subscribed to the topic all get the message.\u003c/li\u003e\n\u003cli\u003e\u003cem\u003eQueues\u003c/em\u003e: a queue is similar to sending letters to a company. I send a letter complaining about their service, and within that company someone opens and reads this letter. I'm not involved anymore after I send  the letter. While there may be a hundred workers opening letters, only one of them is going to be handling mine. Copies don't magically appear.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eSo both queues and topics are one-way communication that are fire and forget (asynchronous). This as opposed to TCP (and HTTP on top of that) that are two-way synchronous communication. The broker guarantees that the other side gets the message. Depending on how you configure (for example) Kafka; you can either have a single service get a message (queue example), all of the services get the same message (topic example) or something in between.\u003c/p\u003e\n\u003cp\u003eWhen working with microservices you want every unit to be as decoupled as possible.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLet's say you have a component that handles user information (\u003ccode\u003eA\u003c/code\u003e) and you have some other module that need to do something every time a user updates his info (\u003ccode\u003eB\u003c/code\u003e). The classic way to do it would be to make \u003ccode\u003eA\u003c/code\u003e send some signal (usually an http request) to \u003ccode\u003eB\u003c/code\u003e so it knows it has work to do. But, for that, \u003ccode\u003eA\u003c/code\u003e needs to know a lot about \u003ccode\u003eB\u003c/code\u003e. And what if you now have \u003ccode\u003eC\u003c/code\u003e that needs to be triggered to? Or \u003ccode\u003eD\u003c/code\u003e that needs to process just some of the users? \u003ccode\u003eA\u003c/code\u003e would need to keep track of all of this, meanings they are highly coupled.\u003c/li\u003e\n\u003cli\u003eWith a broker, \u003ccode\u003eA\u003c/code\u003e just publishes that there's a change, and all other components can subscribe to this event and react accordingly. This way, components can be added or removed with minimal impact on the overall structure.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"do-you-need-kafka\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#do-you-need-kafka\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eDo you need Kafka?\u003c/h2\u003e\n\u003cp\u003eFrom Reddit \u003ca href=\"https://www.reddit.com/r/apachekafka/comments/hyxezo/kafka_when_to_use_and_when_not_to_use/\"\u003ethread\u003c/a\u003e:\u003c/p\u003e\n\u003cp\u003eKafka is like an event bus for distributed messages. It can't solve the intractable problem of distributed systems, but it does provide a nice framework for handling messages at scale.\u003c/p\u003e\n\u003cp\u003eI would say if you don't need Kafka, then that's a perfectly good reason not to use it. You might have a monolith, you might have a series of services that all own their data within a database, and they all communicate via REST APIs. If that works, then Kafka won't really serve a purpose.\u003c/p\u003e\n\u003cp\u003eYou start to need Kafka when you run into the constraints of distributed scale. If you have more events than any single worker can handle, and you've decided you can't increase the available CPU and memory any further, then you start facing distributed messaging problems.\u003c/p\u003e\n\u003cp\u003eAs soon as two computers located some distance from each other try to determine what is true, and what happened first, you'll run into problems. Your next goal is to try and figure out which constraints you're willing to bend.\u003c/p\u003e\n\u003cp\u003eMaybe your pipeline doesn't actually care about order, but absolutely cares that you don't drop a single record. Maybe you only care about throughput. Maybe you care about order, but not about availability. Eventually somethings gotta give. Kafka just helps you manage that infrastructure, it doesn't solve the underlying issues.\u003c/p\u003e\n\u003cp\u003eIf you run an app that collects logs and metrics, order might not matter. Just send everything down the pipe and you'll aggregate later. But you probably wouldn't run your banking transaction on it.\u003c/p\u003e\n\u003ch3 id=\"using-kafka-in-a-logging-system\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#using-kafka-in-a-logging-system\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eUsing Kafka in a Logging system\u003c/h3\u003e\n\u003cp\u003e\"There are plenty of open-source tools available for logging. We decided to use Graylog—an excellent tool for logging—and Apache Kafka, a messaging system to collect and digest logs from our containers. The containers send logs to Kafka, and Kafka hands them off to Graylog for indexing. We chose to make the application components send logs to Kafka themselves so that we could stream logs in an easy-to-index format. Alternatively, there are tools that retrieve logs from outside the container and forward them to a logging solution.\"\u003c/p\u003e\n\u003ch1 id=\"ue-resources\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#ue-resources\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eUE Resources\u003c/h1\u003e\n\u003cp\u003e\u003ca href=\"https://kafka-tutorials.confluent.io/\"\u003eThe place to start learning Kafka\u003c/a\u003e\n\u003ca href=\"https://www.confluent.io/blog/getting-started-with-kafkajs/\"\u003eGetting Started\u003c/a\u003e\n\u003ca href=\"https://github.com/Azure/azure-functions-kafka-extension\"\u003eKafka with Azure Functions\u003c/a\u003e\n\u003ca href=\"https://medium.com/@Instaclustr/apache-kafka-connect-architecture-overview-842097d3eb96\"\u003eConnect Architecture\u003c/a\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"backlinks\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#backlinks\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eBacklinks\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/Digital-Garden/notes/3r7tbyDBkWsTEM3czdzZZ\"\u003eLambda\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/Digital-Garden/notes/vtLtsv3Vsdt6pTTASCq4u\"\u003eStreaming\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/Digital-Garden/notes/0pUoWXrTC07Z9B1ijwosK\"\u003eDead Letter Queue\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"olZIVfSs2uLLr3BppFh4K","title":"Root","desc":"","updated":1618676699718,"created":1615482407722,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"777fb4dab9bcf63cbfe772245d7e4871","links":[],"anchors":{"digital-garden":{"type":"header","text":"Digital Garden","value":"digital-garden","line":8,"column":0,"depth":1}},"children":["zFMjbn3xihVNHjUIdZCD1","IK6NOKemuDjhfstJBovKL","RS8qp1GxwtiJopCUHTTtq","ZaTr28eWk1DrXOEsc1YVb","Vi0WYVLZunVM9iR8XZJn3","ngAbg7gluvbt1bY1UIRsi","RCPPXSakm5TvKka8kOmVp","MPx8ykTP57I40WTZvTP7f","ZU5WmdTG1bHoE8RcmZXZG","jqWiyYJff92RjXuUQt9PQ","KihijM8OQvZ4pASkkhqzL","F9vyqvls3OBCujtukqKhy","facc2b01-755a-409f-99f6-57bef2d1501f","m5ov42Vm6mR7RQWTvl1NW","YYt62mSW964cwb5nP0hva","PZxxZ4iESzSlbbHJKxuAZ","UDu62Pa6BaRqlG8uGoMhy","nMCtMXVvjBsJk3iw1zoIO","ANfx9Z4a6ZA0uJuSHtbIJ","BkG557LKUYbH1DnxprEVT","1TaH8zDTM98FZ9SYaeXLM","dc79799f-a55d-48ab-a8be-c48adb1b19c0","f6feef57-b8f5-451f-a09a-7b63f6a07183","4sz47Y0LKs1Si73rWtyyh","5a9fb1df-478e-4687-9be0-5cb97e61ec57","1374e9e9-1cbc-4e1f-b1ca-66b8569533dd","f529cc34-aba0-45ca-ad7e-02ddda318941","0zcauha3il2NqtxZazIo7","9bbd6f68-03b2-41f4-92e4-2ca313e8b450","5a2ab598-fa7e-4471-8bda-9f5831b679ae","uV6w4mZPoohWyZV4Xaad0","RgE0mZLaUjPftFPZsiAoe","mytCOts26Pidush65tdRW","fwUzxfLSPMH1eL8oBoLWx","TbW7PM9bg1y5TGkiWwQ8b","xiSIDeEtIc8X0lpUQlppI","0jxgntiLNHWFuCbzqtFGF","GkdMprLUe4QQULBxmGN6V","4SYc6v5hxY5g6Ip6kjpwO","fqVQpS9FBiXgKsZX3R3sJ","L5JUZlGAGvTxrsEBB7DY8","963c4b54-02bd-4943-a15f-52cf59ffd0f4","TeTedoeS2LdHPR632eCpM","e65188a1-177e-4ab2-99f9-75f85d537621","fajYnbVhCRDi74xn0H30R","bArGdGwqo3iFkyKMyE7qR","4Dcp7gbEVoLLgfu7bXFai","5d700782-fb81-416e-83f9-5dd88260e350","zubgzhNFE6KlTgXcjTz6O","8lpdfWa0cbSq1XJQbcYcY","17I8ZksXvqCH1mRtZDjHp","kF916Ow84qpJJeMRkWMIo","tMLkLcrIHHBz56xVmBLkP","CSePBQ6q7qhowKESqVwt7","laZ4OfLhZNK1Kuy6GaWUr","z5IJblOknQhMzZ5QZh4ye","N36FHxfxzwJfxDY3miWyX","3bb25f58-2b50-4fa3-af55-48ea9f88a081","aOqNcxZh8qN4MoBJcvGTc","u93Rz4fEWGu6VBR30Zraf","9hjMHnKvYT4jLKvuDSXaV","LgW7mTIALODoXc54B3p6S","UYPxfHBFWX7fb6hHU5bB6","qxSOd6SPN8qf9ZUojVFDX","WQoMTf6VXBaxCgksXAVsj","2Mw4XgfyCHXHNOX5yoCIY","UFrwsXzC1yr7Ge8FF8Vbo","a8edc4ac-028b-40ec-872a-e4a005b04b2a","0XJqmcdtcMZu66glBI5O8","lK8r8BXS4ThiUTe4xKIZe","93de42ca-53ea-460a-baa7-b9ec5c47cb1e","Rxs2jaGpdFzqYtP7lAJFJ","aO8W81Z0PyIb6Hs7nOHPW","I01hENHnh8Tqu3Ok8sLzG","evqsPNutOaZ8hcBCqxFQu","zhhxcjZUHdU8uRLwGb9Zh","G1aFACZB2ooWGMGwyd3ZW","YWy1C4tgoaCcw1m8JJsr7","Szj3o5iaNxPpesiCqwrbu","XhvCDW3fIw6h6MhY5ticq","Q70g7SusFZBQXzkuQifv4","AzfWDH3wp7jFpL2EYxBcW","y0fwpZ9qMqirsLiFyOciU","ZF8xj8wwDUqKlrwTrCFZ1","tAJvhqhdfyZZa87QHq1TU","4hRmipi8lxpBLyzWu5JVB","iTg0C7QjvnmqBZeEigJNs","3babc3d2-79ae-470a-9c06-ab8bba2e684e","bF3UsMFya3fMeXWDspVov","ULkfbL9WpktbVYnzhl6Jw","PpNOO8JYWe6dM8wruSa7x","di40pCxDn7IiqE8lFdD46","rmW0mkerqV35I8QPji6lM","3IFIK1ByzeIxZCByryGLN","iImkYAKfkw3beAl6pLbDn","tho65KN0ZpjQlVvP1fEzM","ecDe8DNWrkeQTwpTEvHje","Yqhdd9mSJGN7OJOeyoSD2","NEhsoOfR7J6o01ielAuUm","Ws5tah8tpeyn9tK8VBTg8","Bqpifx2HX3vjLhX9yvhTV","gWAg15uBJgkS2B0wcpMAa","l7V3v2ep1YdDCt7DOr7Ci","yM2PJBdqJnHpD63cPA6sW","qn0bre7eLbi3QMbCfWkUi","fSu0KxFL41IRouotqmbHs","0gtg24Mj1a1bQFPRGQNlO","7iQPBMltLPLbFEz2qbjPu","yoh4pwoXcfELInGKRdYf6","dCGCWXgAmiOZXbdULT1m6","jMavlje07sNa6hSEIE8WA","Xxm0JE4dKHxrQAaZfzvxD","PAEBZCyFBZJyR7OoMZ41E","PQ6km8RgRCuyICBPOYz8f","2bhftt8rGuxYu4pFgNqru","hjYIZpHQWuXfeEoGeJEKW","K2M9bQqVq2eQfm29eslKL","X8obW1iKwYsvNgKWGyCzy","yJwSC7hqYIezTFHf5i0Ev","c4Z7ETcOHUILRMH32Sfjw","qiR6dIu857b9M9kTqjOyK","8vflbCVkwZtYcqdDDTNAz","Ku1OgHMhELajzo61Gx7ye","LUrfhDWo8wuwZu7CN9TV8","osu6JGOnvXJ5gt3tpqWZY","1a6173cd-cf13-4b34-a522-8350bf9a364f","ZgCUp366YrF2Tyky2NT73","S2sBltrPfd8a7ICuD7CuH","oWCuBXOg6JWfZzjmKxmNl","jOmhZ8ovLYTPbpM1vqSDx","FraC6xzLy1ei91l1ICyc9","6ceBas2RE9Q4787GDngH7","734cd78d-0bc9-426b-803d-1efc84dfffe5","k4Bb09px6r0FxIRs49SXV","oaG3H1S9IUBO644nGZigu","Ka7agQJkUMRSWN0uFdkWK","si3z090WsiLasMhJBa1Az","ljKAVERmdEiKLK9hXGKBm","LIcuGYV0DDt1VWbvH6Sed","MgUSrpNCIwDOW4fX3vPOF","bZumdyapJ2H0wWWOmJ45i","QHXEIyeZGIGMVi5Q52UWI","i5Fya3Vzzm0rBT0ctByuo"],"parent":null,"data":{},"body":"\n# Digital Garden\n\nThis Wiki of Personal Information is organized according to domains and their\nsub-domains, along with specific implementation of those domains.\n\nFor instance, Git itself is a domain. Sub-domains of Git, would be `commit`,\n`tags`, `reflog` etc. implementations of each of those could be `cli`, `strat`\n(strategies), `inner` etc.\n\nThe goal of the wiki is to present data in a manner that is from the perspective\nof a querying user. Here, a user is a programmer wanting to get key information\nfrom a specific domain. For instance, if a user wants to use postgres functions\nand hasn't done them in a while, they should be able to query\n`postgres.functions` to see what information is available to them.\n\nThis wiki has been written with myself in mind. While learning each of these\ndomains, I have been sensitive to the \"aha\" moments and have noted down my\ninsights as they arose. I have refrained from capturing information that I\nconsidered obvious or otherwise non-beneficial to my own understanding.\n\nThe ability I hope to gain from this wiki is the ability to step away from any\ngiven domain for a long period of time, and be able to be passably useful for\nwhatever my goals are within a short period of time. Of course, this is all\nvague sounding, and really depends on the domain, along with the ends I am\ntrying to reach.\n\nTo achieve this, the system should be steadfast to:\n- be able to put information in relatively easily, without too much thought\n\trequired to make that determination.\n- be able to extract the information that we need, meaning there is a\n\thigh-degree in confidence in the location of the information. The idea is\n\tthat information loses a large amount of its value when it is unfindable.\n\tTherefore, a relatively strict ideology should be used when determining\n\twhere a piece of information belongs.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":3,"useFMTitle":true,"useNoteTitleForLink":true,"noLegacyNoteRef":true,"mermaid":true,"useKatex":true,"dev":{"enablePreviewV2":true},"site":{"assetsPrefix":"/Digital-Garden","siteUrl":"https://tycholiz.github.io","copyAssets":true,"siteHierarchies":["root"],"siteRootDir":"docs","usePrettyRefs":true,"title":"Dendron","description":"Publishable tech notes","duplicateNoteBehavior":{"action":"useVault","payload":["tech"]},"siteLastModified":true,"gh_edit_branch":"main","usePrettyLinks":true,"siteNotesDir":"notes","siteFaviconPath":"favicon.ico","gh_edit_link":true,"gh_edit_link_text":"Edit this page on GitHub","gh_root":"docs/","gh_edit_view_mode":"edit","writeStubs":true,"siteIndex":"root"},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{}},"workspace":{"dendronVersion":"0.67.1","vaults":[{"fsPath":"../main/tech","name":"tech"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"enableUserTags":true,"enableHashTags":true},"usePrettyRefs":true}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"WQoMTf6VXBaxCgksXAVsj"},"buildId":"s-Pdpb0Y8fVIEUakhzEMN","assetPrefix":"/Digital-Garden","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>