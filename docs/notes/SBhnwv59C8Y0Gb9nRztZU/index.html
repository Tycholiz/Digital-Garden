<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>Isolation</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="The Tech Digital Garden of Kyle Tycholiz"/><meta property="og:title" content="Isolation"/><meta property="og:description" content="The Tech Digital Garden of Kyle Tycholiz"/><meta property="og:url" content="https://tech.kyletycholiz.com/notes/SBhnwv59C8Y0Gb9nRztZU/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="3/10/2021"/><meta property="article:modified_time" content="2/21/2022"/><link rel="canonical" href="https://tech.kyletycholiz.com/notes/SBhnwv59C8Y0Gb9nRztZU/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/8e7b7e4bce421c0a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e7b7e4bce421c0a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3d209faeb64f2f97.js" defer=""></script><script src="/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/_next/static/chunks/main-104451f3d1a5c4bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6b338472289fe290.js" defer=""></script><script src="/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/_next/static/fo6gubzKP_KV9RZPhaoiQ/_buildManifest.js" defer=""></script><script src="/_next/static/fo6gubzKP_KV9RZPhaoiQ/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="isolation">Isolation<a aria-hidden="true" class="anchor-heading icon-link" href="#isolation"></a></h1>
<p>Isolation determines the extent to which items involved in a single <a href="/notes/4xb9cg487yio88c5b2j2bid">transaction</a> are visible to everything outside the transaction.</p>
<ul>
<li>a lower isolation level increases the ability of many users to access the same data at the same time, but increases the number of concurrency effects (such as dirty reads or lost updates) users might encounter. </li>
<li>a higher isolation level reduces the types of concurrency effects that users may encounter, but requires more system resources and increases the chances that one transaction will block another.</li>
</ul>
<p>Isolation is the idea that if we have multiple things to do in a single transaction, we can roll it back as a chunk.</p>
<ul>
<li>Imagine a transaction consists of 2 inserts and 1 update. The fact that we have atomicity means that we can rollback that whole transaction. This distinction is even more important when you consider multi-table transactions, which MongoDB does not offer.</li>
<li>ex. In old versions of MongoDB if you needed to remove an item from inventory and add it to someone's order at the same time, you could not.</li>
<li>ex. in multi-threaded programming, if one thread executes an atomic operation, that means there is no way that another thread could see the half-finished result of the operation. The system can only be in the state it was before the operation or after the operation, not something in between.
A transaction in process and not yet committed must remain isolated from any other transaction.</li>
</ul>
<p>Isolation is about having multiple <a href="/notes/W5etsXYnFDHBWHEHSZKjp">concurrently</a> executing transactions that are isolated from each other.</p>
<ul>
<li>The database ensures that when the transactions have committed, the result is the same as if they had run <em>serially</em> (one after another), even though in reality they may have run concurrently</li>
</ul>
<p>Isolation is the opposite side of atomicity.</p>
<ul>
<li>while we are doing our queries, are we allowed to see what is happening concurrently in the rest of the system?
<ul>
<li>ex. what if we want to make a backup with <code>pg_dump</code> that needs to run for several hours? That backup needs to be a consistent snapshot of the production database. If during the backup someone is doing inserts, we don't want these to be in the backup, since we want a snapshot that doesn't move.		- to do this, postgres uses an isolation mode that prevents this from happening.	</li>
</ul>
</li>
</ul>
<p>isolation can be implemented using a lock on each object (allowing only one thread to access an object at any one time)</p>
<p>In theory, isolation should make your life easier by letting you pretend that no concurrency is happening.</p>
<h2 id="levels-of-isolation">Levels of isolation<a aria-hidden="true" class="anchor-heading icon-link" href="#levels-of-isolation"></a></h2>
<p>By increasing levels of isolation, we are able to prevent some race conditions from happening.</p>
<p>Higher levels of isolation come with a performance cost that in most cases aren't worth it. It’s therefore common for systems to use weaker levels of isolation, which protect against some concurrency issues, but not all. </p>
<h3 id="read-committed">Read committed<a aria-hidden="true" class="anchor-heading icon-link" href="#read-committed"></a></h3>
<p>This is the most basic level of transaction isolation.</p>
<p>It makes two guarantees:</p>
<ol>
<li>When reading from the database, you will only see data that has been committed (no dirty reads).
<ul>
<li>if a transaction has written some data to the database, but the transaction has not yet committed or aborted, and another transaction can see that uncommitted data, that is called a <em>dirty read</em>.</li>
</ul>
</li>
<li>When writing to the database, you will only overwrite data that has been committed (no dirty writes).
<ul>
<li>if 2 transactions concurrently try to update the same object in a database, and second write overwrites an uncommitted value from the first write, that is called a <em>dirty write</em>. To prevent this, the second write must be delayed until the first transaction has completed.</li>
<li>databases prevent dirty writes by using row-level locks: when a transaction wants to modify a particular object (row or document), it must first acquire a lock on that object, and must only release it when the transaction has completed. </li>
</ul>
</li>
</ol>
<p>Read committed isolation does not prevent race conditions occurring when 2 different users are trying to increment the same counter simultaneously.</p>
<p>Read committed is a popular isolation level, and is the default setting in Postgres.</p>
<h3 id="snapshot-isolation">Snapshot isolation<a aria-hidden="true" class="anchor-heading icon-link" href="#snapshot-isolation"></a></h3>
<p>Snapshot isolation is a guarantee that all reads made in a transaction will see a consistent snapshot of the database, and the transaction itself will successfully commit only if no updates it has made conflict with any concurrent updates made since that snapshot.</p>
<ul>
<li>in practice it reads the values resulting from the last committed transaction that existed at the time it started</li>
</ul>
<p>Snapshot isolation has the mantra "readers never block writers, and writers never block readers".</p>
<p>The idea is that each transaction reads from a consistent snapshot of the database— that is, the transaction sees all the data that was committed in the database at the start of the transaction. Even if the data is subsequently changed by another transaction, each transaction sees only the old data from that particular point in time.</p>
<ul>
<li>snapshot isolation is therefore considered necessary for long-running, read-only queries such as backups and analytics. </li>
</ul>
<p>Allows better performance than serializability, yet still avoids most of the concurrency anomalies that serializability avoids.</p>
<p>implementations of snapshot isolation typically use write locks to prevent dirty writes</p>
<p>From a performance point of view, a key principle of snapshot isolation is readers never block writers, and writers never block readers. </p>
<ul>
<li>therefore, reads do not require any locks.</li>
</ul>
<p>Because it maintains several versions of an object side by side, this technique is known as multiversion concurrency control (MVCC).</p>
<p>Snapshot isolation is usually implemented by <a href="/notes/Mzsmv3XQV978L3jm2eumP">MVCC</a>.</p>
<p>used by Postgres (called <em>repeatable read</em>), Mongo, MySQL</p>
<h3 id="serializability">Serializability<a aria-hidden="true" class="anchor-heading icon-link" href="#serializability"></a></h3>
<p>Serializable isolation means that the database guarantees that transactions have the same effect as if they ran serially (i.e., one at a time, without any concurrency)</p>
<ul>
<li>by doing this, all possible race conditions are avoided.</li>
</ul>
<p>Serializability means each transaction can pretend that it is the only transaction running on the entire database. </p>
<p>Serializable isolation is rarely used because it carries a performance penalty.</p>
<p>There are 3 principal techniques to implementing serializability:</p>
<ol>
<li>Literally execute transactions in a serial order
<ul>
<li>possible when the entire active dataset can reside in <a href="/notes/siARuFkNsvSlUI0PLbh5E">memory</a></li>
<li>used in <a href="/notes/gWAg15uBJgkS2B0wcpMAa">Redis</a></li>
</ul>
</li>
<li>Two-phase locking</li>
<li>Optimistic concurrency control techniques such as serializable snapshot isolation</li>
</ol>
<p>In Postgres, Serializability is implemented as <em>serializable snapshot isolation</em> (SSI), which provides full serializability, but has only a small performance penalty compared to snapshot isolation. </p>
<ul>
<li>optimistic concurrency control technique. Optimistic in this context means that instead of blocking if something potentially dangerous happens, transactions continue anyway, in the hope that everything will turn out all right. When a transaction wants to commit, the database checks whether anything bad happened (i.e., whether isolation was violated); if so, the transaction is aborted and has to be retried. Only transactions that executed serializably are allowed to commit.</li>
</ul>
<h2 id="strategies">Strategies<a aria-hidden="true" class="anchor-heading icon-link" href="#strategies"></a></h2>
<h3 id="record-locking">Record Locking<a aria-hidden="true" class="anchor-heading icon-link" href="#record-locking"></a></h3>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/notes/kx2pz7bcwpswtpjcsmjlzlj">Race Conditions</a></li>
<li><a href="/notes/Ql1WxSHx11UTkDnfmYlzq">Consistency</a></li>
<li><a href="/notes/Mzsmv3XQV978L3jm2eumP">Concurrency</a></li>
<li><a href="/notes/4xb9cg487yio88c5b2j2bid">Transaction</a></li>
<li><a href="/notes/r9orvg7n574j5bmwon0nb74">Multi-version Concurrency Control (MVCC)</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#levels-of-isolation" title="Levels of isolation">Levels of isolation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#read-committed" title="Read committed">Read committed</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#snapshot-isolation" title="Snapshot isolation">Snapshot isolation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#serializability" title="Serializability">Serializability</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#strategies" title="Strategies">Strategies</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#record-locking" title="Record Locking">Record Locking</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"SBhnwv59C8Y0Gb9nRztZU","title":"Isolation","desc":"","updated":1645409943598,"created":1615338650024,"custom":{},"fname":"db.acid.isolation","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"e5607318b36c5226df9f84446fdf57c9","links":[{"type":"wiki","from":{"fname":"db.acid.isolation","id":"SBhnwv59C8Y0Gb9nRztZU","vaultName":"tech"},"value":"db.strategies.transaction","alias":"transaction","position":{"start":{"line":2,"column":69,"offset":69},"end":{"line":2,"column":110,"offset":110},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"db.strategies.transaction"}},{"type":"wiki","from":{"fname":"db.acid.isolation","id":"SBhnwv59C8Y0Gb9nRztZU","vaultName":"tech"},"value":"general.concurrency","alias":"concurrently","position":{"start":{"line":12,"column":36,"offset":1517},"end":{"line":12,"column":72,"offset":1553},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.concurrency"}},{"type":"wiki","from":{"fname":"db.acid.isolation","id":"SBhnwv59C8Y0Gb9nRztZU","vaultName":"tech"},"value":"db.strategies.concurrency-control","alias":"MVCC","position":{"start":{"line":60,"column":46,"offset":5720},"end":{"line":60,"column":88,"offset":5762},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"db.strategies.concurrency-control"}},{"type":"wiki","from":{"fname":"db.acid.isolation","id":"SBhnwv59C8Y0Gb9nRztZU","vaultName":"tech"},"value":"hardware.ram","alias":"memory","position":{"start":{"line":74,"column":58,"offset":6445},"end":{"line":74,"column":81,"offset":6468},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"hardware.ram"}},{"type":"wiki","from":{"fname":"db.acid.isolation","id":"SBhnwv59C8Y0Gb9nRztZU","vaultName":"tech"},"value":"Redis","position":{"start":{"line":75,"column":12,"offset":6480},"end":{"line":75,"column":21,"offset":6489},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"Redis"}},{"from":{"fname":"db.race-conditions","id":"kx2pz7bcwpswtpjcsmjlzlj","vaultName":"tech"},"type":"backlink","position":{"start":{"line":2,"column":27,"offset":27},"end":{"line":2,"column":58,"offset":58},"indent":[]},"value":"db.acid.isolation"},{"from":{"fname":"db.acid.consistency","id":"Ql1WxSHx11UTkDnfmYlzq","vaultName":"tech"},"type":"backlink","position":{"start":{"line":11,"column":80,"offset":950},"end":{"line":11,"column":111,"offset":981},"indent":[]},"value":"db.acid.isolation"},{"from":{"fname":"db.strategies.concurrency-control","id":"Mzsmv3XQV978L3jm2eumP","vaultName":"tech"},"type":"backlink","position":{"start":{"line":7,"column":1,"offset":645},"end":{"line":7,"column":32,"offset":676},"indent":[]},"value":"db.acid.isolation"},{"from":{"fname":"db.strategies.transaction","id":"4xb9cg487yio88c5b2j2bid","vaultName":"tech"},"type":"backlink","position":{"start":{"line":32,"column":211,"offset":3366},"end":{"line":32,"column":242,"offset":3397},"indent":[]},"value":"db.acid.isolation"},{"from":{"fname":"db.strategies.concurrency-control.MVCC","id":"r9orvg7n574j5bmwon0nb74","vaultName":"tech"},"type":"backlink","position":{"start":{"line":11,"column":74,"offset":811},"end":{"line":11,"column":128,"offset":865},"indent":[]},"value":"db.acid.isolation"}],"anchors":{"levels-of-isolation":{"type":"header","text":"Levels of isolation","value":"levels-of-isolation","line":29,"column":0,"depth":2},"read-committed":{"type":"header","text":"Read committed","value":"read-committed","line":34,"column":0,"depth":3},"snapshot-isolation":{"type":"header","text":"Snapshot isolation","value":"snapshot-isolation","line":48,"column":0,"depth":3},"serializability":{"type":"header","text":"Serializability","value":"serializability","line":70,"column":0,"depth":3},"strategies":{"type":"header","text":"Strategies","value":"strategies","line":88,"column":0,"depth":2},"record-locking":{"type":"header","text":"Record Locking","value":"record-locking","line":89,"column":0,"depth":3}},"children":[],"parent":"fCagNdVtAqMZw8CYsTZ7m","data":{}},"body":"\u003ch1 id=\"isolation\"\u003eIsolation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#isolation\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eIsolation determines the extent to which items involved in a single \u003ca href=\"/notes/4xb9cg487yio88c5b2j2bid\"\u003etransaction\u003c/a\u003e are visible to everything outside the transaction.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea lower isolation level increases the ability of many users to access the same data at the same time, but increases the number of concurrency effects (such as dirty reads or lost updates) users might encounter. \u003c/li\u003e\n\u003cli\u003ea higher isolation level reduces the types of concurrency effects that users may encounter, but requires more system resources and increases the chances that one transaction will block another.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIsolation is the idea that if we have multiple things to do in a single transaction, we can roll it back as a chunk.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eImagine a transaction consists of 2 inserts and 1 update. The fact that we have atomicity means that we can rollback that whole transaction. This distinction is even more important when you consider multi-table transactions, which MongoDB does not offer.\u003c/li\u003e\n\u003cli\u003eex. In old versions of MongoDB if you needed to remove an item from inventory and add it to someone's order at the same time, you could not.\u003c/li\u003e\n\u003cli\u003eex. in multi-threaded programming, if one thread executes an atomic operation, that means there is no way that another thread could see the half-finished result of the operation. The system can only be in the state it was before the operation or after the operation, not something in between.\nA transaction in process and not yet committed must remain isolated from any other transaction.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIsolation is about having multiple \u003ca href=\"/notes/W5etsXYnFDHBWHEHSZKjp\"\u003econcurrently\u003c/a\u003e executing transactions that are isolated from each other.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe database ensures that when the transactions have committed, the result is the same as if they had run \u003cem\u003eserially\u003c/em\u003e (one after another), even though in reality they may have run concurrently\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIsolation is the opposite side of atomicity.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ewhile we are doing our queries, are we allowed to see what is happening concurrently in the rest of the system?\n\u003cul\u003e\n\u003cli\u003eex. what if we want to make a backup with \u003ccode\u003epg_dump\u003c/code\u003e that needs to run for several hours? That backup needs to be a consistent snapshot of the production database. If during the backup someone is doing inserts, we don't want these to be in the backup, since we want a snapshot that doesn't move.\t\t- to do this, postgres uses an isolation mode that prevents this from happening.\t\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eisolation can be implemented using a lock on each object (allowing only one thread to access an object at any one time)\u003c/p\u003e\n\u003cp\u003eIn theory, isolation should make your life easier by letting you pretend that no concurrency is happening.\u003c/p\u003e\n\u003ch2 id=\"levels-of-isolation\"\u003eLevels of isolation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#levels-of-isolation\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eBy increasing levels of isolation, we are able to prevent some race conditions from happening.\u003c/p\u003e\n\u003cp\u003eHigher levels of isolation come with a performance cost that in most cases aren't worth it. It’s therefore common for systems to use weaker levels of isolation, which protect against some concurrency issues, but not all. \u003c/p\u003e\n\u003ch3 id=\"read-committed\"\u003eRead committed\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#read-committed\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThis is the most basic level of transaction isolation.\u003c/p\u003e\n\u003cp\u003eIt makes two guarantees:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eWhen reading from the database, you will only see data that has been committed (no dirty reads).\n\u003cul\u003e\n\u003cli\u003eif a transaction has written some data to the database, but the transaction has not yet committed or aborted, and another transaction can see that uncommitted data, that is called a \u003cem\u003edirty read\u003c/em\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eWhen writing to the database, you will only overwrite data that has been committed (no dirty writes).\n\u003cul\u003e\n\u003cli\u003eif 2 transactions concurrently try to update the same object in a database, and second write overwrites an uncommitted value from the first write, that is called a \u003cem\u003edirty write\u003c/em\u003e. To prevent this, the second write must be delayed until the first transaction has completed.\u003c/li\u003e\n\u003cli\u003edatabases prevent dirty writes by using row-level locks: when a transaction wants to modify a particular object (row or document), it must first acquire a lock on that object, and must only release it when the transaction has completed. \u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eRead committed isolation does not prevent race conditions occurring when 2 different users are trying to increment the same counter simultaneously.\u003c/p\u003e\n\u003cp\u003eRead committed is a popular isolation level, and is the default setting in Postgres.\u003c/p\u003e\n\u003ch3 id=\"snapshot-isolation\"\u003eSnapshot isolation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#snapshot-isolation\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSnapshot isolation is a guarantee that all reads made in a transaction will see a consistent snapshot of the database, and the transaction itself will successfully commit only if no updates it has made conflict with any concurrent updates made since that snapshot.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ein practice it reads the values resulting from the last committed transaction that existed at the time it started\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSnapshot isolation has the mantra \"readers never block writers, and writers never block readers\".\u003c/p\u003e\n\u003cp\u003eThe idea is that each transaction reads from a consistent snapshot of the database— that is, the transaction sees all the data that was committed in the database at the start of the transaction. Even if the data is subsequently changed by another transaction, each transaction sees only the old data from that particular point in time.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esnapshot isolation is therefore considered necessary for long-running, read-only queries such as backups and analytics. \u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAllows better performance than serializability, yet still avoids most of the concurrency anomalies that serializability avoids.\u003c/p\u003e\n\u003cp\u003eimplementations of snapshot isolation typically use write locks to prevent dirty writes\u003c/p\u003e\n\u003cp\u003eFrom a performance point of view, a key principle of snapshot isolation is readers never block writers, and writers never block readers. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003etherefore, reads do not require any locks.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBecause it maintains several versions of an object side by side, this technique is known as multiversion concurrency control (MVCC).\u003c/p\u003e\n\u003cp\u003eSnapshot isolation is usually implemented by \u003ca href=\"/notes/Mzsmv3XQV978L3jm2eumP\"\u003eMVCC\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eused by Postgres (called \u003cem\u003erepeatable read\u003c/em\u003e), Mongo, MySQL\u003c/p\u003e\n\u003ch3 id=\"serializability\"\u003eSerializability\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#serializability\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSerializable isolation means that the database guarantees that transactions have the same effect as if they ran serially (i.e., one at a time, without any concurrency)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eby doing this, all possible race conditions are avoided.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSerializability means each transaction can pretend that it is the only transaction running on the entire database. \u003c/p\u003e\n\u003cp\u003eSerializable isolation is rarely used because it carries a performance penalty.\u003c/p\u003e\n\u003cp\u003eThere are 3 principal techniques to implementing serializability:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eLiterally execute transactions in a serial order\n\u003cul\u003e\n\u003cli\u003epossible when the entire active dataset can reside in \u003ca href=\"/notes/siARuFkNsvSlUI0PLbh5E\"\u003ememory\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eused in \u003ca href=\"/notes/gWAg15uBJgkS2B0wcpMAa\"\u003eRedis\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eTwo-phase locking\u003c/li\u003e\n\u003cli\u003eOptimistic concurrency control techniques such as serializable snapshot isolation\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eIn Postgres, Serializability is implemented as \u003cem\u003eserializable snapshot isolation\u003c/em\u003e (SSI), which provides full serializability, but has only a small performance penalty compared to snapshot isolation. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eoptimistic concurrency control technique. Optimistic in this context means that instead of blocking if something potentially dangerous happens, transactions continue anyway, in the hope that everything will turn out all right. When a transaction wants to commit, the database checks whether anything bad happened (i.e., whether isolation was violated); if so, the transaction is aborted and has to be retried. Only transactions that executed serializably are allowed to commit.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"strategies\"\u003eStrategies\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#strategies\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"record-locking\"\u003eRecord Locking\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#record-locking\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/kx2pz7bcwpswtpjcsmjlzlj\"\u003eRace Conditions\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/Ql1WxSHx11UTkDnfmYlzq\"\u003eConsistency\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/Mzsmv3XQV978L3jm2eumP\"\u003eConcurrency\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/4xb9cg487yio88c5b2j2bid\"\u003eTransaction\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/r9orvg7n574j5bmwon0nb74\"\u003eMulti-version Concurrency Control (MVCC)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"olZIVfSs2uLLr3BppFh4K","title":"Digital Garden","desc":"","updated":1674517603573,"created":1615482407722,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"effb007003ca6a91d7fd0c293e1d2436","links":[{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"testing.method.unit","alias":"unit testing","position":{"start":{"line":18,"column":121,"offset":1146},"end":{"line":18,"column":157,"offset":1182},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"testing.method.unit"}},{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"general.arch.microservice","alias":"microservices","position":{"start":{"line":18,"column":188,"offset":1213},"end":{"line":18,"column":231,"offset":1256},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.arch.microservice"}},{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"paradigm.oop","alias":"OOP","position":{"start":{"line":36,"column":227,"offset":2718},"end":{"line":36,"column":247,"offset":2738},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"paradigm.oop"}}],"anchors":{"tags":{"type":"header","text":"Tags","value":"tags","line":46,"column":0,"depth":3},"resources":{"type":"header","text":"Resources","value":"resources","line":55,"column":0,"depth":2},"ue-unexamined-resources":{"type":"header","text":"UE (Unexamined) Resources","value":"ue-unexamined-resources","line":56,"column":0,"depth":3},"e-examined-resources":{"type":"header","text":"E (Examined) Resources","value":"e-examined-resources","line":59,"column":0,"depth":3},"resources-1":{"type":"header","text":"Resources","value":"resources-1","line":62,"column":0,"depth":3}},"children":["40ubf88tephzbdjte8cdsa0","zFMjbn3xihVNHjUIdZCD1","IK6NOKemuDjhfstJBovKL","ZaTr28eWk1DrXOEsc1YVb","Vi0WYVLZunVM9iR8XZJn3","ngAbg7gluvbt1bY1UIRsi","RCPPXSakm5TvKka8kOmVp","LIcuGYV0DDt1VWbvH6Sed","MPx8ykTP57I40WTZvTP7f","ZU5WmdTG1bHoE8RcmZXZG","jqWiyYJff92RjXuUQt9PQ","KihijM8OQvZ4pASkkhqzL","F9vyqvls3OBCujtukqKhy","k6jxm2b3edgkhbordpuz6v1","facc2b01-755a-409f-99f6-57bef2d1501f","bZumdyapJ2H0wWWOmJ45i","elqpgoe2r951si4xrhujppj","m5ov42Vm6mR7RQWTvl1NW","cw8cerc0cos8lh871oz8rtf","PZxxZ4iESzSlbbHJKxuAZ","UDu62Pa6BaRqlG8uGoMhy","u3zcndycwqessho5h6x0nz9","ZgCUp366YrF2Tyky2NT73","DVpVUmavSoVDA7UIlPzLX","nMCtMXVvjBsJk3iw1zoIO","ANfx9Z4a6ZA0uJuSHtbIJ","BkG557LKUYbH1DnxprEVT","1TaH8zDTM98FZ9SYaeXLM","02v7ymc144e5c4pv3edkud7","dc79799f-a55d-48ab-a8be-c48adb1b19c0","f6feef57-b8f5-451f-a09a-7b63f6a07183","4sz47Y0LKs1Si73rWtyyh","g7ulqi8no93ezeocbesc3ll","5a9fb1df-478e-4687-9be0-5cb97e61ec57","1374e9e9-1cbc-4e1f-b1ca-66b8569533dd","D8Z3rjXkSj2EOymXQXF4Z","np3c1ykvnjqv5xoombpfwqz","f529cc34-aba0-45ca-ad7e-02ddda318941","0zcauha3il2NqtxZazIo7","9bbd6f68-03b2-41f4-92e4-2ca313e8b450","5a2ab598-fa7e-4471-8bda-9f5831b679ae","uV6w4mZPoohWyZV4Xaad0","QHXEIyeZGIGMVi5Q52UWI","RgE0mZLaUjPftFPZsiAoe","mytCOts26Pidush65tdRW","fwUzxfLSPMH1eL8oBoLWx","wazdsda6h25x66edvfmeuiv","TbW7PM9bg1y5TGkiWwQ8b","xiSIDeEtIc8X0lpUQlppI","0jxgntiLNHWFuCbzqtFGF","GkdMprLUe4QQULBxmGN6V","4SYc6v5hxY5g6Ip6kjpwO","czi7ilt2i1uoqm1f2otbntj","fqVQpS9FBiXgKsZX3R3sJ","L5JUZlGAGvTxrsEBB7DY8","ttyri4pwfyn5lcx0vp9804o","TeTedoeS2LdHPR632eCpM","ulicRRwo3lSFzh3tMfWH9","p7d24vyb8m00ombzn34t50c","e65188a1-177e-4ab2-99f9-75f85d537621","fajYnbVhCRDi74xn0H30R","bArGdGwqo3iFkyKMyE7qR","4Dcp7gbEVoLLgfu7bXFai","5d700782-fb81-416e-83f9-5dd88260e350","zubgzhNFE6KlTgXcjTz6O","8lpdfWa0cbSq1XJQbcYcY","2psluywdc416t7vrql0m058","17I8ZksXvqCH1mRtZDjHp","kF916Ow84qpJJeMRkWMIo","tMLkLcrIHHBz56xVmBLkP","CSePBQ6q7qhowKESqVwt7","laZ4OfLhZNK1Kuy6GaWUr","z5IJblOknQhMzZ5QZh4ye","N36FHxfxzwJfxDY3miWyX","3bb25f58-2b50-4fa3-af55-48ea9f88a081","7x07qjgbitozdfszqzuy7ix","u93Rz4fEWGu6VBR30Zraf","9hjMHnKvYT4jLKvuDSXaV","qC5GxCZBmNb4Ip6c0kU8x","LgW7mTIALODoXc54B3p6S","UYPxfHBFWX7fb6hHU5bB6","74lYtC8NKpCzcyFOZTfR1","sEoBNAEuaTxwSmTXDonZt","dj0jr9mpvs62e2pkg3zc3yy","z8ie0xjogb6ht7gzowav5xr","qxSOd6SPN8qf9ZUojVFDX","WQoMTf6VXBaxCgksXAVsj","2Mw4XgfyCHXHNOX5yoCIY","qcdt2f7jo51muquo5r95dpo","0XJqmcdtcMZu66glBI5O8","lK8r8BXS4ThiUTe4xKIZe","93de42ca-53ea-460a-baa7-b9ec5c47cb1e","Rxs2jaGpdFzqYtP7lAJFJ","aO8W81Z0PyIb6Hs7nOHPW","lhzisalkebu4w5n01np07i0","7b5l4b6fi65n7sv9org5q1l","I01hENHnh8Tqu3Ok8sLzG","03o3n0hz9v9jtb7j889zpd4","evqsPNutOaZ8hcBCqxFQu","zhhxcjZUHdU8uRLwGb9Zh","G1aFACZB2ooWGMGwyd3ZW","YWy1C4tgoaCcw1m8JJsr7","Szj3o5iaNxPpesiCqwrbu","613syb18hb3v0u1ydvor7ru","XhvCDW3fIw6h6MhY5ticq","Q70g7SusFZBQXzkuQifv4","AzfWDH3wp7jFpL2EYxBcW","y0fwpZ9qMqirsLiFyOciU","ZF8xj8wwDUqKlrwTrCFZ1","tAJvhqhdfyZZa87QHq1TU","4hRmipi8lxpBLyzWu5JVB","iTg0C7QjvnmqBZeEigJNs","3babc3d2-79ae-470a-9c06-ab8bba2e684e","bF3UsMFya3fMeXWDspVov","ULkfbL9WpktbVYnzhl6Jw","PpNOO8JYWe6dM8wruSa7x","di40pCxDn7IiqE8lFdD46","rmW0mkerqV35I8QPji6lM","3IFIK1ByzeIxZCByryGLN","iImkYAKfkw3beAl6pLbDn","ecDe8DNWrkeQTwpTEvHje","i2it5id8qwtg27n4usg8bo1","Yqhdd9mSJGN7OJOeyoSD2","Ws5tah8tpeyn9tK8VBTg8","gWAg15uBJgkS2B0wcpMAa","l7V3v2ep1YdDCt7DOr7Ci","yM2PJBdqJnHpD63cPA6sW","qn0bre7eLbi3QMbCfWkUi","fSu0KxFL41IRouotqmbHs","0gtg24Mj1a1bQFPRGQNlO","7iQPBMltLPLbFEz2qbjPu","yoh4pwoXcfELInGKRdYf6","dCGCWXgAmiOZXbdULT1m6","jMavlje07sNa6hSEIE8WA","Xxm0JE4dKHxrQAaZfzvxD","nRb6Im4Kcmc2ZWE7K1jZ1","PAEBZCyFBZJyR7OoMZ41E","PQ6km8RgRCuyICBPOYz8f","x5tm1nfjzyawwzedy3yitgd","2bhftt8rGuxYu4pFgNqru","hjYIZpHQWuXfeEoGeJEKW","K2M9bQqVq2eQfm29eslKL","X8obW1iKwYsvNgKWGyCzy","yJwSC7hqYIezTFHf5i0Ev","c4Z7ETcOHUILRMH32Sfjw","qiR6dIu857b9M9kTqjOyK","fc2coz74cnfy5czzofx4h5x","Ku1OgHMhELajzo61Gx7ye","LUrfhDWo8wuwZu7CN9TV8","osu6JGOnvXJ5gt3tpqWZY","1a6173cd-cf13-4b34-a522-8350bf9a364f","S2sBltrPfd8a7ICuD7CuH","GLQ2pmkJUNUa93THBDVsD","md6xitz4exia2joa06i490b","oWCuBXOg6JWfZzjmKxmNl","jOmhZ8ovLYTPbpM1vqSDx","p9bov84s0isgkl1ysaw93kk","FraC6xzLy1ei91l1ICyc9","6ceBas2RE9Q4787GDngH7","734cd78d-0bc9-426b-803d-1efc84dfffe5","k4Bb09px6r0FxIRs49SXV","oaG3H1S9IUBO644nGZigu","Ka7agQJkUMRSWN0uFdkWK","si3z090WsiLasMhJBa1Az","hs6rwzt4mogiicoc4gcykbi","ljKAVERmdEiKLK9hXGKBm","zxt3lhonfdhglvijd17ua8c","dd7dopve1dudqkoibkqvti4","923tgifqf59ovv5yldtyi0a","vrjwp01goqw47fqctm4f4lo","c99gdmmppju3r1tth8cb2jx","z2pvn5qxdz84zgygqzxage8"],"parent":null,"data":{},"body":"This Dendron vault of tech knowledge is organized according to domains and their sub-domains, along with specific implementation of those domains.\n\nFor instance, Git itself is a domain. Sub-domains of Git would include things like `commit`,\n`tags`, `reflog` etc. implementations of each of those could be `cli`, `strat`\n(strategies), `inner`, and so on.\n\nThe goal of the wiki is to present data in a manner that is from the perspective\nof a querying user. Here, a user is a programmer wanting to get key information\nfrom a specific domain. For instance, if a user wants to use postgres functions\nand hasn't done them in a while, they should be able to query\n`postgres.functions` to see what information is available to them.\n\nThis wiki has been written with myself in mind. While learning each of these\ndomains, I have been sensitive to the \"aha\" moments and have noted down my\ninsights as they arose. I have refrained from capturing information that I\nconsidered obvious or otherwise non-beneficial to my own understanding.\n\nAs a result, I have allowed myself to use potentially arcane concepts to explain other ones. For example, in my note on [[unit testing|testing.method.unit]], I have made reference to the [[microservices|general.arch.microservice]] note. If these notes were made with the public in mind, this would be a very bad strategy, given that you'd have to understand microservices to be able to draw that same parallel that I've already drawn. Since these notes are written for myself, I have been fine with taking these liberties.\n\nWhat I hope to gain from this wiki is the ability to step away from any\ngiven domain for a long period of time, and be able to be passably useful for\nwhatever my goals are within a short period of time. Of course this is all\nvague sounding, and really depends on the domain along with the ends I am\ntrying to reach.\n\nTo achieve this, the system should be steadfast to:\n- be able to put information in relatively easily, without too much thought\n\trequired to its location. While location is important, Dendron makes it easy\n\tto relocate notes, if it becomes apparent that a different place makes more\n\tsense.\n- be able to extract the information that is needed, meaning there is a\n\thigh-degree in confidence in the location of the information. The idea is\n\tthat information loses a large amount of its value when it is unfindable.\n\tTherefore, a relatively strict ideology should be used when determining\n\twhere a piece of information belongs.\n\t- Some concepts might realistically belong to multiple domains. For instance, the concept of *access modifiers* can be found in both `C#` and `Typescript`. Therefore, this note should be abstracted to a common place, such as [[OOP|paradigm.oop]].\n\nThis Dendron vault is the sister component to the [General Second Brain](https://tech.kyletycholiz.com).\n\n### Tags\nThroughout the garden, I have made use of tags, which give semantic meaning to the pieces of information.\n\n- `ex.` - Denotes an *example* of the preceding piece of information\n- `spec:` - Specifies that the preceding information has some degree of *speculation* to it, and may not be 100% factual. Ideally this gets clarified over time as my understanding develops.\n- `anal:` - Denotes an *analogy* of the preceding information. Often I will attempt to link concepts to others that I have previously learned.\n- `mn:` - Denotes a *mnemonic*\n- `expl:` - Denotes an *explanation*\n\n## Resources\n### UE (Unexamined) Resources\nOften, I come across sources of information that I believe to be high-quality. They may be recommendations or found in some other way. No matter their origin, I may be in a position where I don't have the time to fully examine them (and properly extract notes), or I may not require the information at that moment in time. In cases like these, I will add reference to a section of the note called **UE Resources**. The idea is that in the future when I am ready to examine them, I have a list of resources that I can start with. This is an alternative strategy to compiling browser bookmarks, which I've found can quickly become untenable.\n\n### E (Examined) Resources\nOnce a resource has been thoroughly examined and has been mined for notes, it will be moved from *UE Resources* to *E Resources*. This is to indicate that (in my own estimation), there is nothing more to be gained from the resource that is not already in the note.\n\n### Resources\nThis heading is for inexhaustible resources. \n- A prime example would be a quality website that continually posts articles.  - Another example would be a tool, such as software that measures frequencies in a room to help acoustically treat it.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"dendronVersion":"0.83.0","vaults":[{"fsPath":"../main/tech","name":"tech"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"The Tech Digital Garden of Kyle Tycholiz"},"github":{"cname":"tech.kyletycholiz.com","enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"master","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","enableMermaid":true,"siteUrl":"https://tech.kyletycholiz.com","duplicateNoteBehavior":{"action":"useVault","payload":["tech"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"SBhnwv59C8Y0Gb9nRztZU"},"buildId":"fo6gubzKP_KV9RZPhaoiQ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>