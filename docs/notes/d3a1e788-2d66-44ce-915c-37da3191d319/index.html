<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Promises</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Publishable tech notes"/><meta property="og:title" content="Promises"/><meta property="og:description" content="Publishable tech notes"/><meta property="og:url" content="https://tycholiz.github.io/Digital-Garden/notes/d3a1e788-2d66-44ce-915c-37da3191d319/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2021-03-06"/><meta property="article:modified_time" content="2021-10-20"/><link rel="canonical" href="https://tycholiz.github.io/Digital-Garden/notes/d3a1e788-2d66-44ce-915c-37da3191d319/"/><meta name="next-head-count" content="13"/><link rel="preload" href="/Digital-Garden/_next/static/css/277fdfe9b7022c9c8577.css" as="style"/><link rel="stylesheet" href="/Digital-Garden/_next/static/css/277fdfe9b7022c9c8577.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/Digital-Garden/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/Digital-Garden/_next/static/chunks/webpack-fa90faaedcc655d54918.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/framework-2f612445bd50b211f15a.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/main-b0e1b6c55ab88555627b.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/pages/_app-0b093d889a037b39223d.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/155-6b9e7c2cacce4839738c.js" defer=""></script><script src="/Digital-Garden/_next/static/chunks/pages/notes/%5Bid%5D-df993d2e11a1c064ce76.js" defer=""></script><script src="/Digital-Garden/_next/static/0HNZl62AIYuHg90cvR3Tq/_buildManifest.js" defer=""></script><script src="/Digital-Garden/_next/static/0HNZl62AIYuHg90cvR3Tq/_ssgManifest.js" defer=""></script></head><body><div id="__next"><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div class="ant-col"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"></div><div style="margin-left:4px;display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout site-layout" style="margin-top:64px"><section class="ant-layout site-layout" style="flex-direction:row"><section class="ant-layout site-layout-sidebar" style="flex:0 0 auto;width:calc((100% - 992px) / 2 + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></section><section class="ant-layout side-layout-main" style="max-width:960px;display:initial"><main class="ant-layout-content main-content" role="main" style="padding:0 24px"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-20"><div><h1 id="promises"><a aria-hidden="true" class="anchor-heading" href="#promises"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Promises</h1>
<h1 id="overview"><a aria-hidden="true" class="anchor-heading" href="#overview"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Overview</h1>
<p>A promise accepts a callback function as a parameter. The callback function accepts 2 parameters, resolve and reject. If the task is successfully performed, then it returns resolve. Else it returns the reject.</p>
<p>An asynchronous function returns a promise immediately, so the client isnâ€™t blocked. </p>
<p>With the callback method of achieving asynchrony, the idea is to pass a callback into a function and call that function after some event has occurred.
Promises work a bit differently. Essentially, we create this object called a Promise (which if we recall, returns immediately when invoked, albeit with <code>[Pending]</code> status). To this object, we attach 2 callback functions: <code>resolve</code> and <code>reject</code>.</p>
<ul>
<li>we call <code>resolve</code> if the async action succeeds</li>
<li>we call <code>reject</code> if the async action fails
<ul>
<li>most commonly the <code>resolve</code> and <code>reject</code> callbacks are asynchronous functions that return a promise. Naturally, they get called upon completion/failure of the async operation (or in the case of a promise chain, they get called when the previous promise resolves.)</li>
</ul>
</li>
</ul>
<p>Promises make some guarantees about their use:</p>
<ul>
<li>Callbacks added with <code>then()</code> will never be invoked before the completion of the current run of the event loop. These callbacks will be invoked even if they were added after the success or failure of the asynchronous operation (e.g. fetch for data) that the promise represents.  Multiple callbacks may be added by calling <code>then()</code> several times. They will be invoked one after another in a synchronous way.</li>
</ul>
<p>using promises effectively abstracts time out of the picture.</p>
<ul>
<li>abstracting away time allows us to better handle race conditions</li>
</ul>
<h1 id="breakdown"><a aria-hidden="true" class="anchor-heading" href="#breakdown"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Breakdown</h1>
<p>There are 2 sides to promises: the <code>executor</code> (the one doing the actions) and the <code>consumer</code> (the one waiting for the actions to be done so it can consume the result.
Executor ex. <code>(resolve, reject) =></code>
Consumer ex. <code>.then, .catch, .finally</code></p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Executor</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'Success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// or</span>
  <span class="token comment">// reject(new Error("Error!"));</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Consumer</span>
p1<span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Success!</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">reason</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error!</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="executor"><a aria-hidden="true" class="anchor-heading" href="#executor"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Executor</h2>
<p>Executor is usually defined as part of a library, so it's not often that we write this code
A executor sends the data with <code>resolve(stuff)</code></p>
<p>Executor gets run as soon as it's defined. Therefore, its state will either be resolved or rejected</p>
<p><code>Promise.resolve()</code> and <code>Promise.reject()</code> are shortcuts to manually create an already resolved or rejected promise respectively. This can be useful at times.</p>
<h2 id="consumer"><a aria-hidden="true" class="anchor-heading" href="#consumer"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Consumer</h2>
<p>Think of <code>.then</code>, <code>.catch</code> and <code>.finally</code> as the way that consumers subscribe to the executor
A consumer receives the data (<code>stuff</code>) sent via the executor (ie. <code>resolve(stuff)</code>) with <code>.then(stuff)</code></p>
<pre class="language-js"><code class="language-js"><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token arrow operator">=></span> <span class="token function">doSomethingElse</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">newResult</span> <span class="token arrow operator">=></span> <span class="token function">doThirdThing</span><span class="token punctuation">(</span>newResult<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">finalResult</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Got the final result: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>finalResult<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="then"><a aria-hidden="true" class="anchor-heading" href="#then"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a><code>.then()</code></h4>
<p><code>.then</code> lets us chain (ie. compose) 2+ asynchronous operations.</p>
<p>Signature:</p>
<ul>
<li>note: most often the onRejected is omitted, with responsibility delegated to a final <code>.catch</code></li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">then</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">onFulfilled<span class="token punctuation">,</span> onRejected</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token known-class-name class-name">Promise</span>
</code></pre>
<p>To avoid surprises, functions passed to <code>then()</code> will never be called synchronously, even with an already-resolved promise:</p>
<ul>
<li>Instead of running immediately, the passed-in function is put on a microtask queue, which means it runs later (only after the function which created it exits, and when the JavaScript execution stack is empty), just before control is returned to the event loop</li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1, 2</span>
</code></pre>
<p><code>.then()</code> is a method available on a Promise. It doesn't even matter if the Promise is <code>pending</code>, <code>fulfilled</code>, or <code>rejected</code>.</p>
<ul>
<li>if we call <code>.then</code> on an already resolved/rejected promise, the <code>.then</code> block will be triggered instantly; however, the handler functions will be triggered asynchronously. To illustrate:</li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> resolvedProm <span class="token operator">=</span> <span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> thenProm <span class="token operator">=</span> resolvedProm<span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"this gets called after the end of the main stack. the value received and returned is: "</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// instantly logging the value of thenProm</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>thenProm<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// using setTimeout we can postpone the execution of a function to the moment the stack is empty</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>thenProm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// logs, in order:</span>
<span class="token comment">// Promise {[[PromiseStatus]]: "pending", [[PromiseValue]]: undefined}</span>
<span class="token comment">// "this gets called after the end of the main stack. the value received and returned is: 33"</span>
<span class="token comment">// Promise {[[PromiseStatus]]: "resolved", [[PromiseValue]]: 33}</span>
</code></pre>
<h5 id="handler-functions-onfulfilledonrejected"><a aria-hidden="true" class="anchor-heading" href="#handler-functions-onfulfilledonrejected"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Handler functions (<code>onFulfilled</code>/<code>onRejected</code>)</h5>
<p>if the promise is resolved (ie. when the underlying async operation is completed), <code>onFulfilled</code> is called asynchronously (to be scheduled in the current thread loop).</p>
<p>Signature:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">onFulfilled</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fulfillmentValue</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> valueOfResolveFunction
</code></pre>
<p>Handler functions have some behaviours. If it...</p>
<ul>
<li>returns a value, the promise returned by then gets resolved with the returned value as its value.</li>
<li>doesn't return anything, the promise returned by then gets resolved with an undefined value.</li>
<li>throws an error, the promise returned by then gets rejected with the thrown error as its value.</li>
<li>returns an already fulfilled promise, the promise returned by then gets fulfilled with that promise's value as its value.</li>
<li>returns an already rejected promise, the promise returned by then gets rejected with that promise's value as its value.</li>
<li>returns another pending promise object, the resolution/rejection of the promise returned by then will be subsequent to the resolution/rejection of the promise returned by the handler. Also, the resolved value of the promise returned by then will be the same as the resolved value of the promise returned by the handler.</li>
</ul>
<p>Think of async actions atomically, and make each step a <code>.then()</code> that returns the input for the next <code>.then()</code>
Ex. First .then() returns the JSON data as an obj, second returns a subset of that data, third acts on it</p>
<p><code>.then</code> is analogous to adding another subscriber to the mailing list</p>
<h4 id="rejecting-promises"><a aria-hidden="true" class="anchor-heading" href="#rejecting-promises"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Rejecting Promises</h4>
<p><code>.catch(onRejected)</code> is short for <code>.then(null, onRejected)</code></p>
<ul>
<li>If there's an exception, the browser will look down the chain for <code>.catch()</code> handlers or <code>onRejected</code>.</li>
</ul>
<p>Whenever a promise is rejected, a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/rejectionhandled_event">rejectionhandled event</a> is sent to the global scope (probably <code>window</code>).</p>
<p>Just like <code>.then</code>, <code>.catch</code> returns a promise, meaning we can chain another <code>.then</code> onto <code>.catch</code> if we want to </p>
<ul>
<li>this is effectively saying "do this thing, even if some previous async operation failed"</li>
</ul>
<p>spec:when we wrap a function in <code>Promise(..)</code>, we are promisifying it</p>
<ul>
<li>The new function that returns this promisified function now returns a Promise that resolves to its original return value</li>
</ul>
<p>(Inside promises) if a promise is returned (eg. return Promise.resolve('stuff')), the next .then() will execute only when that promise has resolved (with 'stuff').
If the return value is anything else besides a promise, then it will be passed immediately to the next .then()</p>
<p>.resolve(value)
If the value passed to it is a promise itself, this will automatically "follow" that promise chain and wait to pass back the final resolved value.</p>
<ul>
<li>Good to use if you are unsure if a value is a promise or not</li>
</ul>
<p><code>Promise.all</code> is a server at a restaurant waiting to bring everyone's food at the same time, even though one meal may be ready before the others</p>
<hr>
<h2 id="wrapping-callbacks-in-promises"><a aria-hidden="true" class="anchor-heading" href="#wrapping-callbacks-in-promises"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Wrapping Callbacks in Promises</h2>
<p>In an ideal world, all asynchronous functions would already return promises. Unfortunately, some APIs still expect success and/or failure callbacks, like <code>setTimeout()</code>.</p>
<p>Luckily we can wrap <code>setTimeout</code> in a promise. </p>
<ul>
<li>Best practice is to wrap problematic functions at the lowest possible level, and then never call them directly again:</li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token comment">// Basically, the promise constructor takes an executor function that lets us resolve or reject a promise manually. </span>
<span class="token comment">// Since setTimeout() doesn't really fail, we left out reject in this case.</span>
<span class="token keyword">const</span> <span class="token function-variable function">wait</span> <span class="token operator">=</span> <span class="token parameter">ms</span> <span class="token arrow operator">=></span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token arrow operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> ms<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">saySomething</span><span class="token punctuation">(</span><span class="token string">"10 seconds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword control-flow">catch</span><span class="token punctuation">(</span>failureCallback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="promises-are-only-ever-resolved-once-per-creation"><a aria-hidden="true" class="anchor-heading" href="#promises-are-only-ever-resolved-once-per-creation"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Promises are only ever resolved once per creation</h2>
<ul>
<li>In the following code it seems that we would connect to the database 2 times, but Promises don't work like that.</li>
<li>since <code>databasePromise</code> is only defined one time, it can by definition only resolve one time.</li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> databasePromise <span class="token operator">=</span> <span class="token function">connectDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> booksPromise <span class="token operator">=</span> databasePromise
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span>findAllBooks<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> userPromise <span class="token operator">=</span> databasePromise
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span>getCurrentUser<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  booksPromise<span class="token punctuation">,</span>
  userPromise
<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">values</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> books <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token function">pickTopRecommentations</span><span class="token punctuation">(</span>books<span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="sleep-example"><a aria-hidden="true" class="anchor-heading" href="#sleep-example"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Sleep example</h2>
<ul>
<li>We can use promises make a function who's purpose is to simply wait, before executing further code. We define it as such:</li>
</ul>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">sleep</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ms</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> ms<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>as soon as we call <code>sleep(1000)</code>, a promise is returned to us. This means that javascript will say "ok, since we're waiting on that promise to resolve (or reject), I'm going to go do some other stuff, and once your promise resolves, I'll be back to execute the <code>.then()</code> code". Once
<ul>
<li>This is precicely why promises are said to "handle asynchronous things synchronously". It is because promises help us manage 2 different lines of execution at a time</li>
</ul>
</li>
</ul>
<hr>
<h2 id="children"><a aria-hidden="true" class="anchor-heading" href="#children"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Children</h2>
<ol>
<li><a href="/Digital-Garden/notes/NYjf2qGKGS6CYG49CTGQm">Async Await</a></li>
</ol></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-4"><div><div class=""><div class="ant-anchor-wrapper" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#overview" title="Overview">Overview</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#breakdown" title="Breakdown">Breakdown</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#executor" title="Executor">Executor</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#consumer" title="Consumer">Consumer</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#" title=""></a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#handler-functions-" title="Handler functions (/)">Handler functions (/)</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#rejecting-promises" title="Rejecting Promises">Rejecting Promises</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#wrapping-callbacks-in-promises" title="Wrapping Callbacks in Promises">Wrapping Callbacks in Promises</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#promises-are-only-ever-resolved-once-per-creation" title="Promises are only ever resolved once per creation">Promises are only ever resolved once per creation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#sleep-example" title="Sleep example">Sleep example</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#children" title="Children">Children</a></div></div></div></div></div></div></div></div></div></main><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></section></section></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"d3a1e788-2d66-44ce-915c-37da3191d319","title":"Promises","vault":{"fsPath":"../main/tech","name":"tech"},"type":"note","desc":"","links":[],"anchors":{"overview":{"type":"header","text":"Overview","value":"overview","line":8,"column":0},"breakdown":{"type":"header","text":"Breakdown","value":"breakdown","line":25,"column":0},"executor":{"type":"header","text":"Executor","value":"executor","line":46,"column":0},"consumer":{"type":"header","text":"Consumer","value":"consumer","line":54,"column":0},"":{"type":"header","text":"","value":"","line":68,"column":0},"handler-functions-":{"type":"header","text":"Handler functions (/)","value":"handler-functions-","line":108,"column":0},"rejecting-promises":{"type":"header","text":"Rejecting Promises","value":"rejecting-promises","line":129,"column":0},"wrapping-callbacks-in-promises":{"type":"header","text":"Wrapping Callbacks in Promises","value":"wrapping-callbacks-in-promises","line":152,"column":0},"promises-are-only-ever-resolved-once-per-creation":{"type":"header","text":"Promises are only ever resolved once per creation","value":"promises-are-only-ever-resolved-once-per-creation","line":165,"column":0},"sleep-example":{"type":"header","text":"Sleep example","value":"sleep-example","line":188,"column":0}},"fname":"js.lang.promises","updated":1634758965325,"created":1615066645806,"parent":"4ac4398f-3812-4770-94c8-4877f5a98ca9","children":["NYjf2qGKGS6CYG49CTGQm"],"data":{},"contentHash":"e2cedab1e8962b0fb9f527faf3756864","custom":{}},"body":"\u003ch1 id=\"promises\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#promises\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003ePromises\u003c/h1\u003e\n\u003ch1 id=\"overview\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#overview\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eOverview\u003c/h1\u003e\n\u003cp\u003eA promise accepts a callback function as a parameter. The callback function accepts 2 parameters, resolve and reject. If the task is successfully performed, then it returns resolve. Else it returns the reject.\u003c/p\u003e\n\u003cp\u003eAn asynchronous function returns a promise immediately, so the client isnâ€™t blocked. \u003c/p\u003e\n\u003cp\u003eWith the callback method of achieving asynchrony, the idea is to pass a callback into a function and call that function after some event has occurred.\nPromises work a bit differently. Essentially, we create this object called a Promise (which if we recall, returns immediately when invoked, albeit with \u003ccode\u003e[Pending]\u003c/code\u003e status). To this object, we attach 2 callback functions: \u003ccode\u003eresolve\u003c/code\u003e and \u003ccode\u003ereject\u003c/code\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ewe call \u003ccode\u003eresolve\u003c/code\u003e if the async action succeeds\u003c/li\u003e\n\u003cli\u003ewe call \u003ccode\u003ereject\u003c/code\u003e if the async action fails\n\u003cul\u003e\n\u003cli\u003emost commonly the \u003ccode\u003eresolve\u003c/code\u003e and \u003ccode\u003ereject\u003c/code\u003e callbacks are asynchronous functions that return a promise. Naturally, they get called upon completion/failure of the async operation (or in the case of a promise chain, they get called when the previous promise resolves.)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePromises make some guarantees about their use:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCallbacks added with \u003ccode\u003ethen()\u003c/code\u003e will never be invoked before the completion of the current run of the event loop. These callbacks will be invoked even if they were added after the success or failure of the asynchronous operation (e.g. fetch for data) that the promise represents.  Multiple callbacks may be added by calling \u003ccode\u003ethen()\u003c/code\u003e several times. They will be invoked one after another in a synchronous way.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eusing promises effectively abstracts time out of the picture.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eabstracting away time allows us to better handle race conditions\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"breakdown\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#breakdown\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eBreakdown\u003c/h1\u003e\n\u003cp\u003eThere are 2 sides to promises: the \u003ccode\u003eexecutor\u003c/code\u003e (the one doing the actions) and the \u003ccode\u003econsumer\u003c/code\u003e (the one waiting for the actions to be done so it can consume the result.\nExecutor ex. \u003ccode\u003e(resolve, reject) =\u003e\u003c/code\u003e\nConsumer ex. \u003ccode\u003e.then, .catch, .finally\u003c/code\u003e\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// Executor\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e p1 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eresolve\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e reject\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003eresolve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Success!'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// or\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// reject(new Error(\"Error!\"));\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Consumer\u003c/span\u003e\np1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003evalue\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003evalue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Success!\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token parameter\"\u003ereason\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ereason\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// Error!\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"executor\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#executor\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eExecutor\u003c/h2\u003e\n\u003cp\u003eExecutor is usually defined as part of a library, so it's not often that we write this code\nA executor sends the data with \u003ccode\u003eresolve(stuff)\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eExecutor gets run as soon as it's defined. Therefore, its state will either be resolved or rejected\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ePromise.resolve()\u003c/code\u003e and \u003ccode\u003ePromise.reject()\u003c/code\u003e are shortcuts to manually create an already resolved or rejected promise respectively. This can be useful at times.\u003c/p\u003e\n\u003ch2 id=\"consumer\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#consumer\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eConsumer\u003c/h2\u003e\n\u003cp\u003eThink of \u003ccode\u003e.then\u003c/code\u003e, \u003ccode\u003e.catch\u003c/code\u003e and \u003ccode\u003e.finally\u003c/code\u003e as the way that consumers subscribe to the executor\nA consumer receives the data (\u003ccode\u003estuff\u003c/code\u003e) sent via the executor (ie. \u003ccode\u003eresolve(stuff)\u003c/code\u003e) with \u003ccode\u003e.then(stuff)\u003c/code\u003e\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token function\"\u003edoSomething\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eresult\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003edoSomethingElse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003enewResult\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003edoThirdThing\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003enewResult\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003efinalResult\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eGot the final result: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003efinalResult\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eonRejected\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"then\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#then\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003e\u003ccode\u003e.then()\u003c/code\u003e\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003e.then\u003c/code\u003e lets us chain (ie. compose) 2+ asynchronous operations.\u003c/p\u003e\n\u003cp\u003eSignature:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003enote: most often the onRejected is omitted, with responsibility delegated to a final \u003ccode\u003e.catch\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003ethen\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eonFulfilled\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e onRejected\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo avoid surprises, functions passed to \u003ccode\u003ethen()\u003c/code\u003e will never be called synchronously, even with an already-resolved promise:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eInstead of running immediately, the passed-in function is put on a microtask queue, which means it runs later (only after the function which created it exits, and when the JavaScript execution stack is empty), just before control is returned to the event loop\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eresolve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 1, 2\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e.then()\u003c/code\u003e is a method available on a Promise. It doesn't even matter if the Promise is \u003ccode\u003epending\u003c/code\u003e, \u003ccode\u003efulfilled\u003c/code\u003e, or \u003ccode\u003erejected\u003c/code\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eif we call \u003ccode\u003e.then\u003c/code\u003e on an already resolved/rejected promise, the \u003ccode\u003e.then\u003c/code\u003e block will be triggered instantly; however, the handler functions will be triggered asynchronously. To illustrate:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e resolvedProm \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eresolve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e33\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e thenProm \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e resolvedProm\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003evalue\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"this gets called after the end of the main stack. the value received and returned is: \"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e value\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e value\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// instantly logging the value of thenProm\u003c/span\u003e\n\u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ethenProm\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// using setTimeout we can postpone the execution of a function to the moment the stack is empty\u003c/span\u003e\n\u003cspan class=\"token function\"\u003esetTimeout\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ethenProm\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// logs, in order:\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Promise {[[PromiseStatus]]: \"pending\", [[PromiseValue]]: undefined}\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// \"this gets called after the end of the main stack. the value received and returned is: 33\"\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Promise {[[PromiseStatus]]: \"resolved\", [[PromiseValue]]: 33}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch5 id=\"handler-functions-onfulfilledonrejected\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#handler-functions-onfulfilledonrejected\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eHandler functions (\u003ccode\u003eonFulfilled\u003c/code\u003e/\u003ccode\u003eonRejected\u003c/code\u003e)\u003c/h5\u003e\n\u003cp\u003eif the promise is resolved (ie. when the underlying async operation is completed), \u003ccode\u003eonFulfilled\u003c/code\u003e is called asynchronously (to be scheduled in the current thread loop).\u003c/p\u003e\n\u003cp\u003eSignature:\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003eonFulfilled\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003efulfillmentValue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e valueOfResolveFunction\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHandler functions have some behaviours. If it...\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ereturns a value, the promise returned by then gets resolved with the returned value as its value.\u003c/li\u003e\n\u003cli\u003edoesn't return anything, the promise returned by then gets resolved with an undefined value.\u003c/li\u003e\n\u003cli\u003ethrows an error, the promise returned by then gets rejected with the thrown error as its value.\u003c/li\u003e\n\u003cli\u003ereturns an already fulfilled promise, the promise returned by then gets fulfilled with that promise's value as its value.\u003c/li\u003e\n\u003cli\u003ereturns an already rejected promise, the promise returned by then gets rejected with that promise's value as its value.\u003c/li\u003e\n\u003cli\u003ereturns another pending promise object, the resolution/rejection of the promise returned by then will be subsequent to the resolution/rejection of the promise returned by the handler. Also, the resolved value of the promise returned by then will be the same as the resolved value of the promise returned by the handler.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThink of async actions atomically, and make each step a \u003ccode\u003e.then()\u003c/code\u003e that returns the input for the next \u003ccode\u003e.then()\u003c/code\u003e\nEx. First .then() returns the JSON data as an obj, second returns a subset of that data, third acts on it\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e.then\u003c/code\u003e is analogous to adding another subscriber to the mailing list\u003c/p\u003e\n\u003ch4 id=\"rejecting-promises\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#rejecting-promises\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eRejecting Promises\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003e.catch(onRejected)\u003c/code\u003e is short for \u003ccode\u003e.then(null, onRejected)\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf there's an exception, the browser will look down the chain for \u003ccode\u003e.catch()\u003c/code\u003e handlers or \u003ccode\u003eonRejected\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhenever a promise is rejected, a \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/rejectionhandled_event\"\u003erejectionhandled event\u003c/a\u003e is sent to the global scope (probably \u003ccode\u003ewindow\u003c/code\u003e).\u003c/p\u003e\n\u003cp\u003eJust like \u003ccode\u003e.then\u003c/code\u003e, \u003ccode\u003e.catch\u003c/code\u003e returns a promise, meaning we can chain another \u003ccode\u003e.then\u003c/code\u003e onto \u003ccode\u003e.catch\u003c/code\u003e if we want to \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethis is effectively saying \"do this thing, even if some previous async operation failed\"\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003espec:when we wrap a function in \u003ccode\u003ePromise(..)\u003c/code\u003e, we are promisifying it\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe new function that returns this promisified function now returns a Promise that resolves to its original return value\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e(Inside promises) if a promise is returned (eg. return Promise.resolve('stuff')), the next .then() will execute only when that promise has resolved (with 'stuff').\nIf the return value is anything else besides a promise, then it will be passed immediately to the next .then()\u003c/p\u003e\n\u003cp\u003e.resolve(value)\nIf the value passed to it is a promise itself, this will automatically \"follow\" that promise chain and wait to pass back the final resolved value.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGood to use if you are unsure if a value is a promise or not\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003ePromise.all\u003c/code\u003e is a server at a restaurant waiting to bring everyone's food at the same time, even though one meal may be ready before the others\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"wrapping-callbacks-in-promises\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#wrapping-callbacks-in-promises\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eWrapping Callbacks in Promises\u003c/h2\u003e\n\u003cp\u003eIn an ideal world, all asynchronous functions would already return promises. Unfortunately, some APIs still expect success and/or failure callbacks, like \u003ccode\u003esetTimeout()\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eLuckily we can wrap \u003ccode\u003esetTimeout\u003c/code\u003e in a promise. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eBest practice is to wrap problematic functions at the lowest possible level, and then never call them directly again:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token comment\"\u003e// Basically, the promise constructor takes an executor function that lets us resolve or reject a promise manually. \u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// Since setTimeout() doesn't really fail, we left out reject in this case.\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003ewait\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token parameter\"\u003ems\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eresolve\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003esetTimeout\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresolve\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ms\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token function\"\u003ewait\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token number\"\u003e1000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003esaySomething\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"10 seconds\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efailureCallback\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"promises-are-only-ever-resolved-once-per-creation\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#promises-are-only-ever-resolved-once-per-creation\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003ePromises are only ever resolved once per creation\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eIn the following code it seems that we would connect to the database 2 times, but Promises don't work like that.\u003c/li\u003e\n\u003cli\u003esince \u003ccode\u003edatabasePromise\u003c/code\u003e is only defined one time, it can by definition only resolve one time.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e databasePromise \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003econnectDatabase\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e booksPromise \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e databasePromise\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003efindAllBooks\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e userPromise \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e databasePromise\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egetCurrentUser\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eall\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n  booksPromise\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  userPromise\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ethen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003evalues\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e books \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e values\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e user \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e values\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token function\"\u003epickTopRecommentations\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebooks\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e user\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"sleep-example\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#sleep-example\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eSleep example\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWe can use promises make a function who's purpose is to simply wait, before executing further code. We define it as such:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token function-variable function\"\u003esleep\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ems\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eresolve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token function\"\u003esetTimeout\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresolve\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ms\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eas soon as we call \u003ccode\u003esleep(1000)\u003c/code\u003e, a promise is returned to us. This means that javascript will say \"ok, since we're waiting on that promise to resolve (or reject), I'm going to go do some other stuff, and once your promise resolves, I'll be back to execute the \u003ccode\u003e.then()\u003c/code\u003e code\". Once\n\u003cul\u003e\n\u003cli\u003eThis is precicely why promises are said to \"handle asynchronous things synchronously\". It is because promises help us manage 2 different lines of execution at a time\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"children\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading\" href=\"#children\"\u003e\u003csvg aria-hidden=\"true\" viewBox=\"0 0 16 16\"\u003e\u003cuse xlink:href=\"#svg-link\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/a\u003eChildren\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"/Digital-Garden/notes/NYjf2qGKGS6CYG49CTGQm\"\u003eAsync Await\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e","noteIndex":{"id":"0e1ca097-be9f-4e4c-a7ed-d6dfb05cd4e8","title":"Root","vault":{"fsPath":"../main/tech","name":"tech"},"type":"note","desc":"","links":[],"anchors":{"digital-garden":{"type":"header","text":"Digital Garden","value":"digital-garden","line":8,"column":0}},"fname":"root","updated":1618676699718,"created":1615482407722,"parent":null,"children":["723b0cf7-a5f3-4c71-a811-2c782faa4cc4","mcq7ZV8MBAMVYrXg","dMS8QtNyJCwovtfh6ERrp","ZaTr28eWk1DrXOEsc1YVb","WH8jEz5lviqlnG5f","a19c5ab0-fd8c-4bd0-9aed-da5abefabc45","4586ac41-3af7-4176-aaf0-440ad1773bc9","610b951b-7363-471f-acd5-210710b9d104","f29f31f3-7235-41ad-83a1-b64f3f466916","3445f14b-9f67-412d-9762-dc14ee7c90e4","c3304982-eb1c-45ec-8556-4599d2286b5c","facc2b01-755a-409f-99f6-57bef2d1501f","b965d9fa-c200-4a8d-9323-73b9c2565812","4d5aab64-f4a4-40a0-9155-f28aaf49d38a","a95e8592-84c0-4698-a0d9-07e8e130b322","234faa4d-432f-43f4-99fb-08ac4c01bf9b","105fd41a-910d-4b94-8686-98c3933931f2","f3bcc3d9-7232-41f4-aaaf-86a99b56dc65","ANfx9Z4a6ZA0uJuSHtbIJ","4668ac41-f2d5-40c0-9144-efb456d8663b","j8xePJ5wfKsznvM5DP5q6","dc79799f-a55d-48ab-a8be-c48adb1b19c0","f6feef57-b8f5-451f-a09a-7b63f6a07183","12797f4e-92d0-447e-adc7-e5cb4ff4c883","5a9fb1df-478e-4687-9be0-5cb97e61ec57","1374e9e9-1cbc-4e1f-b1ca-66b8569533dd","f529cc34-aba0-45ca-ad7e-02ddda318941","0zcauha3il2NqtxZazIo7","9bbd6f68-03b2-41f4-92e4-2ca313e8b450","5a2ab598-fa7e-4471-8bda-9f5831b679ae","3b7ffbbf-762e-411f-8fad-5e2b1b95e384","81e5a201-c843-49d1-b291-f99d818cee0c","295ca45b-6851-4d38-9ecb-1d7e4a885849","vdjkh6890a6Ye6vvbN0CD","b3b7587a-fbd2-48a9-aef1-4efc90458e82","znCO2WghOAWC8nBGb4Ooa","7cc5d9c3-20d8-4fef-aca2-7d6dcdc7b3d7","f32fab12-3c92-4e91-8d61-01e17e734910","fqVQpS9FBiXgKsZX3R3sJ","53b47d5a-542b-4fab-8f6c-c70574ab7a48","963c4b54-02bd-4943-a15f-52cf59ffd0f4","739907b4-b36d-4ad1-866d-c9f8050de776","e65188a1-177e-4ab2-99f9-75f85d537621","fajYnbVhCRDi74xn0H30R","bArGdGwqo3iFkyKMyE7qR","ffYYlFAOinMkMeUg","5d700782-fb81-416e-83f9-5dd88260e350","w3MsVswhiuHRpAOQ","s2PhLzio3pcBg3bQ","d8118e61-b25f-4a6f-8f88-4e7ddd69827f","e1c5eaef-0205-4e6d-ab9f-5a207d58cc12","55a2161d-d415-4fbd-98cb-ff8aed19e6ee","67265fd9-7fbd-4bf7-b3c9-ced802b8a830","dvxpt2xKPsfCOTR4lY8Qp","a68b9a8c-a9c9-4133-8230-2671b2d8d86b","3bb25f58-2b50-4fa3-af55-48ea9f88a081","egctyVUjVesp2xA5t0ZYt","76420b75-f886-43ad-a876-c4fd4ad09ff2","1310c9cf-0160-4ad5-aad7-cf355c9313ac","6c54da8e-be6f-4ce3-b642-ef3108533df9","77ebb3d5-30b3-44e0-badc-02314bfd4f12","0e4f1336-2037-42e7-a854-054718e9359f","6412cc53-4648-46c1-8be6-c6d1c301baa1","c56bb2bc-4c2b-4bce-87e7-f1e655aa449a","UFrwsXzC1yr7Ge8FF8Vbo","a8edc4ac-028b-40ec-872a-e4a005b04b2a","38d933b3-770f-49df-b1ac-f2ae4f6061fd","vqPq_S-Il3EV72fUR41r6","93de42ca-53ea-460a-baa7-b9ec5c47cb1e","3bcd5b24-cdfa-45ad-b249-55ae92119ed3","aO8W81Z0PyIb6Hs7nOHPW","27f2c279-9420-4375-9487-5493c1dbbefc","Xt8o0SFdV1BIvmCKb1Ign","05537701-5721-425c-a0d5-8ec5da941220","1b6e8550-252e-4f9f-a586-05044cb97f0a","4866aa20-2068-47f0-afd1-c2b96a24f951","PXd6hUzi0wF7oPnT","f7c590dc-921d-4b6f-8f8e-e075b0c16035","f4355062-fdda-4c6f-a969-3f8a10c15475","c299d2dd-7cbd-4b81-976a-37b808ee41a8","9c56d34a-84ee-481e-ac5a-13fa56750a3c","60f0e948-b809-40de-aac1-180423cbebcd","dfab2e99-6155-482d-a598-8b8cc11f7ddc","e6ff7608-3de4-46e3-93a7-24ba07f70f42","bb4b4e79-9835-4284-bcac-d3de9b203e1a","3babc3d2-79ae-470a-9c06-ab8bba2e684e","4eeb4df6-2842-4db4-84ce-1992975f36a5","dff06309-f792-4ee2-a0ef-529972167027","d1aaf074-9c4c-4926-9106-44b71fd92529","20206ec8-0739-464e-b41d-65307a0c5aa6","3IFIK1ByzeIxZCByryGLN","0ba5c14a-800b-4614-ad5b-0ae7102e269e","db9cdb23-f02b-426c-b27e-baafb72916bd","7a81c659-7511-48c0-a78f-552d0e6cfff7","8e83deb1-8f7c-439e-b991-70e544645bfb","ubXzUle7zxv25VkjiLmpR","fb9dbfa7-978e-4f56-aeb7-3c97fb6c9e93","b6226bd4-551d-4670-a956-158bdce3f5a6","f691cb23-bc18-4b33-b454-155b1e785d62","a02e32ca-2839-46bc-a452-684f01a4e671","887233a2-8653-46ef-adce-2e482007942b","b6746509-f9f8-4823-b3b9-0d6d5f1fdb69","vlb4ItR9EQCCw9ACUA5h7","f39cc3a8-8357-49e5-8cdb-04450d05d913","1426c9b1-f3c1-4c01-8efd-a732c782c48c","dCGCWXgAmiOZXbdULT1m6","e02953c0-95d2-4101-a117-f8e0221800f0","GL8aMKtYOxcE560XF4HUK","9cc2f536-ad6d-49d2-bf6a-30284dfa1158","f9503aa6-bceb-4b11-89cd-d7e6f50d5cb0","e9bf14ec-5801-4be8-ba1e-3034dc742fa6","fee6c25b-8ea8-45bf-89d5-8c6d036b03b6","b28d278d-4fa0-4eac-9d26-dd6b10eb169d","yJwSC7hqYIezTFHf5i0Ev","5B2iI6ltu8TF5LJWAfXUE","4db45135-9630-4554-8ad4-6ca853621fca","MA3EsQQpV6iMx8j3hkJPK","84143a1b-aa79-40ff-bcae-6d9858fec127","osu6JGOnvXJ5gt3tpqWZY","1a6173cd-cf13-4b34-a522-8350bf9a364f","xRWsry32YkvSjs2Z","39SlH3nIiO6oQSwmZaMXT","TJrAQeEG6EjrEarYyIbYK","240d9848-b03d-445a-8787-090d79024b6a","5730411b-fefa-49e0-aced-451f5b148299","63a922b8-2d60-4ea7-9f47-bcfaa0caef7e","734cd78d-0bc9-426b-803d-1efc84dfffe5","3baf3651-9e5a-46bd-bba1-f0c0caf7385c","6733cf80-f2b1-41eb-8ddf-e2fa947f6b43","si3z090WsiLasMhJBa1Az","3577d6e8-1437-4f7b-9da2-c353ed232038"],"data":{},"contentHash":"b5a875cede0b3b4abe401df717960205","custom":{"nav_order":0,"permalink":"/"},"body":"\n# Digital Garden\n\nThis Wiki of Personal Information is organized according to domains and their\nsub-domains, along with specific implementation of those domains.\n\nFor instance, Git itself is a domain. Sub-domains of Git, would be `commit`,\n`tags`, `reflog` etc. implementations of each of those could be `cli`, `strat`\n(strategies), `inner` etc.\n\nThe goal of the wiki is to present data in a manner that is from the perspective\nof a querying user. Here, a user is a programmer wanting to get key information\nfrom a specific domain. For instance, if a user wants to use postgres functions\nand hasn't done them in a while, they should be able to query\n`postgres.functions` to see what information is available to them.\n\nThis wiki has been written with myself in mind. While learning each of these\ndomains, I have been sensitive to the aha moments and have noted down my\ninsights as they arose. I have refrained from capturing information that I\nconsidered obvious or otherwise non-beneficial to my own understanding.\n\nThe ability I hope to gain from this wiki is the ability to step away from any\ngiven domain for a long period of time, and be able to be passably useful for\nwhatever my goals are within a short period of time. Of course, this is all\nvague sounding, and really depends on the domain, along with the ends I am\ntrying to reach.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":3,"useFMTitle":true,"useNoteTitleForLink":true,"noLegacyNoteRef":true,"mermaid":true,"useKatex":true,"dev":{"enablePreviewV2":true},"site":{"assetsPrefix":"/Digital-Garden","siteUrl":"https://tycholiz.github.io","copyAssets":true,"siteHierarchies":["root"],"siteRootDir":"docs","usePrettyRefs":true,"title":"Dendron","description":"Publishable tech notes","duplicateNoteBehavior":{"action":"useVault","payload":["tech"]},"siteLastModified":true,"gh_edit_branch":"main","usePrettyLinks":true,"siteNotesDir":"notes","siteFaviconPath":"favicon.ico","gh_edit_link":true,"gh_edit_link_text":"Edit this page on GitHub","gh_root":"docs/","gh_edit_view_mode":"edit","writeStubs":true,"siteIndex":"root"},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{}},"workspace":{"dendronVersion":"0.67.1","vaults":[{"fsPath":"../main/tech","name":"tech"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"enableUserTags":true,"enableHashTags":true},"usePrettyRefs":true}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"d3a1e788-2d66-44ce-915c-37da3191d319"},"buildId":"0HNZl62AIYuHg90cvR3Tq","assetPrefix":"/Digital-Garden","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>