<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  
  <title>Lerna - Dendron</title>
  

  <link
    rel="shortcut icon"
    href="https://tycholiz.github.io/Digital-Garden/favicon.ico"
    type="image/x-icon"
  />
  <link
    rel="stylesheet"
    href="https://tycholiz.github.io/Digital-Garden/assets/css/just-the-docs-default.css"
  />
  <script
    type="text/javascript"
    src="https://tycholiz.github.io/Digital-Garden/assets/js/just-the-docs.js"
  ></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
    crossorigin="anonymous"
  />
  <script
    type="text/javascript"
    src="https://tycholiz.github.io/Digital-Garden/assets/js/vendor/lunr.min.js"
  ></script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   
  
<meta name="description" content="Personal knowledge space">
<meta name="author" content="">

<link rel="canonical" href="https://foo/notes/38d933b3-770f-49df-b1ac-f2ae4f6061fd.html">

<meta property="og:type" content="article">
<meta property="og:url" content="https://foo/notes/38d933b3-770f-49df-b1ac-f2ae4f6061fd.html">
<meta property="og:description" content="Personal knowledge space">
<meta property="og:image" content="https://fooundefined">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://foo/notes/38d933b3-770f-49df-b1ac-f2ae4f6061fd.html">
<meta name="twitter:description" content="Personal knowledge space">
<meta name="twitter:image" content="https://fooundefined">


  <meta property="og:title" content="Lerna - Dendron" />
  <meta name="twitter:title" content="Lerna - Dendron" />
  
</head>


<body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
      </symbol>
      <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
          <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
      <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
          <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
        </svg>
      </symbol>
    </svg>

    <div class="side-bar">
      <div class="site-header">
        <a href="https://tycholiz.github.io/Digital-Garden" class="site-title lh-tight">
  Dendron

 </a>
        <a href="#" id="menu-button" class="site-button">
          <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
        </a>
      </div>

      <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      </nav>
      <footer class="site-footer">
        ðŸŒ± with ðŸ’• using <a href="https://www.dendron.so/"> Dendron ðŸŒ² </a>
      </footer>
    </div>
    <div class="main" id="top">
        <div id="main-header" class="main-header">
          
            <div class="search">
              <div class="search-input-wrap">
                <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Dendron" aria-label="Search Dendron" autocomplete="off">
                <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
              </div>
              <div id="search-results" class="search-results"></div>
            </div>
          
          
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
          <nav aria-label="Breadcrumb" class="breadcrumb-nav">
            <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://tycholiz.github.io/Digital-Garden">Root</a></li><li class="breadcrumb-nav-list-item">Lerna</li></ol>
          </nav>
        
      
      <div id="main-content" class="main-content" role="main">

        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

        

        <script>
          $(function () {
            $('[data-toggle="popover"]').popover({html: true})
          })
        </script>

        

<div id="main" role="main">

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Lerna">
    
    <meta itemprop="datePublished" content="2021-03-06T15:32:03+00:00">
    <meta itemprop="dateModified" content="2021-03-06T15:32:08+00:00">

    <div class="page__inner-wrap">

      

      <section class="page__content" itemprop="text">

        

        <h1 id="lerna"><a aria-hidden="true" class="anchor-heading" href="#lerna"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Lerna</h1>
<p>Lerna allows us to have multiple packages within our project. Complete with each package, will be a package.json and a corresponding node_modules directory</p>
<p>We can list one of our packages as a dependency of another one by including the package in the <code>dependencies</code> section of the dependent's <code>package.json</code> </p>
<p>The root of a project with Lerna will have a <code>lerna.json</code>, as well as a <code>packages/</code> directory</p>
<ul>
<li>
<p>Each sub-package of our project must be within the <code>packages/</code> directory </p>
</li>
<li>
<p>To run <code>lerna bootstrap</code> is to install all dependencies in sub-modules</p>
</li>
<li>
<p>When we run <code>bootstrap</code>, lerna will call <code>yarn</code> in each module, then create symlinks between the packages that refer to each other in the dependent's <code>node_modules</code></p>
<ul>
<li>ex. If we have 3 modules: Addition, Subtraction, and Calc (which performs the add/subtract operations), then Calc's <code>node_modules</code> will contain symlinks to the Addition and Subtraction modules. </li>
</ul>
</li>
<li>
<p>if we use hoisting, then symlinks don't play a part. Instead, if we have <code>react</code> in 2 different submodules, then hoisting will allow us to remove <code>react</code> from those submodules, install it at the root level, then allow the node recursive resolver to handle resolution for us. In other words, from within the submodule, when we require <code>react</code>, it will look for the package in its nearest <code>node_modules</code>, not find it, then continue upwards until it does, which will be at the root.</p>
<ul>
<li>The reason why hoisting works is due to the resolve algorithm of node require</li>
</ul>
</li>
</ul>
<h3 id="duplication"><a aria-hidden="true" class="anchor-heading" href="#duplication"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Duplication</h3>
<ul>
<li>naturally, having multiple sub-packages in a project will result in duplicate package listings. Lerna offers hoisting, which allows us to effectively list the same package in multiple places, but have the packages install at the root level
<ul>
<li>therefore, the duplicated package (ex. React) will be in the root directory's <code>node_modules</code>, even though it is listed in the sub-package's <code>package.json</code> </li>
</ul>
</li>
<li>If we have a project with 2 sub-modules: A and B, and both have React as a dependency, we can run <code>lerna bootstrap --hoist</code> at the root, which will remove React (and all of its dependencies) from <code>A/node_modules</code> and <code>B/node_modules</code>, and move them to the root level <code>node_modules</code>. Because of the recursive nature of how <code>node_modules</code> are resolved, this will cause the sub-module's package.json to look upwards in the directory hierarchy until the react binary is found. 
<ul>
<li>Lerna will warn us when running this command if we have version mismatches</li>
</ul>
</li>
</ul>
<h3 id="commands"><a aria-hidden="true" class="anchor-heading" href="#commands"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Commands</h3>
<ul>
<li><code>bootstrap</code> - generate <code>node_modules</code> for packages.</li>
<li><code>clean</code> - remove all <code>node_modules</code> that are not in root directory</li>
<li><code>create</code> - add a new sub-package to your project</li>
<li><code>run</code> - run the script that is listed in each sub-<code>package.json</code>
<ul>
<li>Therefore, it will run only npm or yarn commands (with the script that is listed in package.json)</li>
</ul>
</li>
<li><code>exec</code> - run a command inside each package
<ul>
<li>similar to <code>run</code>, but is not restricted to running scripts in <code>package.json</code> </li>
</ul>
</li>
</ul>
<h3 id="misc"><a aria-hidden="true" class="anchor-heading" href="#misc"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Misc</h3>
<p>You don't actually need to run lerna bootstrap if you're using yarn workspaces.</p><span id="navId" data="38d933b3-770f-49df-b1ac-f2ae4f6061fd"></span>

                
      </section>

      
    </div>

    
  </article>

  
  
</div>


        
          <hr>
          <footer>
            
            

            
                
              </div>
          </footer>
        
    </div>
</div>


  

  <div class="search-overlay"></div>

</div>
</body>
</html>
