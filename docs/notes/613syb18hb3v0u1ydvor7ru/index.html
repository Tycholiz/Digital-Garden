<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>Nestjs</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="The Tech Digital Garden of Kyle Tycholiz"/><meta property="og:title" content="Nestjs"/><meta property="og:description" content="The Tech Digital Garden of Kyle Tycholiz"/><meta property="og:url" content="https://tech.kyletycholiz.com/notes/613syb18hb3v0u1ydvor7ru/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="3/25/2022"/><meta property="article:modified_time" content="1/25/2023"/><link rel="canonical" href="https://tech.kyletycholiz.com/notes/613syb18hb3v0u1ydvor7ru/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/8e7b7e4bce421c0a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8e7b7e4bce421c0a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-3d209faeb64f2f97.js" defer=""></script><script src="/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/_next/static/chunks/main-104451f3d1a5c4bc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6b338472289fe290.js" defer=""></script><script src="/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/_next/static/fo6gubzKP_KV9RZPhaoiQ/_buildManifest.js" defer=""></script><script src="/_next/static/fo6gubzKP_KV9RZPhaoiQ/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="nestjs">Nestjs<a aria-hidden="true" class="anchor-heading icon-link" href="#nestjs"></a></h1>
<p>Nestjs is a server-side application framework</p>
<ul>
<li>highly opinionated</li>
<li>supports multiple data paradigms, such as ClientServer, <a href="/notes/NpY4iv9TwpGJODbVesQYe">pub/sub</a> etc.</li>
<li>achieves SOLID principles by the use of <a href="/notes/y8044sa0ai1u2hyoka0lphz">modules</a>.</li>
<li>module dependency is achieved with <a href="/notes/OIBi54r4RJHlcy33iXLpD#nestjs-constructor-dependency-injection">constructor dependency injection</a>. 
<ul>
<li>Modules import <a href="/notes/38yyqdyxub4tyjdj0jl4ulg">providers</a> to perform some purpose (such as retrieve data from a database, send a message etc.), and those providers are made available within the module. To pass</li>
</ul>
</li>
<li>Nestjs provides an all-tools-supplied approach. 
<ul>
<li>ex. It has modules out of the box for connections to most types of databases/datastreams (e.g. RDBs, Redis, Kafka, RabbitMQ) and </li>
</ul>
</li>
</ul>
<h2 id="platform">Platform<a aria-hidden="true" class="anchor-heading icon-link" href="#platform"></a></h2>
<p>Nestjs is built on top of an HTTP Node framework</p>
<ul>
<li>default options are <a href="/notes/L5JUZlGAGvTxrsEBB7DY8">Express</a> and Fastify</li>
</ul>
<p>Depending on which underlying platform we use, we will get access to its API (<code>NestExpressApplication</code> or <code>NestFastifyApplication</code>)</p>
<ul>
<li>the resulting <code>app</code> object will have access to the methods of whichever underlying platform we choose.</li>
</ul>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">NestFactory</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">NestExpressApplication</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token maybe-class-name">AppModule</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>in Nest, almost everything is shared across incoming requests. </p>
<ul>
<li>ex. We have a connection pool to the database, singleton services with global state, etc.</li>
</ul>
<p>By default, modules are eagerly loaded (which means that as soon as the application loads, so do all the modules, whether or not they are immediately necessary).</p>
<ul>
<li>this is fine for the most part, but if we are running in a <a href="/notes/aOfHQ6odySXLBhQgkOtOp">serverless</a> environment, this would be problematic.
<ul>
<li>in this case we want to lazy load the modules.</li>
</ul>
</li>
</ul>
<p><img src="/assets/images/2022-05-16-13-27-38.png"></p>
<h3 id="lifecycle">Lifecycle<a aria-hidden="true" class="anchor-heading icon-link" href="#lifecycle"></a></h3>
<p>A Nest application, as well as every application element, has a lifecycle managed by Nest. </p>
<ul>
<li>Nest provides lifecycle hooks that give visibility into key lifecycle events, and the ability to run registered code in your <code>module</code>, <code>injectable</code> or <code>controller</code> when they occur.</li>
</ul>
<p>Lifecycle events can be broken into 3 phases: <em>initializing</em>, <em>running</em> and <em>terminating</em></p>
<h3 id="dependency-injection-and-decorators">Dependency Injection and Decorators<a aria-hidden="true" class="anchor-heading icon-link" href="#dependency-injection-and-decorators"></a></h3>
<p>Nest is built around the pattern of <a href="/notes/OIBi54r4RJHlcy33iXLpD">dependency injection</a>, which is achieved through <a href="/notes/j8xi6ftco6n2pbjqw6sbijg">decorators</a>.</p>
<ul>
<li>This is mostly done through the constructor (therefore, it's constructor-based dependency injection)</li>
</ul>
<p>The general pattern is that we create a <a href="/notes/38yyqdyxub4tyjdj0jl4ulg">provider</a> by decorating a class with <code>@Injectable</code>, then we pass that class into another c</p>
<ul>
<li>the <code>@Injectable</code> decorator enables the class to be registered and managed by the <a href="/notes/bXY3W37GW2ytFJOgbJiol">IoC</a> container (<code>@Modules</code>)</li>
</ul>
<p>When we inject a class into another class, Nest will instantiate the class and pass it to the controller's constructor.</p>
<p>Because of Typescript in Nestjs, it is very easy to manage dependencies, since they are resolved by type.</p>
<h3 id="context">Context<a aria-hidden="true" class="anchor-heading icon-link" href="#context"></a></h3>
<p>Guards, filters and interceptors are meant to be generic. That is, they don't care if they are being used in an HTTP context or WebSockets context.</p>
<ul>
<li>Nestjs provides utility classes that provide information about the current execution context.
<ul>
<li>this information can be used to build generic <a href="/notes/n9fg78mnpuk5u5xalihz2bp">guards</a>, filters, and <a href="/notes/saert7xobzak9v2h5jt72b3">interceptors</a> that can work across a broad set of <a href="/notes/nqv4bkm2rp1nljndftgqxdx">controllers</a>, methods, and execution contexts.</li>
</ul>
</li>
<li>Two of these utility classes are <code>ArgumentsHost</code> and <code>ExecutionContext</code>.</li>
</ul>
<h4 id="argumentshost"><code>ArgumentsHost</code><a aria-hidden="true" class="anchor-heading icon-link" href="#argumentshost"></a></h4>
<p><code>ArgumentsHost</code> is simply an abstraction over a handler's arguments.</p>
<ul>
<li>ex. for HTTP server applications, the <code>host</code> object encapsulates Express's <code>[request, response, next]</code> array</li>
<li>ex. for Graphql server applications, the <code>host</code> object contains the <code>[root, args, context, info]</code> array.</li>
</ul>
<p>This class provides methods for retrieving the arguments being passed to a handler. With it, we choose the appropriate context, and then we retrieve the arguments.</p>
<h5 id="methods">Methods<a aria-hidden="true" class="anchor-heading icon-link" href="#methods"></a></h5>
<ul>
<li><code>getType()</code> tells us which context is being used (<code>http</code>, <code>rpc</code> etc.)</li>
<li><code>getArgs()</code> gets us back an array of arguments being passed to the handler
<ul>
<li>this is generic, since we don't know what arguments we are getting back (since the context has not been specified). For this reason, using <code>switchTo...</code> methods might be preferable, since they return more specific types (such as <code>HttpArgumentsHost</code> or <code>RpcArgumentsHost</code>)</li>
</ul>
</li>
<li><code>switchToHttp()</code></li>
</ul>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> ctx <span class="token operator">=</span> host<span class="token punctuation">.</span><span class="token method function property-access">switchToHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getRequest</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token maybe-class-name">Request</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="executioncontext"><code>ExecutionContext</code><a aria-hidden="true" class="anchor-heading icon-link" href="#executioncontext"></a></h4>
<p><code>ExecutionContext</code> extends <code>ArgumentsHost</code>, and gives us additional details about the current execution process.</p>
<p>Nest provides an instance of <code>ExecutionContext</code> in places you may need it, such as in the <code>canActivate()</code> method of a guard and the <code>intercept()</code> method of an interceptor. </p>
<h5 id="methods-1">Methods<a aria-hidden="true" class="anchor-heading icon-link" href="#methods-1"></a></h5>
<ul>
<li><code>getClass()</code> Returns the type of the controller class which the current handler belongs to.</li>
<li><code>getHandler()</code> Returns a reference to the handler (method) that will be invoked next in the request pipeline.
<ul>
<li>ex. in an HTTP context, if the currently processed request is a POST request, bound to the <code>create()</code> method on the <code>CatsController</code>, <code>getHandler()</code> returns a reference to the <code>create()</code> method and <code>getClass()</code> returns the <code>CatsController</code> type (not instance).</li>
</ul>
</li>
</ul>
<p>The ability to access these references gives us the opportunity to access the metadata set through the <code>@SetMetadata()</code> decorator from within guards or interceptors.</p>
<h3 id="metadata-and-reflection">Metadata and Reflection<a aria-hidden="true" class="anchor-heading icon-link" href="#metadata-and-reflection"></a></h3>
<ul>
<li><a href="https://docs.nestjs.com/fundamentals/execution-context#reflection-and-metadata">docs</a></li>
</ul>
<p>We can attach custom metadata to route handlers with the <code>@SetMetadata()</code> decorator, which can then be accessed from within the class via dependency injection (with the <code>Reflector</code> helper class) to make certain decisions.</p>
<ul>
<li>ex. we can create some metadata about the roles that a user has.</li>
</ul>
<hr>
<h2 id="core-components">Core Components<a aria-hidden="true" class="anchor-heading icon-link" href="#core-components"></a></h2>
<h3 id="modules">Modules<a aria-hidden="true" class="anchor-heading icon-link" href="#modules"></a></h3>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Modules</span></div>
<a href="/notes/y8044sa0ai1u2hyoka0lphz" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><p>Modules are the way to organize your components in Nest.</p>
<ul>
<li>Decorating a class with <code>@Module</code> provides metadata that Nest makes use of to organize the application structure.</li>
</ul>
<p>Each application has at least one module, a root module. </p>
<ul>
<li>this is the starting point Nest uses to build the application graph, which is the internal data structure used to resolve module and provider relationships and dependencies.</li>
<li>this is the module that we register in our <code>main.ts</code> with <code>NestFactory.create(AppModule)</code></li>
</ul>
<p>For most applications, the resulting architecture will employ multiple modules, each encapsulating a closely related set of capabilities.</p>
<ul>
<li>good practice is to have each module correspond to a <a href="/notes/GDJoTJocO8OKbTtSjn2CW">domain</a></li>
</ul>
<p>The module encapsulates providers by default</p>
<ul>
<li>This means that in order to inject providers into a different module, they must be exported from the imported module.</li>
</ul>
<p>modules are singletons by default</p>
<ul>
<li>thus you can share the same instance of any provider between multiple modules effortlessly.</li>
<li>Every module is automatically a shared module: Once created it can be reused by any module
<ul>
<li>to do this, simply add the service to the <code>exports</code> array of the shared module. Now, any module that imports the shared module will have access to the service listed in that <code>exports</code> array.</li>
</ul>
</li>
</ul>
<p><img src="/assets/images/2023-01-23-12-12-32.png"></p>
<pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// correspond to the HttpService class that gets injected into the provider (service).</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token maybe-class-name">HttpModule</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token maybe-class-name">AutomationService</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  exports<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token maybe-class-name">AutomationService</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">AutomationModule</span></span> <span class="token punctuation">{</span>
  <span class="token comment">// Modules can inject providers (e.g. for configuration purposes):</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> automationService<span class="token operator">:</span> <span class="token maybe-class-name">AutomationService</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Modules themselves cannot be injected due to circular dependency.</p>
<h2 id="parts-of-a-module">Parts of a module<a aria-hidden="true" class="anchor-heading icon-link" href="#parts-of-a-module"></a></h2>
<p>The <code>@Module()</code> decorator takes a single object whose properties describe the module:</p>
<ul>
<li><code>providers</code> </li>
<li><code>controllers</code></li>
<li><code>imports</code></li>
<li><code>exports</code></li>
</ul>
<h3 id="providers"><code>providers</code><a aria-hidden="true" class="anchor-heading icon-link" href="#providers"></a></h3>
<p>The <code>providers</code> property is an array of providers that will be instantiated by the Nest injector and that may be shared at least across this module. </p>
<ul>
<li>When we put a provider here, we are registering it with the <a href="/notes/bXY3W37GW2ytFJOgbJiol#ioc-container1">IoC container</a> (ie. the NestJS runtime) so that it can be instantiated at the site where it is injected (this is dependency injection).</li>
</ul>
<h3 id="controllers"><code>controllers</code><a aria-hidden="true" class="anchor-heading icon-link" href="#controllers"></a></h3>
<p>the set of controllers defined in this module which have to be instantiated</p>
<h3 id="imports"><code>imports</code><a aria-hidden="true" class="anchor-heading icon-link" href="#imports"></a></h3>
<p>the list of imported modules that export the providers which are required in this module</p>
<ul>
<li>put another way, if there is a provider from another module and we want to use it in our module, then we must add the provider to that module's <code>exports</code> list, and then include that module in our <code>imports</code> list.</li>
</ul>
<p>this array enables sharing of providers across modules</p>
<p>Don't add the same provider to multiple modules. Instead, export the provider, and import the module.</p>
<h3 id="exports"><code>exports</code><a aria-hidden="true" class="anchor-heading icon-link" href="#exports"></a></h3>
<p>the subset of providers that are provided by this module and should be available in other modules which import this module. You can use either the provider itself or just its token (provide value)</p>
<p>you may consider the exported providers as the module's API</p>
<p>Modules can export their internal providers</p>
<ul>
<li>In addition, they can re-export modules that they import.</li>
</ul>
<h2 id="dynamic-modules">Dynamic Modules<a aria-hidden="true" class="anchor-heading icon-link" href="#dynamic-modules"></a></h2>
<p>Dynamic modules enable us to easily create customizable modules that can register and configure <a href="/notes/38yyqdyxub4tyjdj0jl4ulg">providers</a> dynamically.</p>
<p>Dynamic modules are created in the module class:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createDatabaseProviders <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./database.providers'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">Connection</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'./connection.provider'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token maybe-class-name">Connection</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">DatabaseModule</span></span> <span class="token punctuation">{</span>
  <span class="token comment">// forRoot may be async or sync</span>
  <span class="token keyword">static</span> <span class="token function">forRoot</span><span class="token punctuation">(</span>entities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">DynamicModule</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> providers <span class="token operator">=</span> <span class="token function">createDatabaseProviders</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span> entities<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">{</span>
      module<span class="token operator">:</span> <span class="token maybe-class-name">DatabaseModule</span><span class="token punctuation">,</span>
      providers<span class="token operator">:</span> providers<span class="token punctuation">,</span>
      exports<span class="token operator">:</span> providers<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li><a href="https://docs.nestjs.com/fundamentals/dynamic-modules">docs</a></li>
</ul>
<h2 id="global-modules">Global Modules<a aria-hidden="true" class="anchor-heading icon-link" href="#global-modules"></a></h2>
<p>Global modules are useful for when you want to provide a set of providers which should be available everywhere out-of-the-box (e.g., helpers, database connections, etc.)</p>
<p>We can make a set of providers global with the <code>@Global</code> decorator:</p>
<pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Global</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// Module configuration</span>
</code></pre>
<h2 id="cli">CLI<a aria-hidden="true" class="anchor-heading icon-link" href="#cli"></a></h2>
<ul>
<li>generate a module named "cats" - <code>nest g module cats</code></li>
</ul></div></div><p></p><p></p>
<h3 id="controllers-1">Controllers<a aria-hidden="true" class="anchor-heading icon-link" href="#controllers-1"></a></h3>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Controllers</span></div>
<a href="/notes/nqv4bkm2rp1nljndftgqxdx" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><p>Controllers are responsible for handling incoming requests and returning responses to the client.</p>
<ul>
<li>Controllers should only handle HTTP requests; delegating more complex tasks to providers</li>
</ul>
<p>Most often, providers are injected into controllers, allowing the controller the ability to call methods on the instantiated provider</p>
<ul>
<li>to do this, both the controller and the provider must be registered in the module</li>
</ul>
<p>The routing mechanism controls which controller receives which requests.</p>
<p>Normally, each controller has more than one route, and different routes can perform different actions.</p>
<ul>
<li>in a REST api, <code>/customers</code> and <code>/products</code> would be 2 different controllers
<ul>
<li>ex. route path prefix implemented as <code>@Controller('customers')</code></li>
</ul>
</li>
</ul>
<p>The decorators (e.g. <code>@Controller</code>, <code>@Get</code>) associate classes with required metadata and enable Nest to create a routing map (which associates which requests belong with which controllers)</p>
<p>Route handlers can either return a <a href="/notes/FVbSefFiCJPpdtkRRsogA">Promise</a> or an <a href="/notes/PwvObIRuk7dy0GXweZT0c">observable</a> stream:</p>
<pre class="language-ts"><code class="language-ts"><span class="token comment">// Promise approach</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Observable approach</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">Observable</span><span class="token operator">&#x3C;</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">return</span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>If returning an observable stream, Nest will automatically subscribe to the source underneath and take the last emitted value (once the stream is completed)</p></div></div><p></p><p></p>
<h3 id="providers-1">Providers<a aria-hidden="true" class="anchor-heading icon-link" href="#providers-1"></a></h3>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Providers</span></div>
<a href="/notes/38yyqdyxub4tyjdj0jl4ulg" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><h2 id="what-is-it">What is it?<a aria-hidden="true" class="anchor-heading icon-link" href="#what-is-it"></a></h2>
<p>A provider is a class that can be injected into the constructor of other classes (dependency injection)</p>
<ul>
<li>We mark the class as a <code>provider</code> by using the <code>@Injectable()</code> decorator, which lets us pass the class into a controller (spec: not limited to controllers), where it is then instantiated by the <a href="/notes/bXY3W37GW2ytFJOgbJiol#ioc-container1">IoC container</a> (ie. the NestJS runtime)</li>
</ul>
<p>The main idea of a provider is that it can be injected as dependency; this means objects can create various relationships with each other, and the function of "wiring up" instances of objects can largely be delegated to the Nest runtime system.</p>
<p>A provider "provides" some value to the dependent that it is being used in. </p>
<ul>
<li>a service is a provider that, when injected into a class, allows the class to use the methods defined on the provider itself.
<ul>
<li>ex. we could have a <code>NuggetsService</code> provider, whose role is to fetch nuggets. Now, from other providers we can inject the <code>NuggetService</code>, allowing us to fetch nuggets from that other provider.</li>
</ul>
</li>
</ul>
<p>By default, a Provider belonging to a Module will be available within the module.</p>
<ul>
<li>in other words, it does not have to be imported in the <code>module</code> if we are accessing the provider from within it.</li>
</ul>
<p>Providers normally have a lifetime ("scope") synchronized with the application lifecycle. </p>
<ul>
<li>When the application is bootstrapped, every dependency must be resolved, and therefore every provider has to be instantiated. </li>
<li>Similarly, when the application shuts down, each provider will be destroyed. 
<ul>
<li>there are ways to make your provider lifetime request-scoped as well.</li>
</ul>
</li>
</ul>
<p>Providers are plain JavaScript classes that are declared as providers in a module.</p>
<p>Responsible for things like:</p>
<ul>
<li>data storage and retrieval (Service)</li>
<li>repositories, factories, helpers</li>
</ul>
<p>Nest has a built-in <a href="/notes/bXY3W37GW2ytFJOgbJiol#ioc-container1">IoC container</a> that resolves relationships between providers.</p>
<p>The <code>@Injectable()</code> decorator attaches metadata, which declares that the class can be managed by the Nest IoC container</p>
<h2 id="how-does-it-work">How does it work?<a aria-hidden="true" class="anchor-heading icon-link" href="#how-does-it-work"></a></h2>
<p>the syntax <code>providers: [CatsService]</code> is short-hand for the more complete syntax:</p>
<pre class="language-ts"><code class="language-ts">providers<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    provide<span class="token operator">:</span> <span class="token maybe-class-name">CatsService</span><span class="token punctuation">,</span>
    useClass<span class="token operator">:</span> <span class="token maybe-class-name">CatsService</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>with this syntax, we can clearly see that the <code>CatsService</code> token is being associated with the class <code>CatsService</code>
<ul>
<li>the shorthand exists since the most common use-case is that a token is used to request an instance of a class by the same name.</li>
</ul>
</li>
<li>the value for <code>provide</code> (ie. the token) can also be a string or <a href="/notes/NeWmMgh6EOtTIMkuYRkKe">Symbol</a>. In this case, it can only be injected with the <code>@Inject</code> decorator, where the token is then referenced: <code>@Inject('CONNECTION') connection: Connection</code></li>
</ul>
<h3 id="registration-process">Registration process<a aria-hidden="true" class="anchor-heading icon-link" href="#registration-process"></a></h3>
<p>Registration happens in the <code>module</code> file.</p>
<p>Registration is about associating a token (name/id) with a class.</p>
<pre class="language-ts"><code class="language-ts"><span class="token comment">// app.module.ts</span>

<span class="token comment">// this is shorthand</span>
providers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token maybe-class-name">CatsService</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

<span class="token comment">// for this</span>
providers<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    provide<span class="token operator">:</span> <span class="token maybe-class-name">CatsService</span><span class="token punctuation">,</span> <span class="token comment">// token</span>
    useClass<span class="token operator">:</span> <span class="token maybe-class-name">CatsService</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<p>Seeing the explicit construction helps to see how the registration process (into the Nestjs IoC container) is really just a mapping between the token and the class.</p>
<ul>
<li>This is done for convenience to simplify the most common use-case, where the token is used to request an instance of a class by the same name.</li>
</ul>
<h3 id="injecting-non-service-based-providers">Injecting non-service based Providers<a aria-hidden="true" class="anchor-heading icon-link" href="#injecting-non-service-based-providers"></a></h3>
<p>Though the most common use is to inject services, we can really inject any kind of value, allowing us to do things like put an external library into the Nest IoC container, or replace a real implementation with a mock object (useful for testing).</p>
<ul>
<li>ex. here, we are associating a string-valued token (<code>'CONNECTION'</code>) with a pre-existing connection object we've imported from an external file:</li>
</ul>
<pre class="language-ts"><code class="language-ts">providers<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    provide<span class="token operator">:</span> <span class="token string">'CONNECTION'</span><span class="token punctuation">,</span>
    useValue<span class="token operator">:</span> connection<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre>
<p>Which can be used in a provider:</p>
<pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">CatsRepository</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span><span class="token punctuation">(</span><span class="token string">'CONNECTION'</span><span class="token punctuation">)</span> connection<span class="token operator">:</span> <span class="token maybe-class-name">Connection</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="asynchronous-providers-usefactory">Asynchronous providers (<code>useFactory</code>)<a aria-hidden="true" class="anchor-heading icon-link" href="#asynchronous-providers-usefactory"></a></h3>
<p>At times, the application start should be delayed until one or more asynchronous tasks are completed. </p>
<ul>
<li>ex. you may not want to start accepting requests until the connection with the database has been established. </li>
</ul>
<p>This can be accomplished by registering a provider as an <code>async</code> function along with the <code>useFactory</code> syntax.</p>
<pre class="language-ts"><code class="language-ts">providers<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    provide<span class="token operator">:</span> <span class="token string">'ASYNC_CONNECTION'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">useFactory</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">return</span> connection<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
<p>This factory function returns a provider, which can then be injected into a class like any other provider with <code>@Inject('ASYNC_CONNECTION')</code></p>
<p>Here, Nest will await resolution of the <code>useFactory</code> promise before instantiating any class that depends on (injects) such a provider.</p>
<hr>
<h2 id="custom-providers">Custom Providers<a aria-hidden="true" class="anchor-heading icon-link" href="#custom-providers"></a></h2>
<p>Custom providers let us do things like:</p>
<ul>
<li>instantiate a provider by ourselves (instead of delegating that responsibility to the Nestjs runtime)</li>
<li>re-use an existing class in a second dependency</li>
<li>override a class with a mock version for testing</li>
</ul>
<h3 id="class-provider-useclass">Class Provider (<code>useClass</code>)<a aria-hidden="true" class="anchor-heading icon-link" href="#class-provider-useclass"></a></h3>
<p><code>useClass</code> is the default way to specify which provider the token will resolve to.</p>
<ul>
<li>in other words, the shortform will resolve to this syntax.</li>
</ul>
<p>We can dynamically determine the class that the token will resolve to by using a ternary operator in the <code>useClass</code> key.</p>
<ul>
<li>ex. imagine you have a default <code>ConfigService</code> (therefore, high level of generality/abstraction). Depending on which environment we are in, we want to provide the Nestjs IoC container with a different implementation of the class.</li>
</ul>
<h3 id="value-provider-usevalue">Value Provider (<code>useValue</code>)<a aria-hidden="true" class="anchor-heading icon-link" href="#value-provider-usevalue"></a></h3>
<p>Specifying a provider like this is useful for injecting a constant value.</p>
<ul>
<li>ex. putting an external libary into the Nestjs container.</li>
<li>ex. replace a real implementation with a mock object</li>
</ul>
<p>The value to <code>useValue</code> will be a simple object that has the same interface as the service it is replacing.</p>
<h3 id="factory-provider">Factory Provider<a aria-hidden="true" class="anchor-heading icon-link" href="#factory-provider"></a></h3></div></div><p></p><p></p>
<h3 id="middleware">Middleware<a aria-hidden="true" class="anchor-heading icon-link" href="#middleware"></a></h3>
<p></p><p></p><div class="portal-container">
<div class="portal-head">
<div class="portal-backlink">
<div class="portal-title">From <span class="portal-text-title">Middleware</span></div>
<a href="/notes/9oglq5pogy5inbt24yjk3hp" class="portal-arrow">Go to text <span class="right-arrow">→</span></a>
</div>
</div>
<div id="portal-parent-anchor" class="portal-parent" markdown="1">
<div class="portal-parent-fader-top"></div>
<div class="portal-parent-fader-bottom"></div><p>Nestjs middleware is equivalent to <a href="/notes/inMGAxYKmDgpSWcHN6tXN">Express middleware</a></p>
<p>Custom middleware is implemented either in either a function, or in a class with an <code>@Injectable()</code> decorator.</p>
<ul>
<li>The class should implement the <code>NestMiddleware</code> interface, while the function does not have any special requirements.</li>
</ul>
<p>Middleware fully supports dependency injection.</p>
<p>We set up middleware using the <code>configure()</code> method of the module class. </p>
<ul>
<li>Modules that include middleware have to implement the <code>NestModule</code> interface.</li>
</ul>
<pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token maybe-class-name">CatsModule</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">AppModule</span></span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token maybe-class-name">NestModule</span></span> <span class="token punctuation">{</span>
  <span class="token function">configure</span><span class="token punctuation">(</span>consumer<span class="token operator">:</span> <span class="token maybe-class-name">MiddlewareConsumer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    consumer
      <span class="token punctuation">.</span><span class="token method function property-access">apply</span><span class="token punctuation">(</span><span class="token maybe-class-name">LoggerMiddleware</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token method function property-access">forRoutes</span><span class="token punctuation">(</span><span class="token string">'cats'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div><p></p><p></p>
<h2 id="misc">Misc<a aria-hidden="true" class="anchor-heading icon-link" href="#misc"></a></h2>
<ul>
<li>In Nest, a microservice is defined as an application that uses a different transport layer than HTTP.</li>
</ul>
<hr>
<strong>Children</strong>
<ol>
<li><a href="/notes/y2pkv1qotvf5os9vzkt9lu3">CLI</a></li>
<li><a href="/notes/nqv4bkm2rp1nljndftgqxdx">Controllers</a></li>
<li><a href="/notes/n9fg78mnpuk5u5xalihz2bp">Guard</a></li>
<li><a href="/notes/saert7xobzak9v2h5jt72b3">Interceptor</a></li>
<li><a href="/notes/rluwlir1bxtd1qe8cjrfamg">Microservices</a></li>
<li><a href="/notes/9oglq5pogy5inbt24yjk3hp">Middleware</a></li>
<li><a href="/notes/y8044sa0ai1u2hyoka0lphz">Modules</a></li>
<li><a href="/notes/oz006ng8c7qcbzg2ytasznj">Pipe</a></li>
<li><a href="/notes/38yyqdyxub4tyjdj0jl4ulg">Providers</a></li>
<li><a href="/notes/10w9l0kg4v6ik1ceqcfopn2">Runtim</a></li>
<li><a href="/notes/0lnvdlokt83ssdfl15292vm">Testing in Nestjs</a></li>
</ol>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/notes/L5JUZlGAGvTxrsEBB7DY8">Express</a></li>
<li><a href="/notes/bXY3W37GW2ytFJOgbJiol">IoC (Inversion of Control)</a></li>
<li><a href="/notes/OIBi54r4RJHlcy33iXLpD">Dependency Injection</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#platform" title="Platform">Platform</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#lifecycle" title="Lifecycle">Lifecycle</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#dependency-injection-and-decorators" title="Dependency Injection and Decorators">Dependency Injection and Decorators</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#context" title="Context">Context</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#argumentshost" title="ArgumentsHost">ArgumentsHost</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#methods" title="Methods">Methods</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#executioncontext" title="ExecutionContext">ExecutionContext</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#methods-1" title="Methods">Methods</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#metadata-and-reflection" title="Metadata and Reflection">Metadata and Reflection</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#core-components" title="Core Components">Core Components</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#modules" title="Modules">Modules</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#controllers" title="Controllers">Controllers</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#providers" title="Providers">Providers</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#middleware" title="Middleware">Middleware</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#misc" title="Misc">Misc</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"613syb18hb3v0u1ydvor7ru","title":"Nestjs","desc":"","updated":1674681817034,"created":1648238868315,"custom":{},"fname":"nestjs","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"bae208b86500af10bbb1eed455006bd5","links":[{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"general.patterns.messaging.pubsub","alias":"pub/sub","position":{"start":{"line":4,"column":59,"offset":126},"end":{"line":4,"column":104,"offset":171},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.patterns.messaging.pubsub"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.modules","alias":"modules","position":{"start":{"line":5,"column":43,"offset":219},"end":{"line":5,"column":69,"offset":245},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"nestjs.modules"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"general.patterns.dependency-injection","alias":"constructor dependency injection","position":{"start":{"line":6,"column":38,"offset":284},"end":{"line":6,"column":152,"offset":398},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.patterns.dependency-injection","anchorHeader":"nestjs-constructor-dependency-injection"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.providers","alias":"providers","position":{"start":{"line":7,"column":20,"offset":420},"end":{"line":7,"column":50,"offset":450},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"nestjs.providers"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"express","alias":"Express","position":{"start":{"line":13,"column":23,"offset":872},"end":{"line":13,"column":42,"offset":891},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"express"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"deploy.serverless","alias":"serverless","position":{"start":{"line":25,"column":62,"offset":1606},"end":{"line":25,"column":94,"offset":1638},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"deploy.serverless"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"general.patterns.dependency-injection","alias":"dependency injection","position":{"start":{"line":37,"column":37,"offset":2233},"end":{"line":37,"column":99,"offset":2295},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.patterns.dependency-injection"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"js.lang.decorator","alias":"decorators","position":{"start":{"line":37,"column":127,"offset":2323},"end":{"line":37,"column":159,"offset":2355},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"js.lang.decorator"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.providers","alias":"provider","position":{"start":{"line":40,"column":41,"offset":2501},"end":{"line":40,"column":70,"offset":2530},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"nestjs.providers"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"general.patterns.IoC","alias":"IoC","position":{"start":{"line":41,"column":85,"offset":2696},"end":{"line":41,"column":113,"offset":2724},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.patterns.IoC"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.guard","alias":"guards","position":{"start":{"line":50,"column":51,"offset":3283},"end":{"line":50,"column":74,"offset":3306},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"nestjs.guard"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.interceptor","alias":"interceptors","position":{"start":{"line":50,"column":89,"offset":3321},"end":{"line":50,"column":124,"offset":3356},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"nestjs.interceptor"}},{"type":"wiki","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.controllers","alias":"controllers","position":{"start":{"line":50,"column":161,"offset":3393},"end":{"line":50,"column":195,"offset":3427},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"nestjs.controllers"}},{"type":"ref","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.modules","position":{"start":{"line":93,"column":1,"offset":5969},"end":{"line":93,"column":20,"offset":5988},"indent":[]},"xvault":false,"to":{"fname":"nestjs.modules"}},{"type":"ref","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.controllers","position":{"start":{"line":96,"column":1,"offset":6006},"end":{"line":96,"column":24,"offset":6029},"indent":[]},"xvault":false,"to":{"fname":"nestjs.controllers"}},{"type":"ref","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.providers","position":{"start":{"line":99,"column":1,"offset":6045},"end":{"line":99,"column":22,"offset":6066},"indent":[]},"xvault":false,"to":{"fname":"nestjs.providers"}},{"type":"ref","from":{"fname":"nestjs","id":"613syb18hb3v0u1ydvor7ru","vaultName":"tech"},"value":"nestjs.middleware","position":{"start":{"line":102,"column":1,"offset":6083},"end":{"line":102,"column":23,"offset":6105},"indent":[]},"xvault":false,"to":{"fname":"nestjs.middleware"}},{"from":{"fname":"express","id":"L5JUZlGAGvTxrsEBB7DY8","vaultName":"tech"},"type":"backlink","position":{"start":{"line":9,"column":3,"offset":248},"end":{"line":9,"column":13,"offset":258},"indent":[]},"value":"nestjs"},{"from":{"fname":"general.patterns.IoC","id":"bXY3W37GW2ytFJOgbJiol","vaultName":"tech"},"type":"backlink","position":{"start":{"line":11,"column":7,"offset":688},"end":{"line":11,"column":17,"offset":698},"indent":[]},"value":"nestjs"},{"from":{"fname":"general.patterns.dependency-injection","id":"OIBi54r4RJHlcy33iXLpD","vaultName":"tech"},"type":"backlink","position":{"start":{"line":5,"column":12,"offset":213},"end":{"line":5,"column":29,"offset":230},"indent":[]},"value":"nestjs"}],"anchors":{"platform":{"type":"header","text":"Platform","value":"platform","line":17,"column":0,"depth":2},"lifecycle":{"type":"header","text":"Lifecycle","value":"lifecycle","line":36,"column":0,"depth":3},"dependency-injection-and-decorators":{"type":"header","text":"Dependency Injection and Decorators","value":"dependency-injection-and-decorators","line":42,"column":0,"depth":3},"context":{"type":"header","text":"Context","value":"context","line":53,"column":0,"depth":3},"argumentshost":{"type":"header","text":"ArgumentsHost","value":"argumentshost","line":59,"column":0,"depth":4},"methods":{"type":"header","text":"Methods","value":"methods","line":66,"column":0,"depth":5},"executioncontext":{"type":"header","text":"ExecutionContext","value":"executioncontext","line":76,"column":0,"depth":4},"methods-1":{"type":"header","text":"Methods","value":"methods-1","line":81,"column":0,"depth":5},"metadata-and-reflection":{"type":"header","text":"Metadata and Reflection","value":"metadata-and-reflection","line":88,"column":0,"depth":3},"core-components":{"type":"header","text":"Core Components","value":"core-components","line":97,"column":0,"depth":2},"modules":{"type":"header","text":"Modules","value":"modules","line":98,"column":0,"depth":3},"controllers":{"type":"header","text":"Controllers","value":"controllers","line":101,"column":0,"depth":3},"providers":{"type":"header","text":"Providers","value":"providers","line":104,"column":0,"depth":3},"middleware":{"type":"header","text":"Middleware","value":"middleware","line":107,"column":0,"depth":3},"misc":{"type":"header","text":"Misc","value":"misc","line":110,"column":0,"depth":2}},"children":["y2pkv1qotvf5os9vzkt9lu3","nqv4bkm2rp1nljndftgqxdx","n9fg78mnpuk5u5xalihz2bp","saert7xobzak9v2h5jt72b3","rluwlir1bxtd1qe8cjrfamg","9oglq5pogy5inbt24yjk3hp","y8044sa0ai1u2hyoka0lphz","oz006ng8c7qcbzg2ytasznj","38yyqdyxub4tyjdj0jl4ulg","10w9l0kg4v6ik1ceqcfopn2","0lnvdlokt83ssdfl15292vm"],"parent":"olZIVfSs2uLLr3BppFh4K","data":{}},"body":"\u003ch1 id=\"nestjs\"\u003eNestjs\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#nestjs\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eNestjs is a server-side application framework\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ehighly opinionated\u003c/li\u003e\n\u003cli\u003esupports multiple data paradigms, such as ClientServer, \u003ca href=\"/notes/NpY4iv9TwpGJODbVesQYe\"\u003epub/sub\u003c/a\u003e etc.\u003c/li\u003e\n\u003cli\u003eachieves SOLID principles by the use of \u003ca href=\"/notes/y8044sa0ai1u2hyoka0lphz\"\u003emodules\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003emodule dependency is achieved with \u003ca href=\"/notes/OIBi54r4RJHlcy33iXLpD#nestjs-constructor-dependency-injection\"\u003econstructor dependency injection\u003c/a\u003e. \n\u003cul\u003e\n\u003cli\u003eModules import \u003ca href=\"/notes/38yyqdyxub4tyjdj0jl4ulg\"\u003eproviders\u003c/a\u003e to perform some purpose (such as retrieve data from a database, send a message etc.), and those providers are made available within the module. To pass\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eNestjs provides an all-tools-supplied approach. \n\u003cul\u003e\n\u003cli\u003eex. It has modules out of the box for connections to most types of databases/datastreams (e.g. RDBs, Redis, Kafka, RabbitMQ) and \u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"platform\"\u003ePlatform\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#platform\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eNestjs is built on top of an HTTP Node framework\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edefault options are \u003ca href=\"/notes/L5JUZlGAGvTxrsEBB7DY8\"\u003eExpress\u003c/a\u003e and Fastify\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eDepending on which underlying platform we use, we will get access to its API (\u003ccode\u003eNestExpressApplication\u003c/code\u003e or \u003ccode\u003eNestFastifyApplication\u003c/code\u003e)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe resulting \u003ccode\u003eapp\u003c/code\u003e object will have access to the methods of whichever underlying platform we choose.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e app \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eNestFactory\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003ecreate\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eNestExpressApplication\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eAppModule\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ein Nest, almost everything is shared across incoming requests. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eex. We have a connection pool to the database, singleton services with global state, etc.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBy default, modules are eagerly loaded (which means that as soon as the application loads, so do all the modules, whether or not they are immediately necessary).\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethis is fine for the most part, but if we are running in a \u003ca href=\"/notes/aOfHQ6odySXLBhQgkOtOp\"\u003eserverless\u003c/a\u003e environment, this would be problematic.\n\u003cul\u003e\n\u003cli\u003ein this case we want to lazy load the modules.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/2022-05-16-13-27-38.png\"\u003e\u003c/p\u003e\n\u003ch3 id=\"lifecycle\"\u003eLifecycle\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#lifecycle\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eA Nest application, as well as every application element, has a lifecycle managed by Nest. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNest provides lifecycle hooks that give visibility into key lifecycle events, and the ability to run registered code in your \u003ccode\u003emodule\u003c/code\u003e, \u003ccode\u003einjectable\u003c/code\u003e or \u003ccode\u003econtroller\u003c/code\u003e when they occur.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLifecycle events can be broken into 3 phases: \u003cem\u003einitializing\u003c/em\u003e, \u003cem\u003erunning\u003c/em\u003e and \u003cem\u003eterminating\u003c/em\u003e\u003c/p\u003e\n\u003ch3 id=\"dependency-injection-and-decorators\"\u003eDependency Injection and Decorators\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#dependency-injection-and-decorators\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eNest is built around the pattern of \u003ca href=\"/notes/OIBi54r4RJHlcy33iXLpD\"\u003edependency injection\u003c/a\u003e, which is achieved through \u003ca href=\"/notes/j8xi6ftco6n2pbjqw6sbijg\"\u003edecorators\u003c/a\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThis is mostly done through the constructor (therefore, it's constructor-based dependency injection)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe general pattern is that we create a \u003ca href=\"/notes/38yyqdyxub4tyjdj0jl4ulg\"\u003eprovider\u003c/a\u003e by decorating a class with \u003ccode\u003e@Injectable\u003c/code\u003e, then we pass that class into another c\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethe \u003ccode\u003e@Injectable\u003c/code\u003e decorator enables the class to be registered and managed by the \u003ca href=\"/notes/bXY3W37GW2ytFJOgbJiol\"\u003eIoC\u003c/a\u003e container (\u003ccode\u003e@Modules\u003c/code\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhen we inject a class into another class, Nest will instantiate the class and pass it to the controller's constructor.\u003c/p\u003e\n\u003cp\u003eBecause of Typescript in Nestjs, it is very easy to manage dependencies, since they are resolved by type.\u003c/p\u003e\n\u003ch3 id=\"context\"\u003eContext\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#context\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eGuards, filters and interceptors are meant to be generic. That is, they don't care if they are being used in an HTTP context or WebSockets context.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNestjs provides utility classes that provide information about the current execution context.\n\u003cul\u003e\n\u003cli\u003ethis information can be used to build generic \u003ca href=\"/notes/n9fg78mnpuk5u5xalihz2bp\"\u003eguards\u003c/a\u003e, filters, and \u003ca href=\"/notes/saert7xobzak9v2h5jt72b3\"\u003einterceptors\u003c/a\u003e that can work across a broad set of \u003ca href=\"/notes/nqv4bkm2rp1nljndftgqxdx\"\u003econtrollers\u003c/a\u003e, methods, and execution contexts.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eTwo of these utility classes are \u003ccode\u003eArgumentsHost\u003c/code\u003e and \u003ccode\u003eExecutionContext\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"argumentshost\"\u003e\u003ccode\u003eArgumentsHost\u003c/code\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#argumentshost\"\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003eArgumentsHost\u003c/code\u003e is simply an abstraction over a handler's arguments.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eex. for HTTP server applications, the \u003ccode\u003ehost\u003c/code\u003e object encapsulates Express's \u003ccode\u003e[request, response, next]\u003c/code\u003e array\u003c/li\u003e\n\u003cli\u003eex. for Graphql server applications, the \u003ccode\u003ehost\u003c/code\u003e object contains the \u003ccode\u003e[root, args, context, info]\u003c/code\u003e array.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis class provides methods for retrieving the arguments being passed to a handler. With it, we choose the appropriate context, and then we retrieve the arguments.\u003c/p\u003e\n\u003ch5 id=\"methods\"\u003eMethods\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#methods\"\u003e\u003c/a\u003e\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egetType()\u003c/code\u003e tells us which context is being used (\u003ccode\u003ehttp\u003c/code\u003e, \u003ccode\u003erpc\u003c/code\u003e etc.)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egetArgs()\u003c/code\u003e gets us back an array of arguments being passed to the handler\n\u003cul\u003e\n\u003cli\u003ethis is generic, since we don't know what arguments we are getting back (since the context has not been specified). For this reason, using \u003ccode\u003eswitchTo...\u003c/code\u003e methods might be preferable, since they return more specific types (such as \u003ccode\u003eHttpArgumentsHost\u003c/code\u003e or \u003ccode\u003eRpcArgumentsHost\u003c/code\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eswitchToHttp()\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e ctx \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e host\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eswitchToHttp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e request \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ctx\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token generic-function\"\u003e\u003cspan class=\"token function\"\u003egetRequest\u003c/span\u003e\u003cspan class=\"token generic class-name\"\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eRequest\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"executioncontext\"\u003e\u003ccode\u003eExecutionContext\u003c/code\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#executioncontext\"\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cp\u003e\u003ccode\u003eExecutionContext\u003c/code\u003e extends \u003ccode\u003eArgumentsHost\u003c/code\u003e, and gives us additional details about the current execution process.\u003c/p\u003e\n\u003cp\u003eNest provides an instance of \u003ccode\u003eExecutionContext\u003c/code\u003e in places you may need it, such as in the \u003ccode\u003ecanActivate()\u003c/code\u003e method of a guard and the \u003ccode\u003eintercept()\u003c/code\u003e method of an interceptor. \u003c/p\u003e\n\u003ch5 id=\"methods-1\"\u003eMethods\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#methods-1\"\u003e\u003c/a\u003e\u003c/h5\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003egetClass()\u003c/code\u003e Returns the type of the controller class which the current handler belongs to.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egetHandler()\u003c/code\u003e Returns a reference to the handler (method) that will be invoked next in the request pipeline.\n\u003cul\u003e\n\u003cli\u003eex. in an HTTP context, if the currently processed request is a POST request, bound to the \u003ccode\u003ecreate()\u003c/code\u003e method on the \u003ccode\u003eCatsController\u003c/code\u003e, \u003ccode\u003egetHandler()\u003c/code\u003e returns a reference to the \u003ccode\u003ecreate()\u003c/code\u003e method and \u003ccode\u003egetClass()\u003c/code\u003e returns the \u003ccode\u003eCatsController\u003c/code\u003e type (not instance).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe ability to access these references gives us the opportunity to access the metadata set through the \u003ccode\u003e@SetMetadata()\u003c/code\u003e decorator from within guards or interceptors.\u003c/p\u003e\n\u003ch3 id=\"metadata-and-reflection\"\u003eMetadata and Reflection\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#metadata-and-reflection\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.nestjs.com/fundamentals/execution-context#reflection-and-metadata\"\u003edocs\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWe can attach custom metadata to route handlers with the \u003ccode\u003e@SetMetadata()\u003c/code\u003e decorator, which can then be accessed from within the class via dependency injection (with the \u003ccode\u003eReflector\u003c/code\u003e helper class) to make certain decisions.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eex. we can create some metadata about the roles that a user has.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"core-components\"\u003eCore Components\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#core-components\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"modules\"\u003eModules\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#modules\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cdiv class=\"portal-container\"\u003e\n\u003cdiv class=\"portal-head\"\u003e\n\u003cdiv class=\"portal-backlink\"\u003e\n\u003cdiv class=\"portal-title\"\u003eFrom \u003cspan class=\"portal-text-title\"\u003eModules\u003c/span\u003e\u003c/div\u003e\n\u003ca href=\"/notes/y8044sa0ai1u2hyoka0lphz\" class=\"portal-arrow\"\u003eGo to text \u003cspan class=\"right-arrow\"\u003e→\u003c/span\u003e\u003c/a\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv id=\"portal-parent-anchor\" class=\"portal-parent\" markdown=\"1\"\u003e\n\u003cdiv class=\"portal-parent-fader-top\"\u003e\u003c/div\u003e\n\u003cdiv class=\"portal-parent-fader-bottom\"\u003e\u003c/div\u003e\u003cp\u003eModules are the way to organize your components in Nest.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDecorating a class with \u003ccode\u003e@Module\u003c/code\u003e provides metadata that Nest makes use of to organize the application structure.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eEach application has at least one module, a root module. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethis is the starting point Nest uses to build the application graph, which is the internal data structure used to resolve module and provider relationships and dependencies.\u003c/li\u003e\n\u003cli\u003ethis is the module that we register in our \u003ccode\u003emain.ts\u003c/code\u003e with \u003ccode\u003eNestFactory.create(AppModule)\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFor most applications, the resulting architecture will employ multiple modules, each encapsulating a closely related set of capabilities.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003egood practice is to have each module correspond to a \u003ca href=\"/notes/GDJoTJocO8OKbTtSjn2CW\"\u003edomain\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe module encapsulates providers by default\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThis means that in order to inject providers into a different module, they must be exported from the imported module.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003emodules are singletons by default\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ethus you can share the same instance of any provider between multiple modules effortlessly.\u003c/li\u003e\n\u003cli\u003eEvery module is automatically a shared module: Once created it can be reused by any module\n\u003cul\u003e\n\u003cli\u003eto do this, simply add the service to the \u003ccode\u003eexports\u003c/code\u003e array of the shared module. Now, any module that imports the shared module will have access to the service listed in that \u003ccode\u003eexports\u003c/code\u003e array.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/assets/images/2023-01-23-12-12-32.png\"\u003e\u003c/p\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// correspond to the HttpService class that gets injected into the provider (service).\u003c/span\u003e\n  imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eHttpModule\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  providers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eAutomationService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  exports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eAutomationService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eAutomationModule\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Modules can inject providers (e.g. for configuration purposes):\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eprivate\u003c/span\u003e automationService\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eAutomationService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eModules themselves cannot be injected due to circular dependency.\u003c/p\u003e\n\u003ch2 id=\"parts-of-a-module\"\u003eParts of a module\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#parts-of-a-module\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003e@Module()\u003c/code\u003e decorator takes a single object whose properties describe the module:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eproviders\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003e\u003ccode\u003econtrollers\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eimports\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eexports\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"providers\"\u003e\u003ccode\u003eproviders\u003c/code\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#providers\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003eproviders\u003c/code\u003e property is an array of providers that will be instantiated by the Nest injector and that may be shared at least across this module. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWhen we put a provider here, we are registering it with the \u003ca href=\"/notes/bXY3W37GW2ytFJOgbJiol#ioc-container1\"\u003eIoC container\u003c/a\u003e (ie. the NestJS runtime) so that it can be instantiated at the site where it is injected (this is dependency injection).\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"controllers\"\u003e\u003ccode\u003econtrollers\u003c/code\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#controllers\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003ethe set of controllers defined in this module which have to be instantiated\u003c/p\u003e\n\u003ch3 id=\"imports\"\u003e\u003ccode\u003eimports\u003c/code\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#imports\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003ethe list of imported modules that export the providers which are required in this module\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eput another way, if there is a provider from another module and we want to use it in our module, then we must add the provider to that module's \u003ccode\u003eexports\u003c/code\u003e list, and then include that module in our \u003ccode\u003eimports\u003c/code\u003e list.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ethis array enables sharing of providers across modules\u003c/p\u003e\n\u003cp\u003eDon't add the same provider to multiple modules. Instead, export the provider, and import the module.\u003c/p\u003e\n\u003ch3 id=\"exports\"\u003e\u003ccode\u003eexports\u003c/code\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#exports\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003ethe subset of providers that are provided by this module and should be available in other modules which import this module. You can use either the provider itself or just its token (provide value)\u003c/p\u003e\n\u003cp\u003eyou may consider the exported providers as the module's API\u003c/p\u003e\n\u003cp\u003eModules can export their internal providers\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIn addition, they can re-export modules that they import.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"dynamic-modules\"\u003eDynamic Modules\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#dynamic-modules\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eDynamic modules enable us to easily create customizable modules that can register and configure \u003ca href=\"/notes/38yyqdyxub4tyjdj0jl4ulg\"\u003eproviders\u003c/a\u003e dynamically.\u003c/p\u003e\n\u003cp\u003eDynamic modules are created in the module class:\u003c/p\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e createDatabaseProviders \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./database.providers'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eConnection\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e'./connection.provider'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  providers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eConnection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eDatabaseModule\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// forRoot may be async or sync\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"token function\"\u003eforRoot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eentities \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e options\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDynamicModule\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e providers \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateDatabaseProviders\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eoptions\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e entities\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      module\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eDatabaseModule\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      providers\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e providers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      exports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e providers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://docs.nestjs.com/fundamentals/dynamic-modules\"\u003edocs\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"global-modules\"\u003eGlobal Modules\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#global-modules\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eGlobal modules are useful for when you want to provide a set of providers which should be available everywhere out-of-the-box (e.g., helpers, database connections, etc.)\u003c/p\u003e\n\u003cp\u003eWe can make a set of providers global with the \u003ccode\u003e@Global\u003c/code\u003e decorator:\u003c/p\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eGlobal\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Module configuration\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"cli\"\u003eCLI\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#cli\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003egenerate a module named \"cats\" - \u003ccode\u003enest g module cats\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\n\u003ch3 id=\"controllers-1\"\u003eControllers\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#controllers-1\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cdiv class=\"portal-container\"\u003e\n\u003cdiv class=\"portal-head\"\u003e\n\u003cdiv class=\"portal-backlink\"\u003e\n\u003cdiv class=\"portal-title\"\u003eFrom \u003cspan class=\"portal-text-title\"\u003eControllers\u003c/span\u003e\u003c/div\u003e\n\u003ca href=\"/notes/nqv4bkm2rp1nljndftgqxdx\" class=\"portal-arrow\"\u003eGo to text \u003cspan class=\"right-arrow\"\u003e→\u003c/span\u003e\u003c/a\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv id=\"portal-parent-anchor\" class=\"portal-parent\" markdown=\"1\"\u003e\n\u003cdiv class=\"portal-parent-fader-top\"\u003e\u003c/div\u003e\n\u003cdiv class=\"portal-parent-fader-bottom\"\u003e\u003c/div\u003e\u003cp\u003eControllers are responsible for handling incoming requests and returning responses to the client.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eControllers should only handle HTTP requests; delegating more complex tasks to providers\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eMost often, providers are injected into controllers, allowing the controller the ability to call methods on the instantiated provider\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eto do this, both the controller and the provider must be registered in the module\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe routing mechanism controls which controller receives which requests.\u003c/p\u003e\n\u003cp\u003eNormally, each controller has more than one route, and different routes can perform different actions.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ein a REST api, \u003ccode\u003e/customers\u003c/code\u003e and \u003ccode\u003e/products\u003c/code\u003e would be 2 different controllers\n\u003cul\u003e\n\u003cli\u003eex. route path prefix implemented as \u003ccode\u003e@Controller('customers')\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe decorators (e.g. \u003ccode\u003e@Controller\u003c/code\u003e, \u003ccode\u003e@Get\u003c/code\u003e) associate classes with required metadata and enable Nest to create a routing map (which associates which requests belong with which controllers)\u003c/p\u003e\n\u003cp\u003eRoute handlers can either return a \u003ca href=\"/notes/FVbSefFiCJPpdtkRRsogA\"\u003ePromise\u003c/a\u003e or an \u003ca href=\"/notes/PwvObIRuk7dy0GXweZT0c\"\u003eobservable\u003c/a\u003e stream:\u003c/p\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token comment\"\u003e// Promise approach\u003c/span\u003e\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token function\"\u003efindAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token builtin\"\u003eany\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Observable approach\u003c/span\u003e\n\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eGet\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token function\"\u003efindAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eObservable\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token builtin\"\u003eany\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eof\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf returning an observable stream, Nest will automatically subscribe to the source underneath and take the last emitted value (once the stream is completed)\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\n\u003ch3 id=\"providers-1\"\u003eProviders\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#providers-1\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cdiv class=\"portal-container\"\u003e\n\u003cdiv class=\"portal-head\"\u003e\n\u003cdiv class=\"portal-backlink\"\u003e\n\u003cdiv class=\"portal-title\"\u003eFrom \u003cspan class=\"portal-text-title\"\u003eProviders\u003c/span\u003e\u003c/div\u003e\n\u003ca href=\"/notes/38yyqdyxub4tyjdj0jl4ulg\" class=\"portal-arrow\"\u003eGo to text \u003cspan class=\"right-arrow\"\u003e→\u003c/span\u003e\u003c/a\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv id=\"portal-parent-anchor\" class=\"portal-parent\" markdown=\"1\"\u003e\n\u003cdiv class=\"portal-parent-fader-top\"\u003e\u003c/div\u003e\n\u003cdiv class=\"portal-parent-fader-bottom\"\u003e\u003c/div\u003e\u003ch2 id=\"what-is-it\"\u003eWhat is it?\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#what-is-it\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eA provider is a class that can be injected into the constructor of other classes (dependency injection)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWe mark the class as a \u003ccode\u003eprovider\u003c/code\u003e by using the \u003ccode\u003e@Injectable()\u003c/code\u003e decorator, which lets us pass the class into a controller (spec: not limited to controllers), where it is then instantiated by the \u003ca href=\"/notes/bXY3W37GW2ytFJOgbJiol#ioc-container1\"\u003eIoC container\u003c/a\u003e (ie. the NestJS runtime)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe main idea of a provider is that it can be injected as dependency; this means objects can create various relationships with each other, and the function of \"wiring up\" instances of objects can largely be delegated to the Nest runtime system.\u003c/p\u003e\n\u003cp\u003eA provider \"provides\" some value to the dependent that it is being used in. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea service is a provider that, when injected into a class, allows the class to use the methods defined on the provider itself.\n\u003cul\u003e\n\u003cli\u003eex. we could have a \u003ccode\u003eNuggetsService\u003c/code\u003e provider, whose role is to fetch nuggets. Now, from other providers we can inject the \u003ccode\u003eNuggetService\u003c/code\u003e, allowing us to fetch nuggets from that other provider.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBy default, a Provider belonging to a Module will be available within the module.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ein other words, it does not have to be imported in the \u003ccode\u003emodule\u003c/code\u003e if we are accessing the provider from within it.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eProviders normally have a lifetime (\"scope\") synchronized with the application lifecycle. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWhen the application is bootstrapped, every dependency must be resolved, and therefore every provider has to be instantiated. \u003c/li\u003e\n\u003cli\u003eSimilarly, when the application shuts down, each provider will be destroyed. \n\u003cul\u003e\n\u003cli\u003ethere are ways to make your provider lifetime request-scoped as well.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eProviders are plain JavaScript classes that are declared as providers in a module.\u003c/p\u003e\n\u003cp\u003eResponsible for things like:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003edata storage and retrieval (Service)\u003c/li\u003e\n\u003cli\u003erepositories, factories, helpers\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNest has a built-in \u003ca href=\"/notes/bXY3W37GW2ytFJOgbJiol#ioc-container1\"\u003eIoC container\u003c/a\u003e that resolves relationships between providers.\u003c/p\u003e\n\u003cp\u003eThe \u003ccode\u003e@Injectable()\u003c/code\u003e decorator attaches metadata, which declares that the class can be managed by the Nest IoC container\u003c/p\u003e\n\u003ch2 id=\"how-does-it-work\"\u003eHow does it work?\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#how-does-it-work\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003ethe syntax \u003ccode\u003eproviders: [CatsService]\u003c/code\u003e is short-hand for the more complete syntax:\u003c/p\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003eproviders\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    provide\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eCatsService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    useClass\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eCatsService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003ewith this syntax, we can clearly see that the \u003ccode\u003eCatsService\u003c/code\u003e token is being associated with the class \u003ccode\u003eCatsService\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003ethe shorthand exists since the most common use-case is that a token is used to request an instance of a class by the same name.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ethe value for \u003ccode\u003eprovide\u003c/code\u003e (ie. the token) can also be a string or \u003ca href=\"/notes/NeWmMgh6EOtTIMkuYRkKe\"\u003eSymbol\u003c/a\u003e. In this case, it can only be injected with the \u003ccode\u003e@Inject\u003c/code\u003e decorator, where the token is then referenced: \u003ccode\u003e@Inject('CONNECTION') connection: Connection\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"registration-process\"\u003eRegistration process\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#registration-process\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eRegistration happens in the \u003ccode\u003emodule\u003c/code\u003e file.\u003c/p\u003e\n\u003cp\u003eRegistration is about associating a token (name/id) with a class.\u003c/p\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token comment\"\u003e// app.module.ts\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// this is shorthand\u003c/span\u003e\nproviders\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eCatsService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// for this\u003c/span\u003e\nproviders\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    provide\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eCatsService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// token\u003c/span\u003e\n    useClass\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eCatsService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSeeing the explicit construction helps to see how the registration process (into the Nestjs IoC container) is really just a mapping between the token and the class.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThis is done for convenience to simplify the most common use-case, where the token is used to request an instance of a class by the same name.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"injecting-non-service-based-providers\"\u003eInjecting non-service based Providers\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#injecting-non-service-based-providers\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThough the most common use is to inject services, we can really inject any kind of value, allowing us to do things like put an external library into the Nest IoC container, or replace a real implementation with a mock object (useful for testing).\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eex. here, we are associating a string-valued token (\u003ccode\u003e'CONNECTION'\u003c/code\u003e) with a pre-existing connection object we've imported from an external file:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003eproviders\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    provide\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'CONNECTION'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    useValue\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e connection\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhich can be used in a provider:\u003c/p\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eInjectable\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eCatsRepository\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eInject\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'CONNECTION'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e connection\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eConnection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"asynchronous-providers-usefactory\"\u003eAsynchronous providers (\u003ccode\u003euseFactory\u003c/code\u003e)\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#asynchronous-providers-usefactory\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eAt times, the application start should be delayed until one or more asynchronous tasks are completed. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eex. you may not want to start accepting requests until the connection with the database has been established. \u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis can be accomplished by registering a provider as an \u003ccode\u003easync\u003c/code\u003e function along with the \u003ccode\u003euseFactory\u003c/code\u003e syntax.\u003c/p\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003eproviders\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    provide\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'ASYNC_CONNECTION'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token function-variable function\"\u003euseFactory\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e connection \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateConnection\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eoptions\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n      \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e connection\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis factory function returns a provider, which can then be injected into a class like any other provider with \u003ccode\u003e@Inject('ASYNC_CONNECTION')\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eHere, Nest will await resolution of the \u003ccode\u003euseFactory\u003c/code\u003e promise before instantiating any class that depends on (injects) such a provider.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"custom-providers\"\u003eCustom Providers\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#custom-providers\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eCustom providers let us do things like:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003einstantiate a provider by ourselves (instead of delegating that responsibility to the Nestjs runtime)\u003c/li\u003e\n\u003cli\u003ere-use an existing class in a second dependency\u003c/li\u003e\n\u003cli\u003eoverride a class with a mock version for testing\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"class-provider-useclass\"\u003eClass Provider (\u003ccode\u003euseClass\u003c/code\u003e)\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#class-provider-useclass\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003euseClass\u003c/code\u003e is the default way to specify which provider the token will resolve to.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ein other words, the shortform will resolve to this syntax.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWe can dynamically determine the class that the token will resolve to by using a ternary operator in the \u003ccode\u003euseClass\u003c/code\u003e key.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eex. imagine you have a default \u003ccode\u003eConfigService\u003c/code\u003e (therefore, high level of generality/abstraction). Depending on which environment we are in, we want to provide the Nestjs IoC container with a different implementation of the class.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"value-provider-usevalue\"\u003eValue Provider (\u003ccode\u003euseValue\u003c/code\u003e)\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#value-provider-usevalue\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eSpecifying a provider like this is useful for injecting a constant value.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eex. putting an external libary into the Nestjs container.\u003c/li\u003e\n\u003cli\u003eex. replace a real implementation with a mock object\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe value to \u003ccode\u003euseValue\u003c/code\u003e will be a simple object that has the same interface as the service it is replacing.\u003c/p\u003e\n\u003ch3 id=\"factory-provider\"\u003eFactory Provider\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#factory-provider\"\u003e\u003c/a\u003e\u003c/h3\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\n\u003ch3 id=\"middleware\"\u003eMiddleware\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#middleware\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cdiv class=\"portal-container\"\u003e\n\u003cdiv class=\"portal-head\"\u003e\n\u003cdiv class=\"portal-backlink\"\u003e\n\u003cdiv class=\"portal-title\"\u003eFrom \u003cspan class=\"portal-text-title\"\u003eMiddleware\u003c/span\u003e\u003c/div\u003e\n\u003ca href=\"/notes/9oglq5pogy5inbt24yjk3hp\" class=\"portal-arrow\"\u003eGo to text \u003cspan class=\"right-arrow\"\u003e→\u003c/span\u003e\u003c/a\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv id=\"portal-parent-anchor\" class=\"portal-parent\" markdown=\"1\"\u003e\n\u003cdiv class=\"portal-parent-fader-top\"\u003e\u003c/div\u003e\n\u003cdiv class=\"portal-parent-fader-bottom\"\u003e\u003c/div\u003e\u003cp\u003eNestjs middleware is equivalent to \u003ca href=\"/notes/inMGAxYKmDgpSWcHN6tXN\"\u003eExpress middleware\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eCustom middleware is implemented either in either a function, or in a class with an \u003ccode\u003e@Injectable()\u003c/code\u003e decorator.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe class should implement the \u003ccode\u003eNestMiddleware\u003c/code\u003e interface, while the function does not have any special requirements.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eMiddleware fully supports dependency injection.\u003c/p\u003e\n\u003cp\u003eWe set up middleware using the \u003ccode\u003econfigure()\u003c/code\u003e method of the module class. \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eModules that include middleware have to implement the \u003ccode\u003eNestModule\u003c/code\u003e interface.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"language-ts\"\u003e\u003ccode class=\"language-ts\"\u003e\u003cspan class=\"token decorator\"\u003e\u003cspan class=\"token at operator\"\u003e@\u003c/span\u003e\u003cspan class=\"token function\"\u003eModule\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  imports\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eCatsModule\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eAppModule\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eimplements\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eNestModule\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003econfigure\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003econsumer\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eMiddlewareConsumer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    consumer\n      \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eapply\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eLoggerMiddleware\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eforRoutes\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'cats'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\n\u003ch2 id=\"misc\"\u003eMisc\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#misc\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eIn Nest, a microservice is defined as an application that uses a different transport layer than HTTP.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cstrong\u003eChildren\u003c/strong\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"/notes/y2pkv1qotvf5os9vzkt9lu3\"\u003eCLI\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/nqv4bkm2rp1nljndftgqxdx\"\u003eControllers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/n9fg78mnpuk5u5xalihz2bp\"\u003eGuard\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/saert7xobzak9v2h5jt72b3\"\u003eInterceptor\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/rluwlir1bxtd1qe8cjrfamg\"\u003eMicroservices\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/9oglq5pogy5inbt24yjk3hp\"\u003eMiddleware\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/y8044sa0ai1u2hyoka0lphz\"\u003eModules\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/oz006ng8c7qcbzg2ytasznj\"\u003ePipe\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/38yyqdyxub4tyjdj0jl4ulg\"\u003eProviders\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/10w9l0kg4v6ik1ceqcfopn2\"\u003eRuntim\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/0lnvdlokt83ssdfl15292vm\"\u003eTesting in Nestjs\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/notes/L5JUZlGAGvTxrsEBB7DY8\"\u003eExpress\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/bXY3W37GW2ytFJOgbJiol\"\u003eIoC (Inversion of Control)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/notes/OIBi54r4RJHlcy33iXLpD\"\u003eDependency Injection\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"olZIVfSs2uLLr3BppFh4K","title":"Digital Garden","desc":"","updated":1674517603573,"created":1615482407722,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"../main/tech","name":"tech"},"contentHash":"effb007003ca6a91d7fd0c293e1d2436","links":[{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"testing.method.unit","alias":"unit testing","position":{"start":{"line":18,"column":121,"offset":1146},"end":{"line":18,"column":157,"offset":1182},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"testing.method.unit"}},{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"general.arch.microservice","alias":"microservices","position":{"start":{"line":18,"column":188,"offset":1213},"end":{"line":18,"column":231,"offset":1256},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"general.arch.microservice"}},{"type":"wiki","from":{"fname":"root","id":"olZIVfSs2uLLr3BppFh4K","vaultName":"tech"},"value":"paradigm.oop","alias":"OOP","position":{"start":{"line":36,"column":227,"offset":2718},"end":{"line":36,"column":247,"offset":2738},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"paradigm.oop"}}],"anchors":{"tags":{"type":"header","text":"Tags","value":"tags","line":46,"column":0,"depth":3},"resources":{"type":"header","text":"Resources","value":"resources","line":55,"column":0,"depth":2},"ue-unexamined-resources":{"type":"header","text":"UE (Unexamined) Resources","value":"ue-unexamined-resources","line":56,"column":0,"depth":3},"e-examined-resources":{"type":"header","text":"E (Examined) Resources","value":"e-examined-resources","line":59,"column":0,"depth":3},"resources-1":{"type":"header","text":"Resources","value":"resources-1","line":62,"column":0,"depth":3}},"children":["40ubf88tephzbdjte8cdsa0","zFMjbn3xihVNHjUIdZCD1","IK6NOKemuDjhfstJBovKL","ZaTr28eWk1DrXOEsc1YVb","Vi0WYVLZunVM9iR8XZJn3","ngAbg7gluvbt1bY1UIRsi","RCPPXSakm5TvKka8kOmVp","LIcuGYV0DDt1VWbvH6Sed","MPx8ykTP57I40WTZvTP7f","ZU5WmdTG1bHoE8RcmZXZG","jqWiyYJff92RjXuUQt9PQ","KihijM8OQvZ4pASkkhqzL","F9vyqvls3OBCujtukqKhy","k6jxm2b3edgkhbordpuz6v1","facc2b01-755a-409f-99f6-57bef2d1501f","bZumdyapJ2H0wWWOmJ45i","elqpgoe2r951si4xrhujppj","m5ov42Vm6mR7RQWTvl1NW","cw8cerc0cos8lh871oz8rtf","PZxxZ4iESzSlbbHJKxuAZ","UDu62Pa6BaRqlG8uGoMhy","u3zcndycwqessho5h6x0nz9","ZgCUp366YrF2Tyky2NT73","DVpVUmavSoVDA7UIlPzLX","nMCtMXVvjBsJk3iw1zoIO","ANfx9Z4a6ZA0uJuSHtbIJ","BkG557LKUYbH1DnxprEVT","1TaH8zDTM98FZ9SYaeXLM","02v7ymc144e5c4pv3edkud7","dc79799f-a55d-48ab-a8be-c48adb1b19c0","f6feef57-b8f5-451f-a09a-7b63f6a07183","4sz47Y0LKs1Si73rWtyyh","g7ulqi8no93ezeocbesc3ll","5a9fb1df-478e-4687-9be0-5cb97e61ec57","1374e9e9-1cbc-4e1f-b1ca-66b8569533dd","D8Z3rjXkSj2EOymXQXF4Z","np3c1ykvnjqv5xoombpfwqz","f529cc34-aba0-45ca-ad7e-02ddda318941","0zcauha3il2NqtxZazIo7","9bbd6f68-03b2-41f4-92e4-2ca313e8b450","5a2ab598-fa7e-4471-8bda-9f5831b679ae","uV6w4mZPoohWyZV4Xaad0","QHXEIyeZGIGMVi5Q52UWI","RgE0mZLaUjPftFPZsiAoe","mytCOts26Pidush65tdRW","fwUzxfLSPMH1eL8oBoLWx","wazdsda6h25x66edvfmeuiv","TbW7PM9bg1y5TGkiWwQ8b","xiSIDeEtIc8X0lpUQlppI","0jxgntiLNHWFuCbzqtFGF","GkdMprLUe4QQULBxmGN6V","4SYc6v5hxY5g6Ip6kjpwO","czi7ilt2i1uoqm1f2otbntj","fqVQpS9FBiXgKsZX3R3sJ","L5JUZlGAGvTxrsEBB7DY8","ttyri4pwfyn5lcx0vp9804o","TeTedoeS2LdHPR632eCpM","ulicRRwo3lSFzh3tMfWH9","p7d24vyb8m00ombzn34t50c","e65188a1-177e-4ab2-99f9-75f85d537621","fajYnbVhCRDi74xn0H30R","bArGdGwqo3iFkyKMyE7qR","4Dcp7gbEVoLLgfu7bXFai","5d700782-fb81-416e-83f9-5dd88260e350","zubgzhNFE6KlTgXcjTz6O","8lpdfWa0cbSq1XJQbcYcY","2psluywdc416t7vrql0m058","17I8ZksXvqCH1mRtZDjHp","kF916Ow84qpJJeMRkWMIo","tMLkLcrIHHBz56xVmBLkP","CSePBQ6q7qhowKESqVwt7","laZ4OfLhZNK1Kuy6GaWUr","z5IJblOknQhMzZ5QZh4ye","N36FHxfxzwJfxDY3miWyX","3bb25f58-2b50-4fa3-af55-48ea9f88a081","7x07qjgbitozdfszqzuy7ix","u93Rz4fEWGu6VBR30Zraf","9hjMHnKvYT4jLKvuDSXaV","qC5GxCZBmNb4Ip6c0kU8x","LgW7mTIALODoXc54B3p6S","UYPxfHBFWX7fb6hHU5bB6","74lYtC8NKpCzcyFOZTfR1","sEoBNAEuaTxwSmTXDonZt","dj0jr9mpvs62e2pkg3zc3yy","z8ie0xjogb6ht7gzowav5xr","qxSOd6SPN8qf9ZUojVFDX","WQoMTf6VXBaxCgksXAVsj","2Mw4XgfyCHXHNOX5yoCIY","qcdt2f7jo51muquo5r95dpo","0XJqmcdtcMZu66glBI5O8","lK8r8BXS4ThiUTe4xKIZe","93de42ca-53ea-460a-baa7-b9ec5c47cb1e","Rxs2jaGpdFzqYtP7lAJFJ","aO8W81Z0PyIb6Hs7nOHPW","lhzisalkebu4w5n01np07i0","7b5l4b6fi65n7sv9org5q1l","I01hENHnh8Tqu3Ok8sLzG","03o3n0hz9v9jtb7j889zpd4","evqsPNutOaZ8hcBCqxFQu","zhhxcjZUHdU8uRLwGb9Zh","G1aFACZB2ooWGMGwyd3ZW","YWy1C4tgoaCcw1m8JJsr7","Szj3o5iaNxPpesiCqwrbu","613syb18hb3v0u1ydvor7ru","XhvCDW3fIw6h6MhY5ticq","Q70g7SusFZBQXzkuQifv4","AzfWDH3wp7jFpL2EYxBcW","y0fwpZ9qMqirsLiFyOciU","ZF8xj8wwDUqKlrwTrCFZ1","tAJvhqhdfyZZa87QHq1TU","4hRmipi8lxpBLyzWu5JVB","iTg0C7QjvnmqBZeEigJNs","3babc3d2-79ae-470a-9c06-ab8bba2e684e","bF3UsMFya3fMeXWDspVov","ULkfbL9WpktbVYnzhl6Jw","PpNOO8JYWe6dM8wruSa7x","di40pCxDn7IiqE8lFdD46","rmW0mkerqV35I8QPji6lM","3IFIK1ByzeIxZCByryGLN","iImkYAKfkw3beAl6pLbDn","ecDe8DNWrkeQTwpTEvHje","i2it5id8qwtg27n4usg8bo1","Yqhdd9mSJGN7OJOeyoSD2","Ws5tah8tpeyn9tK8VBTg8","gWAg15uBJgkS2B0wcpMAa","l7V3v2ep1YdDCt7DOr7Ci","yM2PJBdqJnHpD63cPA6sW","qn0bre7eLbi3QMbCfWkUi","fSu0KxFL41IRouotqmbHs","0gtg24Mj1a1bQFPRGQNlO","7iQPBMltLPLbFEz2qbjPu","yoh4pwoXcfELInGKRdYf6","dCGCWXgAmiOZXbdULT1m6","jMavlje07sNa6hSEIE8WA","Xxm0JE4dKHxrQAaZfzvxD","nRb6Im4Kcmc2ZWE7K1jZ1","PAEBZCyFBZJyR7OoMZ41E","PQ6km8RgRCuyICBPOYz8f","x5tm1nfjzyawwzedy3yitgd","2bhftt8rGuxYu4pFgNqru","hjYIZpHQWuXfeEoGeJEKW","K2M9bQqVq2eQfm29eslKL","X8obW1iKwYsvNgKWGyCzy","yJwSC7hqYIezTFHf5i0Ev","c4Z7ETcOHUILRMH32Sfjw","qiR6dIu857b9M9kTqjOyK","fc2coz74cnfy5czzofx4h5x","Ku1OgHMhELajzo61Gx7ye","LUrfhDWo8wuwZu7CN9TV8","osu6JGOnvXJ5gt3tpqWZY","1a6173cd-cf13-4b34-a522-8350bf9a364f","S2sBltrPfd8a7ICuD7CuH","GLQ2pmkJUNUa93THBDVsD","md6xitz4exia2joa06i490b","oWCuBXOg6JWfZzjmKxmNl","jOmhZ8ovLYTPbpM1vqSDx","p9bov84s0isgkl1ysaw93kk","FraC6xzLy1ei91l1ICyc9","6ceBas2RE9Q4787GDngH7","734cd78d-0bc9-426b-803d-1efc84dfffe5","k4Bb09px6r0FxIRs49SXV","oaG3H1S9IUBO644nGZigu","Ka7agQJkUMRSWN0uFdkWK","si3z090WsiLasMhJBa1Az","hs6rwzt4mogiicoc4gcykbi","ljKAVERmdEiKLK9hXGKBm","zxt3lhonfdhglvijd17ua8c","dd7dopve1dudqkoibkqvti4","923tgifqf59ovv5yldtyi0a","vrjwp01goqw47fqctm4f4lo","c99gdmmppju3r1tth8cb2jx","z2pvn5qxdz84zgygqzxage8"],"parent":null,"data":{},"body":"This Dendron vault of tech knowledge is organized according to domains and their sub-domains, along with specific implementation of those domains.\n\nFor instance, Git itself is a domain. Sub-domains of Git would include things like `commit`,\n`tags`, `reflog` etc. implementations of each of those could be `cli`, `strat`\n(strategies), `inner`, and so on.\n\nThe goal of the wiki is to present data in a manner that is from the perspective\nof a querying user. Here, a user is a programmer wanting to get key information\nfrom a specific domain. For instance, if a user wants to use postgres functions\nand hasn't done them in a while, they should be able to query\n`postgres.functions` to see what information is available to them.\n\nThis wiki has been written with myself in mind. While learning each of these\ndomains, I have been sensitive to the \"aha\" moments and have noted down my\ninsights as they arose. I have refrained from capturing information that I\nconsidered obvious or otherwise non-beneficial to my own understanding.\n\nAs a result, I have allowed myself to use potentially arcane concepts to explain other ones. For example, in my note on [[unit testing|testing.method.unit]], I have made reference to the [[microservices|general.arch.microservice]] note. If these notes were made with the public in mind, this would be a very bad strategy, given that you'd have to understand microservices to be able to draw that same parallel that I've already drawn. Since these notes are written for myself, I have been fine with taking these liberties.\n\nWhat I hope to gain from this wiki is the ability to step away from any\ngiven domain for a long period of time, and be able to be passably useful for\nwhatever my goals are within a short period of time. Of course this is all\nvague sounding, and really depends on the domain along with the ends I am\ntrying to reach.\n\nTo achieve this, the system should be steadfast to:\n- be able to put information in relatively easily, without too much thought\n\trequired to its location. While location is important, Dendron makes it easy\n\tto relocate notes, if it becomes apparent that a different place makes more\n\tsense.\n- be able to extract the information that is needed, meaning there is a\n\thigh-degree in confidence in the location of the information. The idea is\n\tthat information loses a large amount of its value when it is unfindable.\n\tTherefore, a relatively strict ideology should be used when determining\n\twhere a piece of information belongs.\n\t- Some concepts might realistically belong to multiple domains. For instance, the concept of *access modifiers* can be found in both `C#` and `Typescript`. Therefore, this note should be abstracted to a common place, such as [[OOP|paradigm.oop]].\n\nThis Dendron vault is the sister component to the [General Second Brain](https://tech.kyletycholiz.com).\n\n### Tags\nThroughout the garden, I have made use of tags, which give semantic meaning to the pieces of information.\n\n- `ex.` - Denotes an *example* of the preceding piece of information\n- `spec:` - Specifies that the preceding information has some degree of *speculation* to it, and may not be 100% factual. Ideally this gets clarified over time as my understanding develops.\n- `anal:` - Denotes an *analogy* of the preceding information. Often I will attempt to link concepts to others that I have previously learned.\n- `mn:` - Denotes a *mnemonic*\n- `expl:` - Denotes an *explanation*\n\n## Resources\n### UE (Unexamined) Resources\nOften, I come across sources of information that I believe to be high-quality. They may be recommendations or found in some other way. No matter their origin, I may be in a position where I don't have the time to fully examine them (and properly extract notes), or I may not require the information at that moment in time. In cases like these, I will add reference to a section of the note called **UE Resources**. The idea is that in the future when I am ready to examine them, I have a list of resources that I can start with. This is an alternative strategy to compiling browser bookmarks, which I've found can quickly become untenable.\n\n### E (Examined) Resources\nOnce a resource has been thoroughly examined and has been mined for notes, it will be moved from *UE Resources* to *E Resources*. This is to indicate that (in my own estimation), there is nothing more to be gained from the resource that is not already in the note.\n\n### Resources\nThis heading is for inexhaustible resources. \n- A prime example would be a quality website that continually posts articles.  - Another example would be a tool, such as software that measures frequencies in a room to help acoustically treat it.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":false,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"randomNote":{},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"dendronVersion":"0.83.0","vaults":[{"fsPath":"../main/tech","name":"tech"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":true,"maxPreviewsCached":10,"maxNoteLength":204800,"task":{"name":"","dateFormat":"","addBehavior":"childOfCurrent","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link","taskCompleteStatus":["done","x"]},"enableUserTags":true,"enableHashTags":true,"enableEditorDecorations":true,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"The Tech Digital Garden of Kyle Tycholiz"},"github":{"cname":"tech.kyletycholiz.com","enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"master","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"lookup","enableMermaid":true,"siteUrl":"https://tech.kyletycholiz.com","duplicateNoteBehavior":{"action":"useVault","payload":["tech"]},"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"613syb18hb3v0u1ydvor7ru"},"buildId":"fo6gubzKP_KV9RZPhaoiQ","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>