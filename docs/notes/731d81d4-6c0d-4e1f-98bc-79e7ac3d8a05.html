<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  
  <title>Ast - Dendron</title>
  

  <link
    rel="shortcut icon"
    href="https://tycholiz.github.io/Digital-Garden/favicon.ico"
    type="image/x-icon"
  />
  <link
    rel="stylesheet"
    href="https://tycholiz.github.io/Digital-Garden/assets/css/just-the-docs-default.css"
  />
  <script
    type="text/javascript"
    src="https://tycholiz.github.io/Digital-Garden/assets/js/just-the-docs.js"
  ></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
    crossorigin="anonymous"
  />
  <script
    type="text/javascript"
    src="https://tycholiz.github.io/Digital-Garden/assets/js/vendor/lunr.min.js"
  ></script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   
  
<meta name="description" content="Publishable code notes">
<meta name="author" content="">

<link rel="canonical" href="https://tycholiz.github.io/notes/731d81d4-6c0d-4e1f-98bc-79e7ac3d8a05.html">

<meta property="og:type" content="article">
<meta property="og:url" content="https://tycholiz.github.io/notes/731d81d4-6c0d-4e1f-98bc-79e7ac3d8a05.html">
<meta property="og:description" content="Publishable code notes">
<meta property="og:image" content="https://tycholiz.github.ioundefined">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://tycholiz.github.io/notes/731d81d4-6c0d-4e1f-98bc-79e7ac3d8a05.html">
<meta name="twitter:description" content="Publishable code notes">
<meta name="twitter:image" content="https://tycholiz.github.ioundefined">


  <meta property="og:title" content="Ast - Dendron" />
  <meta name="twitter:title" content="Ast - Dendron" />
  
</head>


<body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
      </symbol>
      <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
          <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
      <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
          <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
        </svg>
      </symbol>
    </svg>

    <div class="side-bar">
      <div class="site-header">
        <a href="https://tycholiz.github.io/Digital-Garden" class="site-title lh-tight">
  Dendron

 </a>
        <a href="#" id="menu-button" class="site-button">
          <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
        </a>
      </div>

      <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      </nav>
      <footer class="site-footer">
        ðŸŒ± with ðŸ’• using <a href="https://www.dendron.so/"> Dendron ðŸŒ² </a>
      </footer>
    </div>
    <div class="main" id="top">
        <div id="main-header" class="main-header">
          
            <div class="search">
              <div class="search-input-wrap">
                <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Dendron" aria-label="Search Dendron" autocomplete="off">
                <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
              </div>
              <div id="search-results" class="search-results"></div>
            </div>
          
          
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
          <nav aria-label="Breadcrumb" class="breadcrumb-nav">
            <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://tycholiz.github.io/Digital-Garden">Root</a></li><li class="breadcrumb-nav-list-item"><a href="https://tycholiz.github.io/Digital-Garden/notes/55a2161d-d415-4fbd-98cb-ff8aed19e6ee.html">Graphql</a></li><li class="breadcrumb-nav-list-item">Ast</li></ol>
          </nav>
        
      
      <div id="main-content" class="main-content" role="main">

        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

        

        <script>
          $(function () {
            $('[data-toggle="popover"]').popover({html: true})
          })
        </script>

        

<div id="main" role="main">

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Ast">
    
    <meta itemprop="datePublished" content="2021-03-23T13:06:30+00:00">
    <meta itemprop="dateModified" content="2021-03-23T15:32:07+00:00">

    <div class="page__inner-wrap">

      

      <section class="page__content" itemprop="text">

        

        <h1 id="ast"><a aria-hidden="true" class="anchor-heading" href="#ast"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Ast</h1>
<p>In order to interpret and understand these unique and complex requests, GraphQL employs the use of an Abstract Syntax Tree (AST) to structure the incoming requests.</p>
<ul>
<li>This makes it easier for the back-end gurus &#x26; frameworks to parse and construct the required response.</li>
</ul>
<p>As a consequence of Graphql being data-layer-independent, libraries such as graphql-js and graphql-tools exist to abstract away the heavy lifting, removing our need to worry about having to interact with the underlying AST.</p>
<ul>
<li>Sometimes however we must be able to perform our own custom operations based on the specifics of the user's request.</li>
</ul>
<h3 id="what-is-an-ast"><a aria-hidden="true" class="anchor-heading" href="#what-is-an-ast"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>What is an AST?</h3>
<p>an AST is just a fancy way of saying "heavily nested objects"</p>
<ul>
<li>It is a structure that is commonly used in compilers to parse the code we write, converting it into a tree structure that we can traverse programmatically.</li>
</ul>
<p>When a user makes a request, GraphQL combines the query document that the user requested with the schema definition that we defined for our resolver in the form of an AST. This AST is used to determine which fields were requested, what arguments were included and much more.</p>
<h3 id="rugby-player-example"><a aria-hidden="true" class="anchor-heading" href="#rugby-player-example"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Rugby Player Example</h3>
<p>Suppose we wanted to expose a list of rugby players on our Graphql backend. We make a schema definition which models a new Graphql type <code>RugbyPlayer</code>, which has 2 fields: <code>full_name</code> and <code>club</code>:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token maybe-class-name">RugbyPlayer</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">gql<span class="token punctuation">.</span>GraphQLObjectType</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'RugbyPlayer'</span><span class="token punctuation">,</span>
    fields<span class="token operator">:</span> <span class="token punctuation">{</span>
        full_name<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> gql<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">GraphQLString</span></span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        club<span class="token operator">:</span> <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">gql<span class="token punctuation">.</span>GraphQLObjectType</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                name<span class="token operator">:</span> <span class="token string">'Club'</span><span class="token punctuation">,</span>
                fields<span class="token operator">:</span> <span class="token punctuation">{</span>
                    name<span class="token operator">:</span> <span class="token punctuation">{</span>
                        type<span class="token operator">:</span> gql<span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">GraphQLString</span></span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Imagine now that a client makes a request for that list of players. From the Graphql server's perspective, the schema knows nothing about the query document (ie. the request). Therefore, it has to parse the query document into AST format (ie. heavily nested objects) before it can traverse it. Now, it can perform any necessary validation, like throwing errors for having the wrong types for fields or arguments.</p>
<ul>
<li>Following this validation, schema types are mapped onto the respective branches of the AST to provide a richer set of metadata.</li>
</ul>
<h3 id="what-we-can-do-with-the-ast"><a aria-hidden="true" class="anchor-heading" href="#what-we-can-do-with-the-ast"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>What we can do with the AST</h3>
<p>By understanding the AST, we can craft custom directives and optimise user requests</p>
<ul>
<li>We do this by breaking the traditional Graphql lifecycle and inercepting a request before it gets passed onto another library to generate a response.</li>
</ul>
<p>By traversing and augmenting the AST we can implement:</p>
<ul>
<li>Schema stitching</li>
<li>Custom directives</li>
<li>Enriched queries</li>
<li>Layered Abstraction</li>
<li>More backend magic!</li>
</ul>
<p>In a step to give more control to the front-end client, we often find it useful to implement a range of directives that can transform or filter out fields specified in the AST.</p>
<ul>
<li>ex. In the Rugby example, imagine we want to solve this problem: "Rugby player's names are being mispronounced too often".
<ul>
<li>What we can do is implement a Graphql directive called <code>@pronounce</code>, which can be added onto the <code>full_name</code> field when we are querying our <code>RugbyPlayers</code> type:</li>
</ul>
</li>
</ul>
<pre><code>query {
  RugbyPlayers {
    full_name @pronounce
  }
}
</code></pre>
<p>libraries like <code>graphql-js</code> can provide methods such as <code>gql.GraphQLDirective</code> that allow us to add these directives.</p>
<p>Whenever we see code like this:</p>
<pre><code>const Type = gql`
  type ${nameOfType} {
    str: String
    int: Int
  }
`;
</code></pre>
<p>We can understand <code>gql</code> as a function that transforms our human-readable graphql schema language into an AST that the application can understand.</p>
<hr>
<h2 id="backlinks"><a aria-hidden="true" class="anchor-heading" href="#backlinks"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Backlinks</h2>
<ul>
<li><a href="https://tycholiz.github.io/Digital-Garden/notes/25864130-d786-4fee-a831-f24ab9949472.html">Gql</a></li>
</ul><span id="navId" data="731d81d4-6c0d-4e1f-98bc-79e7ac3d8a05"></span>

                
      </section>

      
    </div>

    
  </article>

  
  
</div>


        
          <hr>
          <footer>
            
            

            
                
              </div>
          </footer>
        
    </div>
</div>


  

  <div class="search-overlay"></div>

</div>
</body>
</html>
