<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  
  <title>Ssh - Dendron</title>
  

  <link
    rel="shortcut icon"
    href="https://tycholiz.github.io/favicon.ico"
    type="image/x-icon"
  />
  <link
    rel="stylesheet"
    href="https://tycholiz.github.io/assets/css/just-the-docs-default.css"
  />
  <script
    type="text/javascript"
    src="https://tycholiz.github.io/assets/js/just-the-docs.js"
  ></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
    crossorigin="anonymous"
  />
  <script
    type="text/javascript"
    src="https://tycholiz.github.io/assets/js/vendor/lunr.min.js"
  ></script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   
  
<meta name="description" content="Personal knowledge space">
<meta name="author" content="">

<link rel="canonical" href="https://foo/notes/f9ae4e58-9235-4fc2-bf20-7c51348aa3a2.html">

<meta property="og:type" content="article">
<meta property="og:url" content="https://foo/notes/f9ae4e58-9235-4fc2-bf20-7c51348aa3a2.html">
<meta property="og:description" content="Personal knowledge space">
<meta property="og:image" content="https://fooundefined">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://foo/notes/f9ae4e58-9235-4fc2-bf20-7c51348aa3a2.html">
<meta name="twitter:description" content="Personal knowledge space">
<meta name="twitter:image" content="https://fooundefined">


  <meta property="og:title" content="Ssh - Dendron" />
  <meta name="twitter:title" content="Ssh - Dendron" />
  
</head>


<body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
      </symbol>
      <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
          <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
      <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
          <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
        </svg>
      </symbol>
    </svg>

    <div class="side-bar">
      <div class="site-header">
        <a href="https://tycholiz.github.io" class="site-title lh-tight">
  Dendron

 </a>
        <a href="#" id="menu-button" class="site-button">
          <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
        </a>
      </div>

      <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      </nav>
      <footer class="site-footer">
        ðŸŒ± with ðŸ’• using <a href="https://www.dendron.so/"> Dendron ðŸŒ² </a>
      </footer>
    </div>
    <div class="main" id="top">
        <div id="main-header" class="main-header">
          
            <div class="search">
              <div class="search-input-wrap">
                <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Dendron" aria-label="Search Dendron" autocomplete="off">
                <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
              </div>
              <div id="search-results" class="search-results"></div>
            </div>
          
          
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
          <nav aria-label="Breadcrumb" class="breadcrumb-nav">
            <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://tycholiz.github.io">Root</a></li><li class="breadcrumb-nav-list-item"><a href="https://tycholiz.github.io/notes/240d9848-b03d-445a-8787-090d79024b6a.html">Unix</a></li><li class="breadcrumb-nav-list-item"><a href="https://tycholiz.github.io/notes/cabfc7c5-837a-4edf-954c-6feb1daa90e9.html">CLI</a></li><li class="breadcrumb-nav-list-item">Ssh</li></ol>
          </nav>
        
      
      <div id="main-content" class="main-content" role="main">

        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

        

        <script>
          $(function () {
            $('[data-toggle="popover"]').popover({html: true})
          })
        </script>

        

<div id="main" role="main">

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Ssh">
    
    <meta itemprop="datePublished" content="2021-03-02T20:48:22+00:00">
    <meta itemprop="dateModified" content="2021-03-28T19:35:10+00:00">

    <div class="page__inner-wrap">

      

      <section class="page__content" itemprop="text">

        

        <h1 id="ssh"><a aria-hidden="true" class="anchor-heading" href="#ssh"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Ssh</h1>
<h2 id="config"><a aria-hidden="true" class="anchor-heading" href="#config"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Config</h2>
<p>Client config (~/.ssh/config)
<a href="https://gravitational.com/blog/ssh-config/">good resource with lots of info</a></p>
<h1 id="ssh-key"><a aria-hidden="true" class="anchor-heading" href="#ssh-key"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>SSH Key</h1>
<h2 id="components"><a aria-hidden="true" class="anchor-heading" href="#components"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Components</h2>
<ul>
<li>Each SSH key pair has 2 components: public key and private key</li>
<li>They are both created with <code>ssh-keygen</code> </li>
</ul>
<h3 id="public-key"><a aria-hidden="true" class="anchor-heading" href="#public-key"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Public key</h3>
<ul>
<li>Public key is copied to the SSH server so it knows it can trust the user with the corresponding private key when it tries to connect via SSH</li>
<li>Anyone that has the public key is able to encrypt the data in such a way that only the bearer of the private key can decrypt it. </li>
<li>Once an SSH server receives the public key from a user, it marks the key as trustworthy and is moved to the <code>authorized_keys</code> file.</li>
<li><code>ssh-copy-id</code> allows us to copy an SSH key from our local machine to a server to be used as an authorized key, allowing s the SSH client to login without password
<ul>
<li>What it does is it assembles a list of one or more fingerprints, and tries to log in with each key. It then makes a list of all the keys that failed login, and enables logins with those keys on the remote server (by adding them to the remote's <code>authorized_keys</code> file).</li>
</ul>
</li>
<li>Public keys are stored on SSH clients </li>
</ul>
<h3 id="private-key"><a aria-hidden="true" class="anchor-heading" href="#private-key"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Private key</h3>
<ul>
<li>Considered proof of the user's identity, and only if the private key corresponds to the public key will the user be authenticated</li>
<li>Because they are used for authentication, they are called identity keys</li>
<li>The private key is stored on the SSH server</li>
<li>When we open the private key, what we see is its encrypted form. To decrypt it, we need to enter the password that we created with <code>ssh-keygen</code>.
<ul>
<li>Therefore, without the password, the private key is useless.</li>
</ul>
</li>
</ul>
<hr>
<h2 id="ssh-agent"><a aria-hidden="true" class="anchor-heading" href="#ssh-agent"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>SSH Agent</h2>
<ul>
<li>ssh-agent stores unencrypted private keys in memory, allowing us to login without entering our password each time.
<ul>
<li>Therefore, ssh-agent is a form of Single-Signon (SSO)</li>
</ul>
</li>
<li>Without ssh-agent, upon entering the password, the decrypted key is stored in program memory (which is associated with a process (PID)). However, the SSH client process cannot be used to store the decrypted key, since the process is terminated once the remote login session has ended. This is why we use <code>ssh-agent</code></li>
<li><code>ssh-agent</code> works by creating a socket then checks for connections from ssh.
<ul>
<li>anyone who is able to connect to this socket can also connect to the ssh-agent.</li>
<li>upon starting, the agent creates a new directory in <code>/tmp</code> that determines permissions.</li>
</ul>
</li>
<li>On most Linux systems, ssh-agent is automatically configured and run at login. </li>
<li>On the server side, <code>PubkeyAuthentication</code> must be enabled in the <code>ssh_config</code> file to allow these key-based logins. </li>
<li>we can use <code>ssh-add</code> tool to add identities to the agent.
<ul>
<li>running <code>ssh-add</code> without args will add the default private keys to the agent (<code>~/.ssh/id_rsa</code>, <code>~/.ssh/id_dsa</code> etc.)</li>
<li><code>ssh-add -l</code> will list out the private keys accessible to the agent</li>
</ul>
</li>
</ul>
<h3 id="agent-forwarding"><a aria-hidden="true" class="anchor-heading" href="#agent-forwarding"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Agent Forwarding</h3>
<ul>
<li>Agent forwarding is a mechanism that gives an SSH server access to the SSH client's <code>ssh-agent</code>, allowing it to use it as if it were local. </li>
<li>To use agent forwarding, the <code>ForwardAgent</code> option must be set to yes on the client </li>
</ul>
<h2 id="debugging"><a aria-hidden="true" class="anchor-heading" href="#debugging"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Debugging</h2>
<ul>
<li>
<p>check client logs with <code>ssh -vvv &#x3C;user>@&#x3C;host></code></p>
</li>
<li>
<p>check server logs at <code>/var/log/auth.log</code></p>
</li>
<li>
<p>on server, try editing <code>/etc/ssh/sshd_config</code>, changing: </p>
<ol>
<li><code>PasswordAuthentication yes</code></li>
<li><code>PermitRootLogin yes</code></li>
</ol>
<ul>
<li>restart sshd <code>service sshd restart</code></li>
<li>on client, run <code>ssh-copy-id -i &#x3C;remote-user>@&#x3C;remote-ip></code></li>
<li>on host, revert the <code>sshd_config</code> options to their prior state</li>
</ul>
</li>
</ul>
<hr>
<h2 id="tunneling"><a aria-hidden="true" class="anchor-heading" href="#tunneling"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Tunneling</h2>
<ul>
<li>In order to tunnel, we need to set up a protocol. SSH is an example of such a protocol, where the receiver of the SSH command must have an SSH server running so that it may intercept the SSH message, and interpret it and enable the SSH connection. </li>
</ul><span id="navId" data="f9ae4e58-9235-4fc2-bf20-7c51348aa3a2"></span>

                
      </section>

      
    </div>

    
  </article>

  
  
</div>


        
          <hr>
          <footer>
            
            

            
                
              </div>
          </footer>
        
    </div>
</div>


  

  <div class="search-overlay"></div>

</div>
</body>
</html>
